(function(){const g=document.createElement("link").relList;if(g&&g.supports&&g.supports("modulepreload"))return;for(const p of document.querySelectorAll('link[rel="modulepreload"]'))C(p);new MutationObserver(p=>{for(const i of p)if(i.type==="childList")for(const u of i.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&C(u)}).observe(document,{childList:!0,subtree:!0});function s(p){const i={};return p.integrity&&(i.integrity=p.integrity),p.referrerPolicy&&(i.referrerPolicy=p.referrerPolicy),p.crossOrigin==="use-credentials"?i.credentials="include":p.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function C(p){if(p.ep)return;p.ep=!0;const i=s(p);fetch(p.href,i)}})();class Bm{constructor(g){this.callback=g,this.loadAll()}fetchData(g){return fetch(g).then(s=>s.json()).catch(s=>{throw new Error(s)})}loadImages(){return new Promise((g,s)=>{this.fetchData("data/imagesData.json").then(C=>{const p=Object.keys(C),i=p.length;let u=0,l={};p.forEach(a=>{const m=new Image;m.src=C[a],l[a]=m,m.onload=()=>{u++,u===i&&g(l)},m.onerror=()=>{s(new Error(`Image failed to load ${C[a]}`))}})}).catch(C=>{throw new Error(C)})})}loadAudio(){return new Promise((g,s)=>{this.fetchData("data/audioData.json").then(C=>{const p=Object.keys(C),i=p.length;let u=0,l={};p.forEach(a=>{const m=new Audio;m.src=C[a],m.preload="auto",l[a]=m,m.onloadeddata=()=>{u++,u===i&&g(l)},m.onerror=()=>{s(new Error(`Audio failed to load: ${C[a]}`))}})}).catch(C=>{s(C)})})}loadAll(){const g=this.loadImages(),s=this.loadAudio(),C=this.fetchData("data/entitiesData.json"),p=this.fetchData("data/settingsData.json"),i=this.fetchData("data/enemyWaveData.json"),u=this.fetchData("data/progressData.json");Promise.all([g,C,p,s,i,u]).then(([l,a,m,f,x,v])=>{const r={imagesData:l,entitiesData:a,settingsData:m,audioData:f,enemyWaveData:x,progressData:v};this.callback(r)}).catch(l=>{throw console.error("Asset loading error:",l),l})}}class Am{constructor(g){this.pos={x:0,y:0},this.canvas=g.canvas,this.isPressed=!1,this.wasReleased=!1,this.hoveredEntity=null,this.listener()}listener(){const g=this.canvas,s=()=>g.getBoundingClientRect();g.addEventListener("mousedown",()=>{this.isPressed=!0},{passive:!0}),g.addEventListener("mouseup",()=>{this.isPressed=!1,this.wasReleased=!0},{passive:!0}),g.addEventListener("touchstart",()=>{this.isPressed=!0},{passive:!0}),g.addEventListener("touchend",()=>{this.isPressed=!1,this.wasReleased=!0},{passive:!0});const C=p=>{const i=s(),u=g.width/i.width,l=g.height/i.height;p.touches&&p.touches.length>0?(this.pos.x=(p.touches[0].clientX-i.left)*u,this.pos.y=(p.touches[0].clientY-i.top)*l):(this.pos.x=(p.clientX-i.left)*u,this.pos.y=(p.clientY-i.top)*l)};g.addEventListener("mousemove",C,{passive:!0}),g.addEventListener("touchstart",C,{passive:!0}),g.addEventListener("touchmove",C,{passive:!0})}reset(){this.wasReleased=!1}}var Ge=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Um(J){return J&&J.__esModule&&Object.prototype.hasOwnProperty.call(J,"default")?J.default:J}var Uo={},Ri={},Di={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var Rm=Di.exports,Fl;function Ro(){return Fl||(Fl=1,function(J,g){(function(){var s,C="4.17.21",p=200,i="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",u="Expected a function",l="Invalid `variable` option passed into `_.template`",a="__lodash_hash_undefined__",m=500,f="__lodash_placeholder__",x=1,v=2,r=4,h=1,c=2,d=1,S=2,B=4,U=8,_=16,y=32,w=64,M=128,T=256,I=512,A=30,L="...",D=800,K=16,X=1,Z=2,et=3,Q=1/0,at=9007199254740991,vt=17976931348623157e292,_t=NaN,Ct=4294967295,kt=Ct-1,ut=Ct>>>1,fe=[["ary",M],["bind",d],["bindKey",S],["curry",U],["curryRight",_],["flip",I],["partial",y],["partialRight",w],["rearg",T]],Wt="[object Arguments]",ft="[object Array]",$t="[object AsyncFunction]",Pt="[object Boolean]",re="[object Date]",Xt="[object DOMException]",Vt="[object Error]",It="[object Function]",Rn="[object GeneratorFunction]",te="[object Map]",He="[object Number]",On="[object Null]",se="[object Object]",rn="[object Promise]",ce="[object Proxy]",he="[object RegExp]",Nt="[object Set]",ge="[object String]",Zt="[object Symbol]",Cn="[object Undefined]",Be="[object WeakMap]",sn="[object WeakSet]",Ke="[object ArrayBuffer]",pe="[object DataView]",Ae="[object Float32Array]",Ue="[object Float64Array]",In="[object Int8Array]",Ln="[object Int16Array]",ni="[object Int32Array]",ii="[object Uint8Array]",Re="[object Uint8ClampedArray]",on="[object Uint16Array]",ri="[object Uint32Array]",Wi=/\b__p \+= '';/g,jr=/\b(__p \+=) '' \+/g,Ni=/(__e\(.*?\)|\b__t\)) \+\n'';/g,an=/&(?:amp|lt|gt|quot|#39);/g,Gi=/[&<>"']/g,Ve=RegExp(an.source),ts=RegExp(Gi.source),es=/<%-([\s\S]+?)%>/g,ns=/<%([\s\S]+?)%>/g,Hi=/<%=([\s\S]+?)%>/g,is=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Oe=/^\w*$/,rs=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,si=/[\\^$.*+?()[\]{}|]/g,ss=RegExp(si.source),oi=/^\s+/,os=/\s/,ln=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,as=/\{\n\/\* \[wrapped with (.+)\] \*/,ls=/,? & /,us=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,fs=/[()=,{}\[\]\/\s]/,cs=/\\(\\)?/g,un=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ki=/\w*$/,hs=/^[-+]0x[0-9a-f]+$/i,gs=/^0b[01]+$/i,ps=/^\[object .+?Constructor\]$/,ms=/^0o[0-7]+$/i,ds=/^(?:0|[1-9]\d*)$/,ai=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,kn=/($^)/,Dn=/['\n\r\u2028\u2029\\]/g,fn="\\ud800-\\udfff",ys="\\u0300-\\u036f",Fn="\\ufe20-\\ufe2f",Vi="\\u20d0-\\u20ff",zi=ys+Fn+Vi,Yi="\\u2700-\\u27bf",$i="a-z\\xdf-\\xf6\\xf8-\\xff",Xi="\\xac\\xb1\\xd7\\xf7",vs="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",xs="\\u2000-\\u206f",Es=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Zi="A-Z\\xc0-\\xd6\\xd8-\\xde",Ji="\\ufe0e\\ufe0f",qi=Xi+vs+xs+Es,li="['’]",Cs="["+fn+"]",Qi="["+qi+"]",Wn="["+zi+"]",Sn="\\d+",ui="["+Yi+"]",ji="["+$i+"]",tr="[^"+fn+qi+Sn+Yi+$i+Zi+"]",Nn="\\ud83c[\\udffb-\\udfff]",Ss="(?:"+Wn+"|"+Nn+")",er="[^"+fn+"]",fi="(?:\\ud83c[\\udde6-\\uddff]){2}",Gn="[\\ud800-\\udbff][\\udc00-\\udfff]",cn="["+Zi+"]",nr="\\u200d",ir="(?:"+ji+"|"+tr+")",ci="(?:"+cn+"|"+tr+")",rr="(?:"+li+"(?:d|ll|m|re|s|t|ve))?",sr="(?:"+li+"(?:D|LL|M|RE|S|T|VE))?",or=Ss+"?",wn="["+Ji+"]?",hi="(?:"+nr+"(?:"+[er,fi,Gn].join("|")+")"+wn+or+")*",gi="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",pi="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",ar=wn+or+hi,lr="(?:"+[ui,fi,Gn].join("|")+")"+ar,mi="(?:"+[er+Wn+"?",Wn,fi,Gn,Cs].join("|")+")",ur=RegExp(li,"g"),ze=RegExp(Wn,"g"),Ye=RegExp(Nn+"(?="+Nn+")|"+mi+ar,"g"),ws=RegExp([cn+"?"+ji+"+"+rr+"(?="+[Qi,cn,"$"].join("|")+")",ci+"+"+sr+"(?="+[Qi,cn+ir,"$"].join("|")+")",cn+"?"+ir+"+"+rr,cn+"+"+sr,pi,gi,Sn,lr].join("|"),"g"),fr=RegExp("["+nr+fn+zi+Ji+"]"),bs=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,cr=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Ts=-1,Bt={};Bt[Ae]=Bt[Ue]=Bt[In]=Bt[Ln]=Bt[ni]=Bt[ii]=Bt[Re]=Bt[on]=Bt[ri]=!0,Bt[Wt]=Bt[ft]=Bt[Ke]=Bt[Pt]=Bt[pe]=Bt[re]=Bt[Vt]=Bt[It]=Bt[te]=Bt[He]=Bt[se]=Bt[he]=Bt[Nt]=Bt[ge]=Bt[Be]=!1;var bt={};bt[Wt]=bt[ft]=bt[Ke]=bt[pe]=bt[Pt]=bt[re]=bt[Ae]=bt[Ue]=bt[In]=bt[Ln]=bt[ni]=bt[te]=bt[He]=bt[se]=bt[he]=bt[Nt]=bt[ge]=bt[Zt]=bt[ii]=bt[Re]=bt[on]=bt[ri]=!0,bt[Vt]=bt[It]=bt[Be]=!1;var Ps={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},R={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},F={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},H={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},tt=parseFloat,dt=parseInt,St=typeof Ge=="object"&&Ge&&Ge.Object===Object&&Ge,Ut=typeof self=="object"&&self&&self.Object===Object&&self,ot=St||Ut||Function("return this")(),Mt=g&&!g.nodeType&&g,Gt=Mt&&!0&&J&&!J.nodeType&&J,Jt=Gt&&Gt.exports===Mt,$e=Jt&&St.process,qt=function(){try{var W=Gt&&Gt.require&&Gt.require("util").types;return W||$e&&$e.binding&&$e.binding("util")}catch{}}(),Hn=qt&&qt.isArrayBuffer,di=qt&&qt.isDate,Lo=qt&&qt.isMap,ko=qt&&qt.isRegExp,Do=qt&&qt.isSet,Fo=qt&&qt.isTypedArray;function me(W,V,G){switch(G.length){case 0:return W.call(V);case 1:return W.call(V,G[0]);case 2:return W.call(V,G[0],G[1]);case 3:return W.call(V,G[0],G[1],G[2])}return W.apply(V,G)}function ql(W,V,G,j){for(var lt=-1,Et=W==null?0:W.length;++lt<Et;){var Ht=W[lt];V(j,Ht,G(Ht),W)}return j}function Se(W,V){for(var G=-1,j=W==null?0:W.length;++G<j&&V(W[G],G,W)!==!1;);return W}function Ql(W,V){for(var G=W==null?0:W.length;G--&&V(W[G],G,W)!==!1;);return W}function Wo(W,V){for(var G=-1,j=W==null?0:W.length;++G<j;)if(!V(W[G],G,W))return!1;return!0}function hn(W,V){for(var G=-1,j=W==null?0:W.length,lt=0,Et=[];++G<j;){var Ht=W[G];V(Ht,G,W)&&(Et[lt++]=Ht)}return Et}function hr(W,V){var G=W==null?0:W.length;return!!G&&Kn(W,V,0)>-1}function Ms(W,V,G){for(var j=-1,lt=W==null?0:W.length;++j<lt;)if(G(V,W[j]))return!0;return!1}function Rt(W,V){for(var G=-1,j=W==null?0:W.length,lt=Array(j);++G<j;)lt[G]=V(W[G],G,W);return lt}function gn(W,V){for(var G=-1,j=V.length,lt=W.length;++G<j;)W[lt+G]=V[G];return W}function _s(W,V,G,j){var lt=-1,Et=W==null?0:W.length;for(j&&Et&&(G=W[++lt]);++lt<Et;)G=V(G,W[lt],lt,W);return G}function jl(W,V,G,j){var lt=W==null?0:W.length;for(j&&lt&&(G=W[--lt]);lt--;)G=V(G,W[lt],lt,W);return G}function Bs(W,V){for(var G=-1,j=W==null?0:W.length;++G<j;)if(V(W[G],G,W))return!0;return!1}var tu=As("length");function eu(W){return W.split("")}function nu(W){return W.match(us)||[]}function No(W,V,G){var j;return G(W,function(lt,Et,Ht){if(V(lt,Et,Ht))return j=Et,!1}),j}function gr(W,V,G,j){for(var lt=W.length,Et=G+(j?1:-1);j?Et--:++Et<lt;)if(V(W[Et],Et,W))return Et;return-1}function Kn(W,V,G){return V===V?pu(W,V,G):gr(W,Go,G)}function iu(W,V,G,j){for(var lt=G-1,Et=W.length;++lt<Et;)if(j(W[lt],V))return lt;return-1}function Go(W){return W!==W}function Ho(W,V){var G=W==null?0:W.length;return G?Rs(W,V)/G:_t}function As(W){return function(V){return V==null?s:V[W]}}function Us(W){return function(V){return W==null?s:W[V]}}function Ko(W,V,G,j,lt){return lt(W,function(Et,Ht,At){G=j?(j=!1,Et):V(G,Et,Ht,At)}),G}function ru(W,V){var G=W.length;for(W.sort(V);G--;)W[G]=W[G].value;return W}function Rs(W,V){for(var G,j=-1,lt=W.length;++j<lt;){var Et=V(W[j]);Et!==s&&(G=G===s?Et:G+Et)}return G}function Os(W,V){for(var G=-1,j=Array(W);++G<W;)j[G]=V(G);return j}function su(W,V){return Rt(V,function(G){return[G,W[G]]})}function Vo(W){return W&&W.slice(0,Xo(W)+1).replace(oi,"")}function de(W){return function(V){return W(V)}}function Is(W,V){return Rt(V,function(G){return W[G]})}function yi(W,V){return W.has(V)}function zo(W,V){for(var G=-1,j=W.length;++G<j&&Kn(V,W[G],0)>-1;);return G}function Yo(W,V){for(var G=W.length;G--&&Kn(V,W[G],0)>-1;);return G}function ou(W,V){for(var G=W.length,j=0;G--;)W[G]===V&&++j;return j}var au=Us(Ps),lu=Us(R);function uu(W){return"\\"+H[W]}function fu(W,V){return W==null?s:W[V]}function Vn(W){return fr.test(W)}function cu(W){return bs.test(W)}function hu(W){for(var V,G=[];!(V=W.next()).done;)G.push(V.value);return G}function Ls(W){var V=-1,G=Array(W.size);return W.forEach(function(j,lt){G[++V]=[lt,j]}),G}function $o(W,V){return function(G){return W(V(G))}}function pn(W,V){for(var G=-1,j=W.length,lt=0,Et=[];++G<j;){var Ht=W[G];(Ht===V||Ht===f)&&(W[G]=f,Et[lt++]=G)}return Et}function pr(W){var V=-1,G=Array(W.size);return W.forEach(function(j){G[++V]=j}),G}function gu(W){var V=-1,G=Array(W.size);return W.forEach(function(j){G[++V]=[j,j]}),G}function pu(W,V,G){for(var j=G-1,lt=W.length;++j<lt;)if(W[j]===V)return j;return-1}function mu(W,V,G){for(var j=G+1;j--;)if(W[j]===V)return j;return j}function zn(W){return Vn(W)?yu(W):tu(W)}function Ie(W){return Vn(W)?vu(W):eu(W)}function Xo(W){for(var V=W.length;V--&&os.test(W.charAt(V)););return V}var du=Us(F);function yu(W){for(var V=Ye.lastIndex=0;Ye.test(W);)++V;return V}function vu(W){return W.match(Ye)||[]}function xu(W){return W.match(ws)||[]}var Eu=function W(V){V=V==null?ot:Yn.defaults(ot.Object(),V,Yn.pick(ot,cr));var G=V.Array,j=V.Date,lt=V.Error,Et=V.Function,Ht=V.Math,At=V.Object,ks=V.RegExp,Cu=V.String,we=V.TypeError,mr=G.prototype,Su=Et.prototype,$n=At.prototype,dr=V["__core-js_shared__"],yr=Su.toString,Tt=$n.hasOwnProperty,wu=0,Zo=function(){var t=/[^.]+$/.exec(dr&&dr.keys&&dr.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),vr=$n.toString,bu=yr.call(At),Tu=ot._,Pu=ks("^"+yr.call(Tt).replace(si,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),xr=Jt?V.Buffer:s,mn=V.Symbol,Er=V.Uint8Array,Jo=xr?xr.allocUnsafe:s,Cr=$o(At.getPrototypeOf,At),qo=At.create,Qo=$n.propertyIsEnumerable,Sr=mr.splice,jo=mn?mn.isConcatSpreadable:s,vi=mn?mn.iterator:s,bn=mn?mn.toStringTag:s,wr=function(){try{var t=Bn(At,"defineProperty");return t({},"",{}),t}catch{}}(),Mu=V.clearTimeout!==ot.clearTimeout&&V.clearTimeout,_u=j&&j.now!==ot.Date.now&&j.now,Bu=V.setTimeout!==ot.setTimeout&&V.setTimeout,br=Ht.ceil,Tr=Ht.floor,Ds=At.getOwnPropertySymbols,Au=xr?xr.isBuffer:s,ta=V.isFinite,Uu=mr.join,Ru=$o(At.keys,At),Kt=Ht.max,Qt=Ht.min,Ou=j.now,Iu=V.parseInt,ea=Ht.random,Lu=mr.reverse,Fs=Bn(V,"DataView"),xi=Bn(V,"Map"),Ws=Bn(V,"Promise"),Xn=Bn(V,"Set"),Ei=Bn(V,"WeakMap"),Ci=Bn(At,"create"),Pr=Ei&&new Ei,Zn={},ku=An(Fs),Du=An(xi),Fu=An(Ws),Wu=An(Xn),Nu=An(Ei),Mr=mn?mn.prototype:s,Si=Mr?Mr.valueOf:s,na=Mr?Mr.toString:s;function b(t){if(Lt(t)&&!ct(t)&&!(t instanceof yt)){if(t instanceof be)return t;if(Tt.call(t,"__wrapped__"))return il(t)}return new be(t)}var Jn=function(){function t(){}return function(e){if(!Ot(e))return{};if(qo)return qo(e);t.prototype=e;var n=new t;return t.prototype=s,n}}();function _r(){}function be(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=s}b.templateSettings={escape:es,evaluate:ns,interpolate:Hi,variable:"",imports:{_:b}},b.prototype=_r.prototype,b.prototype.constructor=b,be.prototype=Jn(_r.prototype),be.prototype.constructor=be;function yt(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Ct,this.__views__=[]}function Gu(){var t=new yt(this.__wrapped__);return t.__actions__=oe(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=oe(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=oe(this.__views__),t}function Hu(){if(this.__filtered__){var t=new yt(this);t.__dir__=-1,t.__filtered__=!0}else t=this.clone(),t.__dir__*=-1;return t}function Ku(){var t=this.__wrapped__.value(),e=this.__dir__,n=ct(t),o=e<0,E=n?t.length:0,P=nc(0,E,this.__views__),O=P.start,k=P.end,N=k-O,z=o?k:O-1,Y=this.__iteratees__,$=Y.length,q=0,nt=Qt(N,this.__takeCount__);if(!n||!o&&E==N&&nt==N)return Pa(t,this.__actions__);var rt=[];t:for(;N--&&q<nt;){z+=e;for(var gt=-1,st=t[z];++gt<$;){var mt=Y[gt],xt=mt.iteratee,xe=mt.type,ie=xt(st);if(xe==Z)st=ie;else if(!ie){if(xe==X)continue t;break t}}rt[q++]=st}return rt}yt.prototype=Jn(_r.prototype),yt.prototype.constructor=yt;function Tn(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var o=t[e];this.set(o[0],o[1])}}function Vu(){this.__data__=Ci?Ci(null):{},this.size=0}function zu(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}function Yu(t){var e=this.__data__;if(Ci){var n=e[t];return n===a?s:n}return Tt.call(e,t)?e[t]:s}function $u(t){var e=this.__data__;return Ci?e[t]!==s:Tt.call(e,t)}function Xu(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=Ci&&e===s?a:e,this}Tn.prototype.clear=Vu,Tn.prototype.delete=zu,Tn.prototype.get=Yu,Tn.prototype.has=$u,Tn.prototype.set=Xu;function Xe(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var o=t[e];this.set(o[0],o[1])}}function Zu(){this.__data__=[],this.size=0}function Ju(t){var e=this.__data__,n=Br(e,t);if(n<0)return!1;var o=e.length-1;return n==o?e.pop():Sr.call(e,n,1),--this.size,!0}function qu(t){var e=this.__data__,n=Br(e,t);return n<0?s:e[n][1]}function Qu(t){return Br(this.__data__,t)>-1}function ju(t,e){var n=this.__data__,o=Br(n,t);return o<0?(++this.size,n.push([t,e])):n[o][1]=e,this}Xe.prototype.clear=Zu,Xe.prototype.delete=Ju,Xe.prototype.get=qu,Xe.prototype.has=Qu,Xe.prototype.set=ju;function Ze(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var o=t[e];this.set(o[0],o[1])}}function tf(){this.size=0,this.__data__={hash:new Tn,map:new(xi||Xe),string:new Tn}}function ef(t){var e=Gr(this,t).delete(t);return this.size-=e?1:0,e}function nf(t){return Gr(this,t).get(t)}function rf(t){return Gr(this,t).has(t)}function sf(t,e){var n=Gr(this,t),o=n.size;return n.set(t,e),this.size+=n.size==o?0:1,this}Ze.prototype.clear=tf,Ze.prototype.delete=ef,Ze.prototype.get=nf,Ze.prototype.has=rf,Ze.prototype.set=sf;function Pn(t){var e=-1,n=t==null?0:t.length;for(this.__data__=new Ze;++e<n;)this.add(t[e])}function of(t){return this.__data__.set(t,a),this}function af(t){return this.__data__.has(t)}Pn.prototype.add=Pn.prototype.push=of,Pn.prototype.has=af;function Le(t){var e=this.__data__=new Xe(t);this.size=e.size}function lf(){this.__data__=new Xe,this.size=0}function uf(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}function ff(t){return this.__data__.get(t)}function cf(t){return this.__data__.has(t)}function hf(t,e){var n=this.__data__;if(n instanceof Xe){var o=n.__data__;if(!xi||o.length<p-1)return o.push([t,e]),this.size=++n.size,this;n=this.__data__=new Ze(o)}return n.set(t,e),this.size=n.size,this}Le.prototype.clear=lf,Le.prototype.delete=uf,Le.prototype.get=ff,Le.prototype.has=cf,Le.prototype.set=hf;function ia(t,e){var n=ct(t),o=!n&&Un(t),E=!n&&!o&&En(t),P=!n&&!o&&!E&&ti(t),O=n||o||E||P,k=O?Os(t.length,Cu):[],N=k.length;for(var z in t)(e||Tt.call(t,z))&&!(O&&(z=="length"||E&&(z=="offset"||z=="parent")||P&&(z=="buffer"||z=="byteLength"||z=="byteOffset")||je(z,N)))&&k.push(z);return k}function ra(t){var e=t.length;return e?t[Js(0,e-1)]:s}function gf(t,e){return Hr(oe(t),Mn(e,0,t.length))}function pf(t){return Hr(oe(t))}function Ns(t,e,n){(n!==s&&!ke(t[e],n)||n===s&&!(e in t))&&Je(t,e,n)}function wi(t,e,n){var o=t[e];(!(Tt.call(t,e)&&ke(o,n))||n===s&&!(e in t))&&Je(t,e,n)}function Br(t,e){for(var n=t.length;n--;)if(ke(t[n][0],e))return n;return-1}function mf(t,e,n,o){return dn(t,function(E,P,O){e(o,E,n(E),O)}),o}function sa(t,e){return t&&We(e,zt(e),t)}function df(t,e){return t&&We(e,le(e),t)}function Je(t,e,n){e=="__proto__"&&wr?wr(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function Gs(t,e){for(var n=-1,o=e.length,E=G(o),P=t==null;++n<o;)E[n]=P?s:So(t,e[n]);return E}function Mn(t,e,n){return t===t&&(n!==s&&(t=t<=n?t:n),e!==s&&(t=t>=e?t:e)),t}function Te(t,e,n,o,E,P){var O,k=e&x,N=e&v,z=e&r;if(n&&(O=E?n(t,o,E,P):n(t)),O!==s)return O;if(!Ot(t))return t;var Y=ct(t);if(Y){if(O=rc(t),!k)return oe(t,O)}else{var $=jt(t),q=$==It||$==Rn;if(En(t))return Ba(t,k);if($==se||$==Wt||q&&!E){if(O=N||q?{}:Xa(t),!k)return N?$f(t,df(O,t)):Yf(t,sa(O,t))}else{if(!bt[$])return E?t:{};O=sc(t,$,k)}}P||(P=new Le);var nt=P.get(t);if(nt)return nt;P.set(t,O),wl(t)?t.forEach(function(st){O.add(Te(st,e,n,st,t,P))}):Cl(t)&&t.forEach(function(st,mt){O.set(mt,Te(st,e,n,mt,t,P))});var rt=z?N?ao:oo:N?le:zt,gt=Y?s:rt(t);return Se(gt||t,function(st,mt){gt&&(mt=st,st=t[mt]),wi(O,mt,Te(st,e,n,mt,t,P))}),O}function yf(t){var e=zt(t);return function(n){return oa(n,t,e)}}function oa(t,e,n){var o=n.length;if(t==null)return!o;for(t=At(t);o--;){var E=n[o],P=e[E],O=t[E];if(O===s&&!(E in t)||!P(O))return!1}return!0}function aa(t,e,n){if(typeof t!="function")throw new we(u);return Ai(function(){t.apply(s,n)},e)}function bi(t,e,n,o){var E=-1,P=hr,O=!0,k=t.length,N=[],z=e.length;if(!k)return N;n&&(e=Rt(e,de(n))),o?(P=Ms,O=!1):e.length>=p&&(P=yi,O=!1,e=new Pn(e));t:for(;++E<k;){var Y=t[E],$=n==null?Y:n(Y);if(Y=o||Y!==0?Y:0,O&&$===$){for(var q=z;q--;)if(e[q]===$)continue t;N.push(Y)}else P(e,$,o)||N.push(Y)}return N}var dn=Ia(Fe),la=Ia(Ks,!0);function vf(t,e){var n=!0;return dn(t,function(o,E,P){return n=!!e(o,E,P),n}),n}function Ar(t,e,n){for(var o=-1,E=t.length;++o<E;){var P=t[o],O=e(P);if(O!=null&&(k===s?O===O&&!ve(O):n(O,k)))var k=O,N=P}return N}function xf(t,e,n,o){var E=t.length;for(n=ht(n),n<0&&(n=-n>E?0:E+n),o=o===s||o>E?E:ht(o),o<0&&(o+=E),o=n>o?0:Tl(o);n<o;)t[n++]=e;return t}function ua(t,e){var n=[];return dn(t,function(o,E,P){e(o,E,P)&&n.push(o)}),n}function Yt(t,e,n,o,E){var P=-1,O=t.length;for(n||(n=ac),E||(E=[]);++P<O;){var k=t[P];e>0&&n(k)?e>1?Yt(k,e-1,n,o,E):gn(E,k):o||(E[E.length]=k)}return E}var Hs=La(),fa=La(!0);function Fe(t,e){return t&&Hs(t,e,zt)}function Ks(t,e){return t&&fa(t,e,zt)}function Ur(t,e){return hn(e,function(n){return tn(t[n])})}function _n(t,e){e=vn(e,t);for(var n=0,o=e.length;t!=null&&n<o;)t=t[Ne(e[n++])];return n&&n==o?t:s}function ca(t,e,n){var o=e(t);return ct(t)?o:gn(o,n(t))}function ee(t){return t==null?t===s?Cn:On:bn&&bn in At(t)?ec(t):pc(t)}function Vs(t,e){return t>e}function Ef(t,e){return t!=null&&Tt.call(t,e)}function Cf(t,e){return t!=null&&e in At(t)}function Sf(t,e,n){return t>=Qt(e,n)&&t<Kt(e,n)}function zs(t,e,n){for(var o=n?Ms:hr,E=t[0].length,P=t.length,O=P,k=G(P),N=1/0,z=[];O--;){var Y=t[O];O&&e&&(Y=Rt(Y,de(e))),N=Qt(Y.length,N),k[O]=!n&&(e||E>=120&&Y.length>=120)?new Pn(O&&Y):s}Y=t[0];var $=-1,q=k[0];t:for(;++$<E&&z.length<N;){var nt=Y[$],rt=e?e(nt):nt;if(nt=n||nt!==0?nt:0,!(q?yi(q,rt):o(z,rt,n))){for(O=P;--O;){var gt=k[O];if(!(gt?yi(gt,rt):o(t[O],rt,n)))continue t}q&&q.push(rt),z.push(nt)}}return z}function wf(t,e,n,o){return Fe(t,function(E,P,O){e(o,n(E),P,O)}),o}function Ti(t,e,n){e=vn(e,t),t=Qa(t,e);var o=t==null?t:t[Ne(Me(e))];return o==null?s:me(o,t,n)}function ha(t){return Lt(t)&&ee(t)==Wt}function bf(t){return Lt(t)&&ee(t)==Ke}function Tf(t){return Lt(t)&&ee(t)==re}function Pi(t,e,n,o,E){return t===e?!0:t==null||e==null||!Lt(t)&&!Lt(e)?t!==t&&e!==e:Pf(t,e,n,o,Pi,E)}function Pf(t,e,n,o,E,P){var O=ct(t),k=ct(e),N=O?ft:jt(t),z=k?ft:jt(e);N=N==Wt?se:N,z=z==Wt?se:z;var Y=N==se,$=z==se,q=N==z;if(q&&En(t)){if(!En(e))return!1;O=!0,Y=!1}if(q&&!Y)return P||(P=new Le),O||ti(t)?za(t,e,n,o,E,P):jf(t,e,N,n,o,E,P);if(!(n&h)){var nt=Y&&Tt.call(t,"__wrapped__"),rt=$&&Tt.call(e,"__wrapped__");if(nt||rt){var gt=nt?t.value():t,st=rt?e.value():e;return P||(P=new Le),E(gt,st,n,o,P)}}return q?(P||(P=new Le),tc(t,e,n,o,E,P)):!1}function Mf(t){return Lt(t)&&jt(t)==te}function Ys(t,e,n,o){var E=n.length,P=E,O=!o;if(t==null)return!P;for(t=At(t);E--;){var k=n[E];if(O&&k[2]?k[1]!==t[k[0]]:!(k[0]in t))return!1}for(;++E<P;){k=n[E];var N=k[0],z=t[N],Y=k[1];if(O&&k[2]){if(z===s&&!(N in t))return!1}else{var $=new Le;if(o)var q=o(z,Y,N,t,e,$);if(!(q===s?Pi(Y,z,h|c,o,$):q))return!1}}return!0}function ga(t){if(!Ot(t)||uc(t))return!1;var e=tn(t)?Pu:ps;return e.test(An(t))}function _f(t){return Lt(t)&&ee(t)==he}function Bf(t){return Lt(t)&&jt(t)==Nt}function Af(t){return Lt(t)&&Xr(t.length)&&!!Bt[ee(t)]}function pa(t){return typeof t=="function"?t:t==null?ue:typeof t=="object"?ct(t)?ya(t[0],t[1]):da(t):kl(t)}function $s(t){if(!Bi(t))return Ru(t);var e=[];for(var n in At(t))Tt.call(t,n)&&n!="constructor"&&e.push(n);return e}function Uf(t){if(!Ot(t))return gc(t);var e=Bi(t),n=[];for(var o in t)o=="constructor"&&(e||!Tt.call(t,o))||n.push(o);return n}function Xs(t,e){return t<e}function ma(t,e){var n=-1,o=ae(t)?G(t.length):[];return dn(t,function(E,P,O){o[++n]=e(E,P,O)}),o}function da(t){var e=uo(t);return e.length==1&&e[0][2]?Ja(e[0][0],e[0][1]):function(n){return n===t||Ys(n,t,e)}}function ya(t,e){return co(t)&&Za(e)?Ja(Ne(t),e):function(n){var o=So(n,t);return o===s&&o===e?wo(n,t):Pi(e,o,h|c)}}function Rr(t,e,n,o,E){t!==e&&Hs(e,function(P,O){if(E||(E=new Le),Ot(P))Rf(t,e,O,n,Rr,o,E);else{var k=o?o(go(t,O),P,O+"",t,e,E):s;k===s&&(k=P),Ns(t,O,k)}},le)}function Rf(t,e,n,o,E,P,O){var k=go(t,n),N=go(e,n),z=O.get(N);if(z){Ns(t,n,z);return}var Y=P?P(k,N,n+"",t,e,O):s,$=Y===s;if($){var q=ct(N),nt=!q&&En(N),rt=!q&&!nt&&ti(N);Y=N,q||nt||rt?ct(k)?Y=k:Dt(k)?Y=oe(k):nt?($=!1,Y=Ba(N,!0)):rt?($=!1,Y=Aa(N,!0)):Y=[]:Ui(N)||Un(N)?(Y=k,Un(k)?Y=Pl(k):(!Ot(k)||tn(k))&&(Y=Xa(N))):$=!1}$&&(O.set(N,Y),E(Y,N,o,P,O),O.delete(N)),Ns(t,n,Y)}function va(t,e){var n=t.length;if(n)return e+=e<0?n:0,je(e,n)?t[e]:s}function xa(t,e,n){e.length?e=Rt(e,function(P){return ct(P)?function(O){return _n(O,P.length===1?P[0]:P)}:P}):e=[ue];var o=-1;e=Rt(e,de(it()));var E=ma(t,function(P,O,k){var N=Rt(e,function(z){return z(P)});return{criteria:N,index:++o,value:P}});return ru(E,function(P,O){return zf(P,O,n)})}function Of(t,e){return Ea(t,e,function(n,o){return wo(t,o)})}function Ea(t,e,n){for(var o=-1,E=e.length,P={};++o<E;){var O=e[o],k=_n(t,O);n(k,O)&&Mi(P,vn(O,t),k)}return P}function If(t){return function(e){return _n(e,t)}}function Zs(t,e,n,o){var E=o?iu:Kn,P=-1,O=e.length,k=t;for(t===e&&(e=oe(e)),n&&(k=Rt(t,de(n)));++P<O;)for(var N=0,z=e[P],Y=n?n(z):z;(N=E(k,Y,N,o))>-1;)k!==t&&Sr.call(k,N,1),Sr.call(t,N,1);return t}function Ca(t,e){for(var n=t?e.length:0,o=n-1;n--;){var E=e[n];if(n==o||E!==P){var P=E;je(E)?Sr.call(t,E,1):js(t,E)}}return t}function Js(t,e){return t+Tr(ea()*(e-t+1))}function Lf(t,e,n,o){for(var E=-1,P=Kt(br((e-t)/(n||1)),0),O=G(P);P--;)O[o?P:++E]=t,t+=n;return O}function qs(t,e){var n="";if(!t||e<1||e>at)return n;do e%2&&(n+=t),e=Tr(e/2),e&&(t+=t);while(e);return n}function pt(t,e){return po(qa(t,e,ue),t+"")}function kf(t){return ra(ei(t))}function Df(t,e){var n=ei(t);return Hr(n,Mn(e,0,n.length))}function Mi(t,e,n,o){if(!Ot(t))return t;e=vn(e,t);for(var E=-1,P=e.length,O=P-1,k=t;k!=null&&++E<P;){var N=Ne(e[E]),z=n;if(N==="__proto__"||N==="constructor"||N==="prototype")return t;if(E!=O){var Y=k[N];z=o?o(Y,N,k):s,z===s&&(z=Ot(Y)?Y:je(e[E+1])?[]:{})}wi(k,N,z),k=k[N]}return t}var Sa=Pr?function(t,e){return Pr.set(t,e),t}:ue,Ff=wr?function(t,e){return wr(t,"toString",{configurable:!0,enumerable:!1,value:To(e),writable:!0})}:ue;function Wf(t){return Hr(ei(t))}function Pe(t,e,n){var o=-1,E=t.length;e<0&&(e=-e>E?0:E+e),n=n>E?E:n,n<0&&(n+=E),E=e>n?0:n-e>>>0,e>>>=0;for(var P=G(E);++o<E;)P[o]=t[o+e];return P}function Nf(t,e){var n;return dn(t,function(o,E,P){return n=e(o,E,P),!n}),!!n}function Or(t,e,n){var o=0,E=t==null?o:t.length;if(typeof e=="number"&&e===e&&E<=ut){for(;o<E;){var P=o+E>>>1,O=t[P];O!==null&&!ve(O)&&(n?O<=e:O<e)?o=P+1:E=P}return E}return Qs(t,e,ue,n)}function Qs(t,e,n,o){var E=0,P=t==null?0:t.length;if(P===0)return 0;e=n(e);for(var O=e!==e,k=e===null,N=ve(e),z=e===s;E<P;){var Y=Tr((E+P)/2),$=n(t[Y]),q=$!==s,nt=$===null,rt=$===$,gt=ve($);if(O)var st=o||rt;else z?st=rt&&(o||q):k?st=rt&&q&&(o||!nt):N?st=rt&&q&&!nt&&(o||!gt):nt||gt?st=!1:st=o?$<=e:$<e;st?E=Y+1:P=Y}return Qt(P,kt)}function wa(t,e){for(var n=-1,o=t.length,E=0,P=[];++n<o;){var O=t[n],k=e?e(O):O;if(!n||!ke(k,N)){var N=k;P[E++]=O===0?0:O}}return P}function ba(t){return typeof t=="number"?t:ve(t)?_t:+t}function ye(t){if(typeof t=="string")return t;if(ct(t))return Rt(t,ye)+"";if(ve(t))return na?na.call(t):"";var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}function yn(t,e,n){var o=-1,E=hr,P=t.length,O=!0,k=[],N=k;if(n)O=!1,E=Ms;else if(P>=p){var z=e?null:qf(t);if(z)return pr(z);O=!1,E=yi,N=new Pn}else N=e?[]:k;t:for(;++o<P;){var Y=t[o],$=e?e(Y):Y;if(Y=n||Y!==0?Y:0,O&&$===$){for(var q=N.length;q--;)if(N[q]===$)continue t;e&&N.push($),k.push(Y)}else E(N,$,n)||(N!==k&&N.push($),k.push(Y))}return k}function js(t,e){return e=vn(e,t),t=Qa(t,e),t==null||delete t[Ne(Me(e))]}function Ta(t,e,n,o){return Mi(t,e,n(_n(t,e)),o)}function Ir(t,e,n,o){for(var E=t.length,P=o?E:-1;(o?P--:++P<E)&&e(t[P],P,t););return n?Pe(t,o?0:P,o?P+1:E):Pe(t,o?P+1:0,o?E:P)}function Pa(t,e){var n=t;return n instanceof yt&&(n=n.value()),_s(e,function(o,E){return E.func.apply(E.thisArg,gn([o],E.args))},n)}function to(t,e,n){var o=t.length;if(o<2)return o?yn(t[0]):[];for(var E=-1,P=G(o);++E<o;)for(var O=t[E],k=-1;++k<o;)k!=E&&(P[E]=bi(P[E]||O,t[k],e,n));return yn(Yt(P,1),e,n)}function Ma(t,e,n){for(var o=-1,E=t.length,P=e.length,O={};++o<E;){var k=o<P?e[o]:s;n(O,t[o],k)}return O}function eo(t){return Dt(t)?t:[]}function no(t){return typeof t=="function"?t:ue}function vn(t,e){return ct(t)?t:co(t,e)?[t]:nl(wt(t))}var Gf=pt;function xn(t,e,n){var o=t.length;return n=n===s?o:n,!e&&n>=o?t:Pe(t,e,n)}var _a=Mu||function(t){return ot.clearTimeout(t)};function Ba(t,e){if(e)return t.slice();var n=t.length,o=Jo?Jo(n):new t.constructor(n);return t.copy(o),o}function io(t){var e=new t.constructor(t.byteLength);return new Er(e).set(new Er(t)),e}function Hf(t,e){var n=e?io(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}function Kf(t){var e=new t.constructor(t.source,Ki.exec(t));return e.lastIndex=t.lastIndex,e}function Vf(t){return Si?At(Si.call(t)):{}}function Aa(t,e){var n=e?io(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}function Ua(t,e){if(t!==e){var n=t!==s,o=t===null,E=t===t,P=ve(t),O=e!==s,k=e===null,N=e===e,z=ve(e);if(!k&&!z&&!P&&t>e||P&&O&&N&&!k&&!z||o&&O&&N||!n&&N||!E)return 1;if(!o&&!P&&!z&&t<e||z&&n&&E&&!o&&!P||k&&n&&E||!O&&E||!N)return-1}return 0}function zf(t,e,n){for(var o=-1,E=t.criteria,P=e.criteria,O=E.length,k=n.length;++o<O;){var N=Ua(E[o],P[o]);if(N){if(o>=k)return N;var z=n[o];return N*(z=="desc"?-1:1)}}return t.index-e.index}function Ra(t,e,n,o){for(var E=-1,P=t.length,O=n.length,k=-1,N=e.length,z=Kt(P-O,0),Y=G(N+z),$=!o;++k<N;)Y[k]=e[k];for(;++E<O;)($||E<P)&&(Y[n[E]]=t[E]);for(;z--;)Y[k++]=t[E++];return Y}function Oa(t,e,n,o){for(var E=-1,P=t.length,O=-1,k=n.length,N=-1,z=e.length,Y=Kt(P-k,0),$=G(Y+z),q=!o;++E<Y;)$[E]=t[E];for(var nt=E;++N<z;)$[nt+N]=e[N];for(;++O<k;)(q||E<P)&&($[nt+n[O]]=t[E++]);return $}function oe(t,e){var n=-1,o=t.length;for(e||(e=G(o));++n<o;)e[n]=t[n];return e}function We(t,e,n,o){var E=!n;n||(n={});for(var P=-1,O=e.length;++P<O;){var k=e[P],N=o?o(n[k],t[k],k,n,t):s;N===s&&(N=t[k]),E?Je(n,k,N):wi(n,k,N)}return n}function Yf(t,e){return We(t,fo(t),e)}function $f(t,e){return We(t,Ya(t),e)}function Lr(t,e){return function(n,o){var E=ct(n)?ql:mf,P=e?e():{};return E(n,t,it(o,2),P)}}function qn(t){return pt(function(e,n){var o=-1,E=n.length,P=E>1?n[E-1]:s,O=E>2?n[2]:s;for(P=t.length>3&&typeof P=="function"?(E--,P):s,O&&ne(n[0],n[1],O)&&(P=E<3?s:P,E=1),e=At(e);++o<E;){var k=n[o];k&&t(e,k,o,P)}return e})}function Ia(t,e){return function(n,o){if(n==null)return n;if(!ae(n))return t(n,o);for(var E=n.length,P=e?E:-1,O=At(n);(e?P--:++P<E)&&o(O[P],P,O)!==!1;);return n}}function La(t){return function(e,n,o){for(var E=-1,P=At(e),O=o(e),k=O.length;k--;){var N=O[t?k:++E];if(n(P[N],N,P)===!1)break}return e}}function Xf(t,e,n){var o=e&d,E=_i(t);function P(){var O=this&&this!==ot&&this instanceof P?E:t;return O.apply(o?n:this,arguments)}return P}function ka(t){return function(e){e=wt(e);var n=Vn(e)?Ie(e):s,o=n?n[0]:e.charAt(0),E=n?xn(n,1).join(""):e.slice(1);return o[t]()+E}}function Qn(t){return function(e){return _s(Il(Ol(e).replace(ur,"")),t,"")}}function _i(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=Jn(t.prototype),o=t.apply(n,e);return Ot(o)?o:n}}function Zf(t,e,n){var o=_i(t);function E(){for(var P=arguments.length,O=G(P),k=P,N=jn(E);k--;)O[k]=arguments[k];var z=P<3&&O[0]!==N&&O[P-1]!==N?[]:pn(O,N);if(P-=z.length,P<n)return Ga(t,e,kr,E.placeholder,s,O,z,s,s,n-P);var Y=this&&this!==ot&&this instanceof E?o:t;return me(Y,this,O)}return E}function Da(t){return function(e,n,o){var E=At(e);if(!ae(e)){var P=it(n,3);e=zt(e),n=function(k){return P(E[k],k,E)}}var O=t(e,n,o);return O>-1?E[P?e[O]:O]:s}}function Fa(t){return Qe(function(e){var n=e.length,o=n,E=be.prototype.thru;for(t&&e.reverse();o--;){var P=e[o];if(typeof P!="function")throw new we(u);if(E&&!O&&Nr(P)=="wrapper")var O=new be([],!0)}for(o=O?o:n;++o<n;){P=e[o];var k=Nr(P),N=k=="wrapper"?lo(P):s;N&&ho(N[0])&&N[1]==(M|U|y|T)&&!N[4].length&&N[9]==1?O=O[Nr(N[0])].apply(O,N[3]):O=P.length==1&&ho(P)?O[k]():O.thru(P)}return function(){var z=arguments,Y=z[0];if(O&&z.length==1&&ct(Y))return O.plant(Y).value();for(var $=0,q=n?e[$].apply(this,z):Y;++$<n;)q=e[$].call(this,q);return q}})}function kr(t,e,n,o,E,P,O,k,N,z){var Y=e&M,$=e&d,q=e&S,nt=e&(U|_),rt=e&I,gt=q?s:_i(t);function st(){for(var mt=arguments.length,xt=G(mt),xe=mt;xe--;)xt[xe]=arguments[xe];if(nt)var ie=jn(st),Ee=ou(xt,ie);if(o&&(xt=Ra(xt,o,E,nt)),P&&(xt=Oa(xt,P,O,nt)),mt-=Ee,nt&&mt<z){var Ft=pn(xt,ie);return Ga(t,e,kr,st.placeholder,n,xt,Ft,k,N,z-mt)}var De=$?n:this,nn=q?De[t]:t;return mt=xt.length,k?xt=mc(xt,k):rt&&mt>1&&xt.reverse(),Y&&N<mt&&(xt.length=N),this&&this!==ot&&this instanceof st&&(nn=gt||_i(nn)),nn.apply(De,xt)}return st}function Wa(t,e){return function(n,o){return wf(n,t,e(o),{})}}function Dr(t,e){return function(n,o){var E;if(n===s&&o===s)return e;if(n!==s&&(E=n),o!==s){if(E===s)return o;typeof n=="string"||typeof o=="string"?(n=ye(n),o=ye(o)):(n=ba(n),o=ba(o)),E=t(n,o)}return E}}function ro(t){return Qe(function(e){return e=Rt(e,de(it())),pt(function(n){var o=this;return t(e,function(E){return me(E,o,n)})})})}function Fr(t,e){e=e===s?" ":ye(e);var n=e.length;if(n<2)return n?qs(e,t):e;var o=qs(e,br(t/zn(e)));return Vn(e)?xn(Ie(o),0,t).join(""):o.slice(0,t)}function Jf(t,e,n,o){var E=e&d,P=_i(t);function O(){for(var k=-1,N=arguments.length,z=-1,Y=o.length,$=G(Y+N),q=this&&this!==ot&&this instanceof O?P:t;++z<Y;)$[z]=o[z];for(;N--;)$[z++]=arguments[++k];return me(q,E?n:this,$)}return O}function Na(t){return function(e,n,o){return o&&typeof o!="number"&&ne(e,n,o)&&(n=o=s),e=en(e),n===s?(n=e,e=0):n=en(n),o=o===s?e<n?1:-1:en(o),Lf(e,n,o,t)}}function Wr(t){return function(e,n){return typeof e=="string"&&typeof n=="string"||(e=_e(e),n=_e(n)),t(e,n)}}function Ga(t,e,n,o,E,P,O,k,N,z){var Y=e&U,$=Y?O:s,q=Y?s:O,nt=Y?P:s,rt=Y?s:P;e|=Y?y:w,e&=~(Y?w:y),e&B||(e&=-4);var gt=[t,e,E,nt,$,rt,q,k,N,z],st=n.apply(s,gt);return ho(t)&&ja(st,gt),st.placeholder=o,tl(st,t,e)}function so(t){var e=Ht[t];return function(n,o){if(n=_e(n),o=o==null?0:Qt(ht(o),292),o&&ta(n)){var E=(wt(n)+"e").split("e"),P=e(E[0]+"e"+(+E[1]+o));return E=(wt(P)+"e").split("e"),+(E[0]+"e"+(+E[1]-o))}return e(n)}}var qf=Xn&&1/pr(new Xn([,-0]))[1]==Q?function(t){return new Xn(t)}:_o;function Ha(t){return function(e){var n=jt(e);return n==te?Ls(e):n==Nt?gu(e):su(e,t(e))}}function qe(t,e,n,o,E,P,O,k){var N=e&S;if(!N&&typeof t!="function")throw new we(u);var z=o?o.length:0;if(z||(e&=-97,o=E=s),O=O===s?O:Kt(ht(O),0),k=k===s?k:ht(k),z-=E?E.length:0,e&w){var Y=o,$=E;o=E=s}var q=N?s:lo(t),nt=[t,e,n,o,E,Y,$,P,O,k];if(q&&hc(nt,q),t=nt[0],e=nt[1],n=nt[2],o=nt[3],E=nt[4],k=nt[9]=nt[9]===s?N?0:t.length:Kt(nt[9]-z,0),!k&&e&(U|_)&&(e&=-25),!e||e==d)var rt=Xf(t,e,n);else e==U||e==_?rt=Zf(t,e,k):(e==y||e==(d|y))&&!E.length?rt=Jf(t,e,n,o):rt=kr.apply(s,nt);var gt=q?Sa:ja;return tl(gt(rt,nt),t,e)}function Ka(t,e,n,o){return t===s||ke(t,$n[n])&&!Tt.call(o,n)?e:t}function Va(t,e,n,o,E,P){return Ot(t)&&Ot(e)&&(P.set(e,t),Rr(t,e,s,Va,P),P.delete(e)),t}function Qf(t){return Ui(t)?s:t}function za(t,e,n,o,E,P){var O=n&h,k=t.length,N=e.length;if(k!=N&&!(O&&N>k))return!1;var z=P.get(t),Y=P.get(e);if(z&&Y)return z==e&&Y==t;var $=-1,q=!0,nt=n&c?new Pn:s;for(P.set(t,e),P.set(e,t);++$<k;){var rt=t[$],gt=e[$];if(o)var st=O?o(gt,rt,$,e,t,P):o(rt,gt,$,t,e,P);if(st!==s){if(st)continue;q=!1;break}if(nt){if(!Bs(e,function(mt,xt){if(!yi(nt,xt)&&(rt===mt||E(rt,mt,n,o,P)))return nt.push(xt)})){q=!1;break}}else if(!(rt===gt||E(rt,gt,n,o,P))){q=!1;break}}return P.delete(t),P.delete(e),q}function jf(t,e,n,o,E,P,O){switch(n){case pe:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case Ke:return!(t.byteLength!=e.byteLength||!P(new Er(t),new Er(e)));case Pt:case re:case He:return ke(+t,+e);case Vt:return t.name==e.name&&t.message==e.message;case he:case ge:return t==e+"";case te:var k=Ls;case Nt:var N=o&h;if(k||(k=pr),t.size!=e.size&&!N)return!1;var z=O.get(t);if(z)return z==e;o|=c,O.set(t,e);var Y=za(k(t),k(e),o,E,P,O);return O.delete(t),Y;case Zt:if(Si)return Si.call(t)==Si.call(e)}return!1}function tc(t,e,n,o,E,P){var O=n&h,k=oo(t),N=k.length,z=oo(e),Y=z.length;if(N!=Y&&!O)return!1;for(var $=N;$--;){var q=k[$];if(!(O?q in e:Tt.call(e,q)))return!1}var nt=P.get(t),rt=P.get(e);if(nt&&rt)return nt==e&&rt==t;var gt=!0;P.set(t,e),P.set(e,t);for(var st=O;++$<N;){q=k[$];var mt=t[q],xt=e[q];if(o)var xe=O?o(xt,mt,q,e,t,P):o(mt,xt,q,t,e,P);if(!(xe===s?mt===xt||E(mt,xt,n,o,P):xe)){gt=!1;break}st||(st=q=="constructor")}if(gt&&!st){var ie=t.constructor,Ee=e.constructor;ie!=Ee&&"constructor"in t&&"constructor"in e&&!(typeof ie=="function"&&ie instanceof ie&&typeof Ee=="function"&&Ee instanceof Ee)&&(gt=!1)}return P.delete(t),P.delete(e),gt}function Qe(t){return po(qa(t,s,ol),t+"")}function oo(t){return ca(t,zt,fo)}function ao(t){return ca(t,le,Ya)}var lo=Pr?function(t){return Pr.get(t)}:_o;function Nr(t){for(var e=t.name+"",n=Zn[e],o=Tt.call(Zn,e)?n.length:0;o--;){var E=n[o],P=E.func;if(P==null||P==t)return E.name}return e}function jn(t){var e=Tt.call(b,"placeholder")?b:t;return e.placeholder}function it(){var t=b.iteratee||Po;return t=t===Po?pa:t,arguments.length?t(arguments[0],arguments[1]):t}function Gr(t,e){var n=t.__data__;return lc(e)?n[typeof e=="string"?"string":"hash"]:n.map}function uo(t){for(var e=zt(t),n=e.length;n--;){var o=e[n],E=t[o];e[n]=[o,E,Za(E)]}return e}function Bn(t,e){var n=fu(t,e);return ga(n)?n:s}function ec(t){var e=Tt.call(t,bn),n=t[bn];try{t[bn]=s;var o=!0}catch{}var E=vr.call(t);return o&&(e?t[bn]=n:delete t[bn]),E}var fo=Ds?function(t){return t==null?[]:(t=At(t),hn(Ds(t),function(e){return Qo.call(t,e)}))}:Bo,Ya=Ds?function(t){for(var e=[];t;)gn(e,fo(t)),t=Cr(t);return e}:Bo,jt=ee;(Fs&&jt(new Fs(new ArrayBuffer(1)))!=pe||xi&&jt(new xi)!=te||Ws&&jt(Ws.resolve())!=rn||Xn&&jt(new Xn)!=Nt||Ei&&jt(new Ei)!=Be)&&(jt=function(t){var e=ee(t),n=e==se?t.constructor:s,o=n?An(n):"";if(o)switch(o){case ku:return pe;case Du:return te;case Fu:return rn;case Wu:return Nt;case Nu:return Be}return e});function nc(t,e,n){for(var o=-1,E=n.length;++o<E;){var P=n[o],O=P.size;switch(P.type){case"drop":t+=O;break;case"dropRight":e-=O;break;case"take":e=Qt(e,t+O);break;case"takeRight":t=Kt(t,e-O);break}}return{start:t,end:e}}function ic(t){var e=t.match(as);return e?e[1].split(ls):[]}function $a(t,e,n){e=vn(e,t);for(var o=-1,E=e.length,P=!1;++o<E;){var O=Ne(e[o]);if(!(P=t!=null&&n(t,O)))break;t=t[O]}return P||++o!=E?P:(E=t==null?0:t.length,!!E&&Xr(E)&&je(O,E)&&(ct(t)||Un(t)))}function rc(t){var e=t.length,n=new t.constructor(e);return e&&typeof t[0]=="string"&&Tt.call(t,"index")&&(n.index=t.index,n.input=t.input),n}function Xa(t){return typeof t.constructor=="function"&&!Bi(t)?Jn(Cr(t)):{}}function sc(t,e,n){var o=t.constructor;switch(e){case Ke:return io(t);case Pt:case re:return new o(+t);case pe:return Hf(t,n);case Ae:case Ue:case In:case Ln:case ni:case ii:case Re:case on:case ri:return Aa(t,n);case te:return new o;case He:case ge:return new o(t);case he:return Kf(t);case Nt:return new o;case Zt:return Vf(t)}}function oc(t,e){var n=e.length;if(!n)return t;var o=n-1;return e[o]=(n>1?"& ":"")+e[o],e=e.join(n>2?", ":" "),t.replace(ln,`{
/* [wrapped with `+e+`] */
`)}function ac(t){return ct(t)||Un(t)||!!(jo&&t&&t[jo])}function je(t,e){var n=typeof t;return e=e??at,!!e&&(n=="number"||n!="symbol"&&ds.test(t))&&t>-1&&t%1==0&&t<e}function ne(t,e,n){if(!Ot(n))return!1;var o=typeof e;return(o=="number"?ae(n)&&je(e,n.length):o=="string"&&e in n)?ke(n[e],t):!1}function co(t,e){if(ct(t))return!1;var n=typeof t;return n=="number"||n=="symbol"||n=="boolean"||t==null||ve(t)?!0:Oe.test(t)||!is.test(t)||e!=null&&t in At(e)}function lc(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function ho(t){var e=Nr(t),n=b[e];if(typeof n!="function"||!(e in yt.prototype))return!1;if(t===n)return!0;var o=lo(n);return!!o&&t===o[0]}function uc(t){return!!Zo&&Zo in t}var fc=dr?tn:Ao;function Bi(t){var e=t&&t.constructor,n=typeof e=="function"&&e.prototype||$n;return t===n}function Za(t){return t===t&&!Ot(t)}function Ja(t,e){return function(n){return n==null?!1:n[t]===e&&(e!==s||t in At(n))}}function cc(t){var e=Yr(t,function(o){return n.size===m&&n.clear(),o}),n=e.cache;return e}function hc(t,e){var n=t[1],o=e[1],E=n|o,P=E<(d|S|M),O=o==M&&n==U||o==M&&n==T&&t[7].length<=e[8]||o==(M|T)&&e[7].length<=e[8]&&n==U;if(!(P||O))return t;o&d&&(t[2]=e[2],E|=n&d?0:B);var k=e[3];if(k){var N=t[3];t[3]=N?Ra(N,k,e[4]):k,t[4]=N?pn(t[3],f):e[4]}return k=e[5],k&&(N=t[5],t[5]=N?Oa(N,k,e[6]):k,t[6]=N?pn(t[5],f):e[6]),k=e[7],k&&(t[7]=k),o&M&&(t[8]=t[8]==null?e[8]:Qt(t[8],e[8])),t[9]==null&&(t[9]=e[9]),t[0]=e[0],t[1]=E,t}function gc(t){var e=[];if(t!=null)for(var n in At(t))e.push(n);return e}function pc(t){return vr.call(t)}function qa(t,e,n){return e=Kt(e===s?t.length-1:e,0),function(){for(var o=arguments,E=-1,P=Kt(o.length-e,0),O=G(P);++E<P;)O[E]=o[e+E];E=-1;for(var k=G(e+1);++E<e;)k[E]=o[E];return k[e]=n(O),me(t,this,k)}}function Qa(t,e){return e.length<2?t:_n(t,Pe(e,0,-1))}function mc(t,e){for(var n=t.length,o=Qt(e.length,n),E=oe(t);o--;){var P=e[o];t[o]=je(P,n)?E[P]:s}return t}function go(t,e){if(!(e==="constructor"&&typeof t[e]=="function")&&e!="__proto__")return t[e]}var ja=el(Sa),Ai=Bu||function(t,e){return ot.setTimeout(t,e)},po=el(Ff);function tl(t,e,n){var o=e+"";return po(t,oc(o,dc(ic(o),n)))}function el(t){var e=0,n=0;return function(){var o=Ou(),E=K-(o-n);if(n=o,E>0){if(++e>=D)return arguments[0]}else e=0;return t.apply(s,arguments)}}function Hr(t,e){var n=-1,o=t.length,E=o-1;for(e=e===s?o:e;++n<e;){var P=Js(n,E),O=t[P];t[P]=t[n],t[n]=O}return t.length=e,t}var nl=cc(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(rs,function(n,o,E,P){e.push(E?P.replace(cs,"$1"):o||n)}),e});function Ne(t){if(typeof t=="string"||ve(t))return t;var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}function An(t){if(t!=null){try{return yr.call(t)}catch{}try{return t+""}catch{}}return""}function dc(t,e){return Se(fe,function(n){var o="_."+n[0];e&n[1]&&!hr(t,o)&&t.push(o)}),t.sort()}function il(t){if(t instanceof yt)return t.clone();var e=new be(t.__wrapped__,t.__chain__);return e.__actions__=oe(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}function yc(t,e,n){(n?ne(t,e,n):e===s)?e=1:e=Kt(ht(e),0);var o=t==null?0:t.length;if(!o||e<1)return[];for(var E=0,P=0,O=G(br(o/e));E<o;)O[P++]=Pe(t,E,E+=e);return O}function vc(t){for(var e=-1,n=t==null?0:t.length,o=0,E=[];++e<n;){var P=t[e];P&&(E[o++]=P)}return E}function xc(){var t=arguments.length;if(!t)return[];for(var e=G(t-1),n=arguments[0],o=t;o--;)e[o-1]=arguments[o];return gn(ct(n)?oe(n):[n],Yt(e,1))}var Ec=pt(function(t,e){return Dt(t)?bi(t,Yt(e,1,Dt,!0)):[]}),Cc=pt(function(t,e){var n=Me(e);return Dt(n)&&(n=s),Dt(t)?bi(t,Yt(e,1,Dt,!0),it(n,2)):[]}),Sc=pt(function(t,e){var n=Me(e);return Dt(n)&&(n=s),Dt(t)?bi(t,Yt(e,1,Dt,!0),s,n):[]});function wc(t,e,n){var o=t==null?0:t.length;return o?(e=n||e===s?1:ht(e),Pe(t,e<0?0:e,o)):[]}function bc(t,e,n){var o=t==null?0:t.length;return o?(e=n||e===s?1:ht(e),e=o-e,Pe(t,0,e<0?0:e)):[]}function Tc(t,e){return t&&t.length?Ir(t,it(e,3),!0,!0):[]}function Pc(t,e){return t&&t.length?Ir(t,it(e,3),!0):[]}function Mc(t,e,n,o){var E=t==null?0:t.length;return E?(n&&typeof n!="number"&&ne(t,e,n)&&(n=0,o=E),xf(t,e,n,o)):[]}function rl(t,e,n){var o=t==null?0:t.length;if(!o)return-1;var E=n==null?0:ht(n);return E<0&&(E=Kt(o+E,0)),gr(t,it(e,3),E)}function sl(t,e,n){var o=t==null?0:t.length;if(!o)return-1;var E=o-1;return n!==s&&(E=ht(n),E=n<0?Kt(o+E,0):Qt(E,o-1)),gr(t,it(e,3),E,!0)}function ol(t){var e=t==null?0:t.length;return e?Yt(t,1):[]}function _c(t){var e=t==null?0:t.length;return e?Yt(t,Q):[]}function Bc(t,e){var n=t==null?0:t.length;return n?(e=e===s?1:ht(e),Yt(t,e)):[]}function Ac(t){for(var e=-1,n=t==null?0:t.length,o={};++e<n;){var E=t[e];o[E[0]]=E[1]}return o}function al(t){return t&&t.length?t[0]:s}function Uc(t,e,n){var o=t==null?0:t.length;if(!o)return-1;var E=n==null?0:ht(n);return E<0&&(E=Kt(o+E,0)),Kn(t,e,E)}function Rc(t){var e=t==null?0:t.length;return e?Pe(t,0,-1):[]}var Oc=pt(function(t){var e=Rt(t,eo);return e.length&&e[0]===t[0]?zs(e):[]}),Ic=pt(function(t){var e=Me(t),n=Rt(t,eo);return e===Me(n)?e=s:n.pop(),n.length&&n[0]===t[0]?zs(n,it(e,2)):[]}),Lc=pt(function(t){var e=Me(t),n=Rt(t,eo);return e=typeof e=="function"?e:s,e&&n.pop(),n.length&&n[0]===t[0]?zs(n,s,e):[]});function kc(t,e){return t==null?"":Uu.call(t,e)}function Me(t){var e=t==null?0:t.length;return e?t[e-1]:s}function Dc(t,e,n){var o=t==null?0:t.length;if(!o)return-1;var E=o;return n!==s&&(E=ht(n),E=E<0?Kt(o+E,0):Qt(E,o-1)),e===e?mu(t,e,E):gr(t,Go,E,!0)}function Fc(t,e){return t&&t.length?va(t,ht(e)):s}var Wc=pt(ll);function ll(t,e){return t&&t.length&&e&&e.length?Zs(t,e):t}function Nc(t,e,n){return t&&t.length&&e&&e.length?Zs(t,e,it(n,2)):t}function Gc(t,e,n){return t&&t.length&&e&&e.length?Zs(t,e,s,n):t}var Hc=Qe(function(t,e){var n=t==null?0:t.length,o=Gs(t,e);return Ca(t,Rt(e,function(E){return je(E,n)?+E:E}).sort(Ua)),o});function Kc(t,e){var n=[];if(!(t&&t.length))return n;var o=-1,E=[],P=t.length;for(e=it(e,3);++o<P;){var O=t[o];e(O,o,t)&&(n.push(O),E.push(o))}return Ca(t,E),n}function mo(t){return t==null?t:Lu.call(t)}function Vc(t,e,n){var o=t==null?0:t.length;return o?(n&&typeof n!="number"&&ne(t,e,n)?(e=0,n=o):(e=e==null?0:ht(e),n=n===s?o:ht(n)),Pe(t,e,n)):[]}function zc(t,e){return Or(t,e)}function Yc(t,e,n){return Qs(t,e,it(n,2))}function $c(t,e){var n=t==null?0:t.length;if(n){var o=Or(t,e);if(o<n&&ke(t[o],e))return o}return-1}function Xc(t,e){return Or(t,e,!0)}function Zc(t,e,n){return Qs(t,e,it(n,2),!0)}function Jc(t,e){var n=t==null?0:t.length;if(n){var o=Or(t,e,!0)-1;if(ke(t[o],e))return o}return-1}function qc(t){return t&&t.length?wa(t):[]}function Qc(t,e){return t&&t.length?wa(t,it(e,2)):[]}function jc(t){var e=t==null?0:t.length;return e?Pe(t,1,e):[]}function th(t,e,n){return t&&t.length?(e=n||e===s?1:ht(e),Pe(t,0,e<0?0:e)):[]}function eh(t,e,n){var o=t==null?0:t.length;return o?(e=n||e===s?1:ht(e),e=o-e,Pe(t,e<0?0:e,o)):[]}function nh(t,e){return t&&t.length?Ir(t,it(e,3),!1,!0):[]}function ih(t,e){return t&&t.length?Ir(t,it(e,3)):[]}var rh=pt(function(t){return yn(Yt(t,1,Dt,!0))}),sh=pt(function(t){var e=Me(t);return Dt(e)&&(e=s),yn(Yt(t,1,Dt,!0),it(e,2))}),oh=pt(function(t){var e=Me(t);return e=typeof e=="function"?e:s,yn(Yt(t,1,Dt,!0),s,e)});function ah(t){return t&&t.length?yn(t):[]}function lh(t,e){return t&&t.length?yn(t,it(e,2)):[]}function uh(t,e){return e=typeof e=="function"?e:s,t&&t.length?yn(t,s,e):[]}function yo(t){if(!(t&&t.length))return[];var e=0;return t=hn(t,function(n){if(Dt(n))return e=Kt(n.length,e),!0}),Os(e,function(n){return Rt(t,As(n))})}function ul(t,e){if(!(t&&t.length))return[];var n=yo(t);return e==null?n:Rt(n,function(o){return me(e,s,o)})}var fh=pt(function(t,e){return Dt(t)?bi(t,e):[]}),ch=pt(function(t){return to(hn(t,Dt))}),hh=pt(function(t){var e=Me(t);return Dt(e)&&(e=s),to(hn(t,Dt),it(e,2))}),gh=pt(function(t){var e=Me(t);return e=typeof e=="function"?e:s,to(hn(t,Dt),s,e)}),ph=pt(yo);function mh(t,e){return Ma(t||[],e||[],wi)}function dh(t,e){return Ma(t||[],e||[],Mi)}var yh=pt(function(t){var e=t.length,n=e>1?t[e-1]:s;return n=typeof n=="function"?(t.pop(),n):s,ul(t,n)});function fl(t){var e=b(t);return e.__chain__=!0,e}function vh(t,e){return e(t),t}function Kr(t,e){return e(t)}var xh=Qe(function(t){var e=t.length,n=e?t[0]:0,o=this.__wrapped__,E=function(P){return Gs(P,t)};return e>1||this.__actions__.length||!(o instanceof yt)||!je(n)?this.thru(E):(o=o.slice(n,+n+(e?1:0)),o.__actions__.push({func:Kr,args:[E],thisArg:s}),new be(o,this.__chain__).thru(function(P){return e&&!P.length&&P.push(s),P}))});function Eh(){return fl(this)}function Ch(){return new be(this.value(),this.__chain__)}function Sh(){this.__values__===s&&(this.__values__=bl(this.value()));var t=this.__index__>=this.__values__.length,e=t?s:this.__values__[this.__index__++];return{done:t,value:e}}function wh(){return this}function bh(t){for(var e,n=this;n instanceof _r;){var o=il(n);o.__index__=0,o.__values__=s,e?E.__wrapped__=o:e=o;var E=o;n=n.__wrapped__}return E.__wrapped__=t,e}function Th(){var t=this.__wrapped__;if(t instanceof yt){var e=t;return this.__actions__.length&&(e=new yt(this)),e=e.reverse(),e.__actions__.push({func:Kr,args:[mo],thisArg:s}),new be(e,this.__chain__)}return this.thru(mo)}function Ph(){return Pa(this.__wrapped__,this.__actions__)}var Mh=Lr(function(t,e,n){Tt.call(t,n)?++t[n]:Je(t,n,1)});function _h(t,e,n){var o=ct(t)?Wo:vf;return n&&ne(t,e,n)&&(e=s),o(t,it(e,3))}function Bh(t,e){var n=ct(t)?hn:ua;return n(t,it(e,3))}var Ah=Da(rl),Uh=Da(sl);function Rh(t,e){return Yt(Vr(t,e),1)}function Oh(t,e){return Yt(Vr(t,e),Q)}function Ih(t,e,n){return n=n===s?1:ht(n),Yt(Vr(t,e),n)}function cl(t,e){var n=ct(t)?Se:dn;return n(t,it(e,3))}function hl(t,e){var n=ct(t)?Ql:la;return n(t,it(e,3))}var Lh=Lr(function(t,e,n){Tt.call(t,n)?t[n].push(e):Je(t,n,[e])});function kh(t,e,n,o){t=ae(t)?t:ei(t),n=n&&!o?ht(n):0;var E=t.length;return n<0&&(n=Kt(E+n,0)),Zr(t)?n<=E&&t.indexOf(e,n)>-1:!!E&&Kn(t,e,n)>-1}var Dh=pt(function(t,e,n){var o=-1,E=typeof e=="function",P=ae(t)?G(t.length):[];return dn(t,function(O){P[++o]=E?me(e,O,n):Ti(O,e,n)}),P}),Fh=Lr(function(t,e,n){Je(t,n,e)});function Vr(t,e){var n=ct(t)?Rt:ma;return n(t,it(e,3))}function Wh(t,e,n,o){return t==null?[]:(ct(e)||(e=e==null?[]:[e]),n=o?s:n,ct(n)||(n=n==null?[]:[n]),xa(t,e,n))}var Nh=Lr(function(t,e,n){t[n?0:1].push(e)},function(){return[[],[]]});function Gh(t,e,n){var o=ct(t)?_s:Ko,E=arguments.length<3;return o(t,it(e,4),n,E,dn)}function Hh(t,e,n){var o=ct(t)?jl:Ko,E=arguments.length<3;return o(t,it(e,4),n,E,la)}function Kh(t,e){var n=ct(t)?hn:ua;return n(t,$r(it(e,3)))}function Vh(t){var e=ct(t)?ra:kf;return e(t)}function zh(t,e,n){(n?ne(t,e,n):e===s)?e=1:e=ht(e);var o=ct(t)?gf:Df;return o(t,e)}function Yh(t){var e=ct(t)?pf:Wf;return e(t)}function $h(t){if(t==null)return 0;if(ae(t))return Zr(t)?zn(t):t.length;var e=jt(t);return e==te||e==Nt?t.size:$s(t).length}function Xh(t,e,n){var o=ct(t)?Bs:Nf;return n&&ne(t,e,n)&&(e=s),o(t,it(e,3))}var Zh=pt(function(t,e){if(t==null)return[];var n=e.length;return n>1&&ne(t,e[0],e[1])?e=[]:n>2&&ne(e[0],e[1],e[2])&&(e=[e[0]]),xa(t,Yt(e,1),[])}),zr=_u||function(){return ot.Date.now()};function Jh(t,e){if(typeof e!="function")throw new we(u);return t=ht(t),function(){if(--t<1)return e.apply(this,arguments)}}function gl(t,e,n){return e=n?s:e,e=t&&e==null?t.length:e,qe(t,M,s,s,s,s,e)}function pl(t,e){var n;if(typeof e!="function")throw new we(u);return t=ht(t),function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=s),n}}var vo=pt(function(t,e,n){var o=d;if(n.length){var E=pn(n,jn(vo));o|=y}return qe(t,o,e,n,E)}),ml=pt(function(t,e,n){var o=d|S;if(n.length){var E=pn(n,jn(ml));o|=y}return qe(e,o,t,n,E)});function dl(t,e,n){e=n?s:e;var o=qe(t,U,s,s,s,s,s,e);return o.placeholder=dl.placeholder,o}function yl(t,e,n){e=n?s:e;var o=qe(t,_,s,s,s,s,s,e);return o.placeholder=yl.placeholder,o}function vl(t,e,n){var o,E,P,O,k,N,z=0,Y=!1,$=!1,q=!0;if(typeof t!="function")throw new we(u);e=_e(e)||0,Ot(n)&&(Y=!!n.leading,$="maxWait"in n,P=$?Kt(_e(n.maxWait)||0,e):P,q="trailing"in n?!!n.trailing:q);function nt(Ft){var De=o,nn=E;return o=E=s,z=Ft,O=t.apply(nn,De),O}function rt(Ft){return z=Ft,k=Ai(mt,e),Y?nt(Ft):O}function gt(Ft){var De=Ft-N,nn=Ft-z,Dl=e-De;return $?Qt(Dl,P-nn):Dl}function st(Ft){var De=Ft-N,nn=Ft-z;return N===s||De>=e||De<0||$&&nn>=P}function mt(){var Ft=zr();if(st(Ft))return xt(Ft);k=Ai(mt,gt(Ft))}function xt(Ft){return k=s,q&&o?nt(Ft):(o=E=s,O)}function xe(){k!==s&&_a(k),z=0,o=N=E=k=s}function ie(){return k===s?O:xt(zr())}function Ee(){var Ft=zr(),De=st(Ft);if(o=arguments,E=this,N=Ft,De){if(k===s)return rt(N);if($)return _a(k),k=Ai(mt,e),nt(N)}return k===s&&(k=Ai(mt,e)),O}return Ee.cancel=xe,Ee.flush=ie,Ee}var qh=pt(function(t,e){return aa(t,1,e)}),Qh=pt(function(t,e,n){return aa(t,_e(e)||0,n)});function jh(t){return qe(t,I)}function Yr(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new we(u);var n=function(){var o=arguments,E=e?e.apply(this,o):o[0],P=n.cache;if(P.has(E))return P.get(E);var O=t.apply(this,o);return n.cache=P.set(E,O)||P,O};return n.cache=new(Yr.Cache||Ze),n}Yr.Cache=Ze;function $r(t){if(typeof t!="function")throw new we(u);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}function tg(t){return pl(2,t)}var eg=Gf(function(t,e){e=e.length==1&&ct(e[0])?Rt(e[0],de(it())):Rt(Yt(e,1),de(it()));var n=e.length;return pt(function(o){for(var E=-1,P=Qt(o.length,n);++E<P;)o[E]=e[E].call(this,o[E]);return me(t,this,o)})}),xo=pt(function(t,e){var n=pn(e,jn(xo));return qe(t,y,s,e,n)}),xl=pt(function(t,e){var n=pn(e,jn(xl));return qe(t,w,s,e,n)}),ng=Qe(function(t,e){return qe(t,T,s,s,s,e)});function ig(t,e){if(typeof t!="function")throw new we(u);return e=e===s?e:ht(e),pt(t,e)}function rg(t,e){if(typeof t!="function")throw new we(u);return e=e==null?0:Kt(ht(e),0),pt(function(n){var o=n[e],E=xn(n,0,e);return o&&gn(E,o),me(t,this,E)})}function sg(t,e,n){var o=!0,E=!0;if(typeof t!="function")throw new we(u);return Ot(n)&&(o="leading"in n?!!n.leading:o,E="trailing"in n?!!n.trailing:E),vl(t,e,{leading:o,maxWait:e,trailing:E})}function og(t){return gl(t,1)}function ag(t,e){return xo(no(e),t)}function lg(){if(!arguments.length)return[];var t=arguments[0];return ct(t)?t:[t]}function ug(t){return Te(t,r)}function fg(t,e){return e=typeof e=="function"?e:s,Te(t,r,e)}function cg(t){return Te(t,x|r)}function hg(t,e){return e=typeof e=="function"?e:s,Te(t,x|r,e)}function gg(t,e){return e==null||oa(t,e,zt(e))}function ke(t,e){return t===e||t!==t&&e!==e}var pg=Wr(Vs),mg=Wr(function(t,e){return t>=e}),Un=ha(function(){return arguments}())?ha:function(t){return Lt(t)&&Tt.call(t,"callee")&&!Qo.call(t,"callee")},ct=G.isArray,dg=Hn?de(Hn):bf;function ae(t){return t!=null&&Xr(t.length)&&!tn(t)}function Dt(t){return Lt(t)&&ae(t)}function yg(t){return t===!0||t===!1||Lt(t)&&ee(t)==Pt}var En=Au||Ao,vg=di?de(di):Tf;function xg(t){return Lt(t)&&t.nodeType===1&&!Ui(t)}function Eg(t){if(t==null)return!0;if(ae(t)&&(ct(t)||typeof t=="string"||typeof t.splice=="function"||En(t)||ti(t)||Un(t)))return!t.length;var e=jt(t);if(e==te||e==Nt)return!t.size;if(Bi(t))return!$s(t).length;for(var n in t)if(Tt.call(t,n))return!1;return!0}function Cg(t,e){return Pi(t,e)}function Sg(t,e,n){n=typeof n=="function"?n:s;var o=n?n(t,e):s;return o===s?Pi(t,e,s,n):!!o}function Eo(t){if(!Lt(t))return!1;var e=ee(t);return e==Vt||e==Xt||typeof t.message=="string"&&typeof t.name=="string"&&!Ui(t)}function wg(t){return typeof t=="number"&&ta(t)}function tn(t){if(!Ot(t))return!1;var e=ee(t);return e==It||e==Rn||e==$t||e==ce}function El(t){return typeof t=="number"&&t==ht(t)}function Xr(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=at}function Ot(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}function Lt(t){return t!=null&&typeof t=="object"}var Cl=Lo?de(Lo):Mf;function bg(t,e){return t===e||Ys(t,e,uo(e))}function Tg(t,e,n){return n=typeof n=="function"?n:s,Ys(t,e,uo(e),n)}function Pg(t){return Sl(t)&&t!=+t}function Mg(t){if(fc(t))throw new lt(i);return ga(t)}function _g(t){return t===null}function Bg(t){return t==null}function Sl(t){return typeof t=="number"||Lt(t)&&ee(t)==He}function Ui(t){if(!Lt(t)||ee(t)!=se)return!1;var e=Cr(t);if(e===null)return!0;var n=Tt.call(e,"constructor")&&e.constructor;return typeof n=="function"&&n instanceof n&&yr.call(n)==bu}var Co=ko?de(ko):_f;function Ag(t){return El(t)&&t>=-9007199254740991&&t<=at}var wl=Do?de(Do):Bf;function Zr(t){return typeof t=="string"||!ct(t)&&Lt(t)&&ee(t)==ge}function ve(t){return typeof t=="symbol"||Lt(t)&&ee(t)==Zt}var ti=Fo?de(Fo):Af;function Ug(t){return t===s}function Rg(t){return Lt(t)&&jt(t)==Be}function Og(t){return Lt(t)&&ee(t)==sn}var Ig=Wr(Xs),Lg=Wr(function(t,e){return t<=e});function bl(t){if(!t)return[];if(ae(t))return Zr(t)?Ie(t):oe(t);if(vi&&t[vi])return hu(t[vi]());var e=jt(t),n=e==te?Ls:e==Nt?pr:ei;return n(t)}function en(t){if(!t)return t===0?t:0;if(t=_e(t),t===Q||t===-1/0){var e=t<0?-1:1;return e*vt}return t===t?t:0}function ht(t){var e=en(t),n=e%1;return e===e?n?e-n:e:0}function Tl(t){return t?Mn(ht(t),0,Ct):0}function _e(t){if(typeof t=="number")return t;if(ve(t))return _t;if(Ot(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=Ot(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=Vo(t);var n=gs.test(t);return n||ms.test(t)?dt(t.slice(2),n?2:8):hs.test(t)?_t:+t}function Pl(t){return We(t,le(t))}function kg(t){return t?Mn(ht(t),-9007199254740991,at):t===0?t:0}function wt(t){return t==null?"":ye(t)}var Dg=qn(function(t,e){if(Bi(e)||ae(e)){We(e,zt(e),t);return}for(var n in e)Tt.call(e,n)&&wi(t,n,e[n])}),Ml=qn(function(t,e){We(e,le(e),t)}),Jr=qn(function(t,e,n,o){We(e,le(e),t,o)}),Fg=qn(function(t,e,n,o){We(e,zt(e),t,o)}),Wg=Qe(Gs);function Ng(t,e){var n=Jn(t);return e==null?n:sa(n,e)}var Gg=pt(function(t,e){t=At(t);var n=-1,o=e.length,E=o>2?e[2]:s;for(E&&ne(e[0],e[1],E)&&(o=1);++n<o;)for(var P=e[n],O=le(P),k=-1,N=O.length;++k<N;){var z=O[k],Y=t[z];(Y===s||ke(Y,$n[z])&&!Tt.call(t,z))&&(t[z]=P[z])}return t}),Hg=pt(function(t){return t.push(s,Va),me(_l,s,t)});function Kg(t,e){return No(t,it(e,3),Fe)}function Vg(t,e){return No(t,it(e,3),Ks)}function zg(t,e){return t==null?t:Hs(t,it(e,3),le)}function Yg(t,e){return t==null?t:fa(t,it(e,3),le)}function $g(t,e){return t&&Fe(t,it(e,3))}function Xg(t,e){return t&&Ks(t,it(e,3))}function Zg(t){return t==null?[]:Ur(t,zt(t))}function Jg(t){return t==null?[]:Ur(t,le(t))}function So(t,e,n){var o=t==null?s:_n(t,e);return o===s?n:o}function qg(t,e){return t!=null&&$a(t,e,Ef)}function wo(t,e){return t!=null&&$a(t,e,Cf)}var Qg=Wa(function(t,e,n){e!=null&&typeof e.toString!="function"&&(e=vr.call(e)),t[e]=n},To(ue)),jg=Wa(function(t,e,n){e!=null&&typeof e.toString!="function"&&(e=vr.call(e)),Tt.call(t,e)?t[e].push(n):t[e]=[n]},it),tp=pt(Ti);function zt(t){return ae(t)?ia(t):$s(t)}function le(t){return ae(t)?ia(t,!0):Uf(t)}function ep(t,e){var n={};return e=it(e,3),Fe(t,function(o,E,P){Je(n,e(o,E,P),o)}),n}function np(t,e){var n={};return e=it(e,3),Fe(t,function(o,E,P){Je(n,E,e(o,E,P))}),n}var ip=qn(function(t,e,n){Rr(t,e,n)}),_l=qn(function(t,e,n,o){Rr(t,e,n,o)}),rp=Qe(function(t,e){var n={};if(t==null)return n;var o=!1;e=Rt(e,function(P){return P=vn(P,t),o||(o=P.length>1),P}),We(t,ao(t),n),o&&(n=Te(n,x|v|r,Qf));for(var E=e.length;E--;)js(n,e[E]);return n});function sp(t,e){return Bl(t,$r(it(e)))}var op=Qe(function(t,e){return t==null?{}:Of(t,e)});function Bl(t,e){if(t==null)return{};var n=Rt(ao(t),function(o){return[o]});return e=it(e),Ea(t,n,function(o,E){return e(o,E[0])})}function ap(t,e,n){e=vn(e,t);var o=-1,E=e.length;for(E||(E=1,t=s);++o<E;){var P=t==null?s:t[Ne(e[o])];P===s&&(o=E,P=n),t=tn(P)?P.call(t):P}return t}function lp(t,e,n){return t==null?t:Mi(t,e,n)}function up(t,e,n,o){return o=typeof o=="function"?o:s,t==null?t:Mi(t,e,n,o)}var Al=Ha(zt),Ul=Ha(le);function fp(t,e,n){var o=ct(t),E=o||En(t)||ti(t);if(e=it(e,4),n==null){var P=t&&t.constructor;E?n=o?new P:[]:Ot(t)?n=tn(P)?Jn(Cr(t)):{}:n={}}return(E?Se:Fe)(t,function(O,k,N){return e(n,O,k,N)}),n}function cp(t,e){return t==null?!0:js(t,e)}function hp(t,e,n){return t==null?t:Ta(t,e,no(n))}function gp(t,e,n,o){return o=typeof o=="function"?o:s,t==null?t:Ta(t,e,no(n),o)}function ei(t){return t==null?[]:Is(t,zt(t))}function pp(t){return t==null?[]:Is(t,le(t))}function mp(t,e,n){return n===s&&(n=e,e=s),n!==s&&(n=_e(n),n=n===n?n:0),e!==s&&(e=_e(e),e=e===e?e:0),Mn(_e(t),e,n)}function dp(t,e,n){return e=en(e),n===s?(n=e,e=0):n=en(n),t=_e(t),Sf(t,e,n)}function yp(t,e,n){if(n&&typeof n!="boolean"&&ne(t,e,n)&&(e=n=s),n===s&&(typeof e=="boolean"?(n=e,e=s):typeof t=="boolean"&&(n=t,t=s)),t===s&&e===s?(t=0,e=1):(t=en(t),e===s?(e=t,t=0):e=en(e)),t>e){var o=t;t=e,e=o}if(n||t%1||e%1){var E=ea();return Qt(t+E*(e-t+tt("1e-"+((E+"").length-1))),e)}return Js(t,e)}var vp=Qn(function(t,e,n){return e=e.toLowerCase(),t+(n?Rl(e):e)});function Rl(t){return bo(wt(t).toLowerCase())}function Ol(t){return t=wt(t),t&&t.replace(ai,au).replace(ze,"")}function xp(t,e,n){t=wt(t),e=ye(e);var o=t.length;n=n===s?o:Mn(ht(n),0,o);var E=n;return n-=e.length,n>=0&&t.slice(n,E)==e}function Ep(t){return t=wt(t),t&&ts.test(t)?t.replace(Gi,lu):t}function Cp(t){return t=wt(t),t&&ss.test(t)?t.replace(si,"\\$&"):t}var Sp=Qn(function(t,e,n){return t+(n?"-":"")+e.toLowerCase()}),wp=Qn(function(t,e,n){return t+(n?" ":"")+e.toLowerCase()}),bp=ka("toLowerCase");function Tp(t,e,n){t=wt(t),e=ht(e);var o=e?zn(t):0;if(!e||o>=e)return t;var E=(e-o)/2;return Fr(Tr(E),n)+t+Fr(br(E),n)}function Pp(t,e,n){t=wt(t),e=ht(e);var o=e?zn(t):0;return e&&o<e?t+Fr(e-o,n):t}function Mp(t,e,n){t=wt(t),e=ht(e);var o=e?zn(t):0;return e&&o<e?Fr(e-o,n)+t:t}function _p(t,e,n){return n||e==null?e=0:e&&(e=+e),Iu(wt(t).replace(oi,""),e||0)}function Bp(t,e,n){return(n?ne(t,e,n):e===s)?e=1:e=ht(e),qs(wt(t),e)}function Ap(){var t=arguments,e=wt(t[0]);return t.length<3?e:e.replace(t[1],t[2])}var Up=Qn(function(t,e,n){return t+(n?"_":"")+e.toLowerCase()});function Rp(t,e,n){return n&&typeof n!="number"&&ne(t,e,n)&&(e=n=s),n=n===s?Ct:n>>>0,n?(t=wt(t),t&&(typeof e=="string"||e!=null&&!Co(e))&&(e=ye(e),!e&&Vn(t))?xn(Ie(t),0,n):t.split(e,n)):[]}var Op=Qn(function(t,e,n){return t+(n?" ":"")+bo(e)});function Ip(t,e,n){return t=wt(t),n=n==null?0:Mn(ht(n),0,t.length),e=ye(e),t.slice(n,n+e.length)==e}function Lp(t,e,n){var o=b.templateSettings;n&&ne(t,e,n)&&(e=s),t=wt(t),e=Jr({},e,o,Ka);var E=Jr({},e.imports,o.imports,Ka),P=zt(E),O=Is(E,P),k,N,z=0,Y=e.interpolate||kn,$="__p += '",q=ks((e.escape||kn).source+"|"+Y.source+"|"+(Y===Hi?un:kn).source+"|"+(e.evaluate||kn).source+"|$","g"),nt="//# sourceURL="+(Tt.call(e,"sourceURL")?(e.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Ts+"]")+`
`;t.replace(q,function(st,mt,xt,xe,ie,Ee){return xt||(xt=xe),$+=t.slice(z,Ee).replace(Dn,uu),mt&&(k=!0,$+=`' +
__e(`+mt+`) +
'`),ie&&(N=!0,$+=`';
`+ie+`;
__p += '`),xt&&($+=`' +
((__t = (`+xt+`)) == null ? '' : __t) +
'`),z=Ee+st.length,st}),$+=`';
`;var rt=Tt.call(e,"variable")&&e.variable;if(!rt)$=`with (obj) {
`+$+`
}
`;else if(fs.test(rt))throw new lt(l);$=(N?$.replace(Wi,""):$).replace(jr,"$1").replace(Ni,"$1;"),$="function("+(rt||"obj")+`) {
`+(rt?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(k?", __e = _.escape":"")+(N?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+$+`return __p
}`;var gt=Ll(function(){return Et(P,nt+"return "+$).apply(s,O)});if(gt.source=$,Eo(gt))throw gt;return gt}function kp(t){return wt(t).toLowerCase()}function Dp(t){return wt(t).toUpperCase()}function Fp(t,e,n){if(t=wt(t),t&&(n||e===s))return Vo(t);if(!t||!(e=ye(e)))return t;var o=Ie(t),E=Ie(e),P=zo(o,E),O=Yo(o,E)+1;return xn(o,P,O).join("")}function Wp(t,e,n){if(t=wt(t),t&&(n||e===s))return t.slice(0,Xo(t)+1);if(!t||!(e=ye(e)))return t;var o=Ie(t),E=Yo(o,Ie(e))+1;return xn(o,0,E).join("")}function Np(t,e,n){if(t=wt(t),t&&(n||e===s))return t.replace(oi,"");if(!t||!(e=ye(e)))return t;var o=Ie(t),E=zo(o,Ie(e));return xn(o,E).join("")}function Gp(t,e){var n=A,o=L;if(Ot(e)){var E="separator"in e?e.separator:E;n="length"in e?ht(e.length):n,o="omission"in e?ye(e.omission):o}t=wt(t);var P=t.length;if(Vn(t)){var O=Ie(t);P=O.length}if(n>=P)return t;var k=n-zn(o);if(k<1)return o;var N=O?xn(O,0,k).join(""):t.slice(0,k);if(E===s)return N+o;if(O&&(k+=N.length-k),Co(E)){if(t.slice(k).search(E)){var z,Y=N;for(E.global||(E=ks(E.source,wt(Ki.exec(E))+"g")),E.lastIndex=0;z=E.exec(Y);)var $=z.index;N=N.slice(0,$===s?k:$)}}else if(t.indexOf(ye(E),k)!=k){var q=N.lastIndexOf(E);q>-1&&(N=N.slice(0,q))}return N+o}function Hp(t){return t=wt(t),t&&Ve.test(t)?t.replace(an,du):t}var Kp=Qn(function(t,e,n){return t+(n?" ":"")+e.toUpperCase()}),bo=ka("toUpperCase");function Il(t,e,n){return t=wt(t),e=n?s:e,e===s?cu(t)?xu(t):nu(t):t.match(e)||[]}var Ll=pt(function(t,e){try{return me(t,s,e)}catch(n){return Eo(n)?n:new lt(n)}}),Vp=Qe(function(t,e){return Se(e,function(n){n=Ne(n),Je(t,n,vo(t[n],t))}),t});function zp(t){var e=t==null?0:t.length,n=it();return t=e?Rt(t,function(o){if(typeof o[1]!="function")throw new we(u);return[n(o[0]),o[1]]}):[],pt(function(o){for(var E=-1;++E<e;){var P=t[E];if(me(P[0],this,o))return me(P[1],this,o)}})}function Yp(t){return yf(Te(t,x))}function To(t){return function(){return t}}function $p(t,e){return t==null||t!==t?e:t}var Xp=Fa(),Zp=Fa(!0);function ue(t){return t}function Po(t){return pa(typeof t=="function"?t:Te(t,x))}function Jp(t){return da(Te(t,x))}function qp(t,e){return ya(t,Te(e,x))}var Qp=pt(function(t,e){return function(n){return Ti(n,t,e)}}),jp=pt(function(t,e){return function(n){return Ti(t,n,e)}});function Mo(t,e,n){var o=zt(e),E=Ur(e,o);n==null&&!(Ot(e)&&(E.length||!o.length))&&(n=e,e=t,t=this,E=Ur(e,zt(e)));var P=!(Ot(n)&&"chain"in n)||!!n.chain,O=tn(t);return Se(E,function(k){var N=e[k];t[k]=N,O&&(t.prototype[k]=function(){var z=this.__chain__;if(P||z){var Y=t(this.__wrapped__),$=Y.__actions__=oe(this.__actions__);return $.push({func:N,args:arguments,thisArg:t}),Y.__chain__=z,Y}return N.apply(t,gn([this.value()],arguments))})}),t}function tm(){return ot._===this&&(ot._=Tu),this}function _o(){}function em(t){return t=ht(t),pt(function(e){return va(e,t)})}var nm=ro(Rt),im=ro(Wo),rm=ro(Bs);function kl(t){return co(t)?As(Ne(t)):If(t)}function sm(t){return function(e){return t==null?s:_n(t,e)}}var om=Na(),am=Na(!0);function Bo(){return[]}function Ao(){return!1}function lm(){return{}}function um(){return""}function fm(){return!0}function cm(t,e){if(t=ht(t),t<1||t>at)return[];var n=Ct,o=Qt(t,Ct);e=it(e),t-=Ct;for(var E=Os(o,e);++n<t;)e(n);return E}function hm(t){return ct(t)?Rt(t,Ne):ve(t)?[t]:oe(nl(wt(t)))}function gm(t){var e=++wu;return wt(t)+e}var pm=Dr(function(t,e){return t+e},0),mm=so("ceil"),dm=Dr(function(t,e){return t/e},1),ym=so("floor");function vm(t){return t&&t.length?Ar(t,ue,Vs):s}function xm(t,e){return t&&t.length?Ar(t,it(e,2),Vs):s}function Em(t){return Ho(t,ue)}function Cm(t,e){return Ho(t,it(e,2))}function Sm(t){return t&&t.length?Ar(t,ue,Xs):s}function wm(t,e){return t&&t.length?Ar(t,it(e,2),Xs):s}var bm=Dr(function(t,e){return t*e},1),Tm=so("round"),Pm=Dr(function(t,e){return t-e},0);function Mm(t){return t&&t.length?Rs(t,ue):0}function _m(t,e){return t&&t.length?Rs(t,it(e,2)):0}return b.after=Jh,b.ary=gl,b.assign=Dg,b.assignIn=Ml,b.assignInWith=Jr,b.assignWith=Fg,b.at=Wg,b.before=pl,b.bind=vo,b.bindAll=Vp,b.bindKey=ml,b.castArray=lg,b.chain=fl,b.chunk=yc,b.compact=vc,b.concat=xc,b.cond=zp,b.conforms=Yp,b.constant=To,b.countBy=Mh,b.create=Ng,b.curry=dl,b.curryRight=yl,b.debounce=vl,b.defaults=Gg,b.defaultsDeep=Hg,b.defer=qh,b.delay=Qh,b.difference=Ec,b.differenceBy=Cc,b.differenceWith=Sc,b.drop=wc,b.dropRight=bc,b.dropRightWhile=Tc,b.dropWhile=Pc,b.fill=Mc,b.filter=Bh,b.flatMap=Rh,b.flatMapDeep=Oh,b.flatMapDepth=Ih,b.flatten=ol,b.flattenDeep=_c,b.flattenDepth=Bc,b.flip=jh,b.flow=Xp,b.flowRight=Zp,b.fromPairs=Ac,b.functions=Zg,b.functionsIn=Jg,b.groupBy=Lh,b.initial=Rc,b.intersection=Oc,b.intersectionBy=Ic,b.intersectionWith=Lc,b.invert=Qg,b.invertBy=jg,b.invokeMap=Dh,b.iteratee=Po,b.keyBy=Fh,b.keys=zt,b.keysIn=le,b.map=Vr,b.mapKeys=ep,b.mapValues=np,b.matches=Jp,b.matchesProperty=qp,b.memoize=Yr,b.merge=ip,b.mergeWith=_l,b.method=Qp,b.methodOf=jp,b.mixin=Mo,b.negate=$r,b.nthArg=em,b.omit=rp,b.omitBy=sp,b.once=tg,b.orderBy=Wh,b.over=nm,b.overArgs=eg,b.overEvery=im,b.overSome=rm,b.partial=xo,b.partialRight=xl,b.partition=Nh,b.pick=op,b.pickBy=Bl,b.property=kl,b.propertyOf=sm,b.pull=Wc,b.pullAll=ll,b.pullAllBy=Nc,b.pullAllWith=Gc,b.pullAt=Hc,b.range=om,b.rangeRight=am,b.rearg=ng,b.reject=Kh,b.remove=Kc,b.rest=ig,b.reverse=mo,b.sampleSize=zh,b.set=lp,b.setWith=up,b.shuffle=Yh,b.slice=Vc,b.sortBy=Zh,b.sortedUniq=qc,b.sortedUniqBy=Qc,b.split=Rp,b.spread=rg,b.tail=jc,b.take=th,b.takeRight=eh,b.takeRightWhile=nh,b.takeWhile=ih,b.tap=vh,b.throttle=sg,b.thru=Kr,b.toArray=bl,b.toPairs=Al,b.toPairsIn=Ul,b.toPath=hm,b.toPlainObject=Pl,b.transform=fp,b.unary=og,b.union=rh,b.unionBy=sh,b.unionWith=oh,b.uniq=ah,b.uniqBy=lh,b.uniqWith=uh,b.unset=cp,b.unzip=yo,b.unzipWith=ul,b.update=hp,b.updateWith=gp,b.values=ei,b.valuesIn=pp,b.without=fh,b.words=Il,b.wrap=ag,b.xor=ch,b.xorBy=hh,b.xorWith=gh,b.zip=ph,b.zipObject=mh,b.zipObjectDeep=dh,b.zipWith=yh,b.entries=Al,b.entriesIn=Ul,b.extend=Ml,b.extendWith=Jr,Mo(b,b),b.add=pm,b.attempt=Ll,b.camelCase=vp,b.capitalize=Rl,b.ceil=mm,b.clamp=mp,b.clone=ug,b.cloneDeep=cg,b.cloneDeepWith=hg,b.cloneWith=fg,b.conformsTo=gg,b.deburr=Ol,b.defaultTo=$p,b.divide=dm,b.endsWith=xp,b.eq=ke,b.escape=Ep,b.escapeRegExp=Cp,b.every=_h,b.find=Ah,b.findIndex=rl,b.findKey=Kg,b.findLast=Uh,b.findLastIndex=sl,b.findLastKey=Vg,b.floor=ym,b.forEach=cl,b.forEachRight=hl,b.forIn=zg,b.forInRight=Yg,b.forOwn=$g,b.forOwnRight=Xg,b.get=So,b.gt=pg,b.gte=mg,b.has=qg,b.hasIn=wo,b.head=al,b.identity=ue,b.includes=kh,b.indexOf=Uc,b.inRange=dp,b.invoke=tp,b.isArguments=Un,b.isArray=ct,b.isArrayBuffer=dg,b.isArrayLike=ae,b.isArrayLikeObject=Dt,b.isBoolean=yg,b.isBuffer=En,b.isDate=vg,b.isElement=xg,b.isEmpty=Eg,b.isEqual=Cg,b.isEqualWith=Sg,b.isError=Eo,b.isFinite=wg,b.isFunction=tn,b.isInteger=El,b.isLength=Xr,b.isMap=Cl,b.isMatch=bg,b.isMatchWith=Tg,b.isNaN=Pg,b.isNative=Mg,b.isNil=Bg,b.isNull=_g,b.isNumber=Sl,b.isObject=Ot,b.isObjectLike=Lt,b.isPlainObject=Ui,b.isRegExp=Co,b.isSafeInteger=Ag,b.isSet=wl,b.isString=Zr,b.isSymbol=ve,b.isTypedArray=ti,b.isUndefined=Ug,b.isWeakMap=Rg,b.isWeakSet=Og,b.join=kc,b.kebabCase=Sp,b.last=Me,b.lastIndexOf=Dc,b.lowerCase=wp,b.lowerFirst=bp,b.lt=Ig,b.lte=Lg,b.max=vm,b.maxBy=xm,b.mean=Em,b.meanBy=Cm,b.min=Sm,b.minBy=wm,b.stubArray=Bo,b.stubFalse=Ao,b.stubObject=lm,b.stubString=um,b.stubTrue=fm,b.multiply=bm,b.nth=Fc,b.noConflict=tm,b.noop=_o,b.now=zr,b.pad=Tp,b.padEnd=Pp,b.padStart=Mp,b.parseInt=_p,b.random=yp,b.reduce=Gh,b.reduceRight=Hh,b.repeat=Bp,b.replace=Ap,b.result=ap,b.round=Tm,b.runInContext=W,b.sample=Vh,b.size=$h,b.snakeCase=Up,b.some=Xh,b.sortedIndex=zc,b.sortedIndexBy=Yc,b.sortedIndexOf=$c,b.sortedLastIndex=Xc,b.sortedLastIndexBy=Zc,b.sortedLastIndexOf=Jc,b.startCase=Op,b.startsWith=Ip,b.subtract=Pm,b.sum=Mm,b.sumBy=_m,b.template=Lp,b.times=cm,b.toFinite=en,b.toInteger=ht,b.toLength=Tl,b.toLower=kp,b.toNumber=_e,b.toSafeInteger=kg,b.toString=wt,b.toUpper=Dp,b.trim=Fp,b.trimEnd=Wp,b.trimStart=Np,b.truncate=Gp,b.unescape=Hp,b.uniqueId=gm,b.upperCase=Kp,b.upperFirst=bo,b.each=cl,b.eachRight=hl,b.first=al,Mo(b,function(){var t={};return Fe(b,function(e,n){Tt.call(b.prototype,n)||(t[n]=e)}),t}(),{chain:!1}),b.VERSION=C,Se(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){b[t].placeholder=b}),Se(["drop","take"],function(t,e){yt.prototype[t]=function(n){n=n===s?1:Kt(ht(n),0);var o=this.__filtered__&&!e?new yt(this):this.clone();return o.__filtered__?o.__takeCount__=Qt(n,o.__takeCount__):o.__views__.push({size:Qt(n,Ct),type:t+(o.__dir__<0?"Right":"")}),o},yt.prototype[t+"Right"]=function(n){return this.reverse()[t](n).reverse()}}),Se(["filter","map","takeWhile"],function(t,e){var n=e+1,o=n==X||n==et;yt.prototype[t]=function(E){var P=this.clone();return P.__iteratees__.push({iteratee:it(E,3),type:n}),P.__filtered__=P.__filtered__||o,P}}),Se(["head","last"],function(t,e){var n="take"+(e?"Right":"");yt.prototype[t]=function(){return this[n](1).value()[0]}}),Se(["initial","tail"],function(t,e){var n="drop"+(e?"":"Right");yt.prototype[t]=function(){return this.__filtered__?new yt(this):this[n](1)}}),yt.prototype.compact=function(){return this.filter(ue)},yt.prototype.find=function(t){return this.filter(t).head()},yt.prototype.findLast=function(t){return this.reverse().find(t)},yt.prototype.invokeMap=pt(function(t,e){return typeof t=="function"?new yt(this):this.map(function(n){return Ti(n,t,e)})}),yt.prototype.reject=function(t){return this.filter($r(it(t)))},yt.prototype.slice=function(t,e){t=ht(t);var n=this;return n.__filtered__&&(t>0||e<0)?new yt(n):(t<0?n=n.takeRight(-t):t&&(n=n.drop(t)),e!==s&&(e=ht(e),n=e<0?n.dropRight(-e):n.take(e-t)),n)},yt.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},yt.prototype.toArray=function(){return this.take(Ct)},Fe(yt.prototype,function(t,e){var n=/^(?:filter|find|map|reject)|While$/.test(e),o=/^(?:head|last)$/.test(e),E=b[o?"take"+(e=="last"?"Right":""):e],P=o||/^find/.test(e);E&&(b.prototype[e]=function(){var O=this.__wrapped__,k=o?[1]:arguments,N=O instanceof yt,z=k[0],Y=N||ct(O),$=function(mt){var xt=E.apply(b,gn([mt],k));return o&&q?xt[0]:xt};Y&&n&&typeof z=="function"&&z.length!=1&&(N=Y=!1);var q=this.__chain__,nt=!!this.__actions__.length,rt=P&&!q,gt=N&&!nt;if(!P&&Y){O=gt?O:new yt(this);var st=t.apply(O,k);return st.__actions__.push({func:Kr,args:[$],thisArg:s}),new be(st,q)}return rt&&gt?t.apply(this,k):(st=this.thru($),rt?o?st.value()[0]:st.value():st)})}),Se(["pop","push","shift","sort","splice","unshift"],function(t){var e=mr[t],n=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",o=/^(?:pop|shift)$/.test(t);b.prototype[t]=function(){var E=arguments;if(o&&!this.__chain__){var P=this.value();return e.apply(ct(P)?P:[],E)}return this[n](function(O){return e.apply(ct(O)?O:[],E)})}}),Fe(yt.prototype,function(t,e){var n=b[e];if(n){var o=n.name+"";Tt.call(Zn,o)||(Zn[o]=[]),Zn[o].push({name:e,func:n})}}),Zn[kr(s,S).name]=[{name:"wrapper",func:s}],yt.prototype.clone=Gu,yt.prototype.reverse=Hu,yt.prototype.value=Ku,b.prototype.at=xh,b.prototype.chain=Eh,b.prototype.commit=Ch,b.prototype.next=Sh,b.prototype.plant=bh,b.prototype.reverse=Th,b.prototype.toJSON=b.prototype.valueOf=b.prototype.value=Ph,b.prototype.first=b.prototype.head,vi&&(b.prototype[vi]=wh),b},Yn=Eu();Gt?((Gt.exports=Yn)._=Yn,Mt._=Yn):ot._=Yn}).call(Rm)}(Di,Di.exports)),Di.exports}var qr={exports:{}},Wl;function Oo(){if(Wl)return qr.exports;Wl=1;var J=typeof Reflect=="object"?Reflect:null,g=J&&typeof J.apply=="function"?J.apply:function(y,w,M){return Function.prototype.apply.call(y,w,M)},s;J&&typeof J.ownKeys=="function"?s=J.ownKeys:Object.getOwnPropertySymbols?s=function(y){return Object.getOwnPropertyNames(y).concat(Object.getOwnPropertySymbols(y))}:s=function(y){return Object.getOwnPropertyNames(y)};function C(_){console&&console.warn&&console.warn(_)}var p=Number.isNaN||function(y){return y!==y};function i(){i.init.call(this)}qr.exports=i,qr.exports.once=S,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var u=10;function l(_){if(typeof _!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof _)}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(_){if(typeof _!="number"||_<0||p(_))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+_+".");u=_}}),i.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(y){if(typeof y!="number"||y<0||p(y))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+y+".");return this._maxListeners=y,this};function a(_){return _._maxListeners===void 0?i.defaultMaxListeners:_._maxListeners}i.prototype.getMaxListeners=function(){return a(this)},i.prototype.emit=function(y){for(var w=[],M=1;M<arguments.length;M++)w.push(arguments[M]);var T=y==="error",I=this._events;if(I!==void 0)T=T&&I.error===void 0;else if(!T)return!1;if(T){var A;if(w.length>0&&(A=w[0]),A instanceof Error)throw A;var L=new Error("Unhandled error."+(A?" ("+A.message+")":""));throw L.context=A,L}var D=I[y];if(D===void 0)return!1;if(typeof D=="function")g(D,this,w);else for(var K=D.length,X=h(D,K),M=0;M<K;++M)g(X[M],this,w);return!0};function m(_,y,w,M){var T,I,A;if(l(w),I=_._events,I===void 0?(I=_._events=Object.create(null),_._eventsCount=0):(I.newListener!==void 0&&(_.emit("newListener",y,w.listener?w.listener:w),I=_._events),A=I[y]),A===void 0)A=I[y]=w,++_._eventsCount;else if(typeof A=="function"?A=I[y]=M?[w,A]:[A,w]:M?A.unshift(w):A.push(w),T=a(_),T>0&&A.length>T&&!A.warned){A.warned=!0;var L=new Error("Possible EventEmitter memory leak detected. "+A.length+" "+String(y)+" listeners added. Use emitter.setMaxListeners() to increase limit");L.name="MaxListenersExceededWarning",L.emitter=_,L.type=y,L.count=A.length,C(L)}return _}i.prototype.addListener=function(y,w){return m(this,y,w,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(y,w){return m(this,y,w,!0)};function f(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function x(_,y,w){var M={fired:!1,wrapFn:void 0,target:_,type:y,listener:w},T=f.bind(M);return T.listener=w,M.wrapFn=T,T}i.prototype.once=function(y,w){return l(w),this.on(y,x(this,y,w)),this},i.prototype.prependOnceListener=function(y,w){return l(w),this.prependListener(y,x(this,y,w)),this},i.prototype.removeListener=function(y,w){var M,T,I,A,L;if(l(w),T=this._events,T===void 0)return this;if(M=T[y],M===void 0)return this;if(M===w||M.listener===w)--this._eventsCount===0?this._events=Object.create(null):(delete T[y],T.removeListener&&this.emit("removeListener",y,M.listener||w));else if(typeof M!="function"){for(I=-1,A=M.length-1;A>=0;A--)if(M[A]===w||M[A].listener===w){L=M[A].listener,I=A;break}if(I<0)return this;I===0?M.shift():c(M,I),M.length===1&&(T[y]=M[0]),T.removeListener!==void 0&&this.emit("removeListener",y,L||w)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(y){var w,M,T;if(M=this._events,M===void 0)return this;if(M.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):M[y]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete M[y]),this;if(arguments.length===0){var I=Object.keys(M),A;for(T=0;T<I.length;++T)A=I[T],A!=="removeListener"&&this.removeAllListeners(A);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(w=M[y],typeof w=="function")this.removeListener(y,w);else if(w!==void 0)for(T=w.length-1;T>=0;T--)this.removeListener(y,w[T]);return this};function v(_,y,w){var M=_._events;if(M===void 0)return[];var T=M[y];return T===void 0?[]:typeof T=="function"?w?[T.listener||T]:[T]:w?d(T):h(T,T.length)}i.prototype.listeners=function(y){return v(this,y,!0)},i.prototype.rawListeners=function(y){return v(this,y,!1)},i.listenerCount=function(_,y){return typeof _.listenerCount=="function"?_.listenerCount(y):r.call(_,y)},i.prototype.listenerCount=r;function r(_){var y=this._events;if(y!==void 0){var w=y[_];if(typeof w=="function")return 1;if(w!==void 0)return w.length}return 0}i.prototype.eventNames=function(){return this._eventsCount>0?s(this._events):[]};function h(_,y){for(var w=new Array(y),M=0;M<y;++M)w[M]=_[M];return w}function c(_,y){for(;y+1<_.length;y++)_[y]=_[y+1];_.pop()}function d(_){for(var y=new Array(_.length),w=0;w<y.length;++w)y[w]=_[w].listener||_[w];return y}function S(_,y){return new Promise(function(w,M){function T(A){_.removeListener(y,I),M(A)}function I(){typeof _.removeListener=="function"&&_.removeListener("error",T),w([].slice.call(arguments))}U(_,y,I,{once:!0}),y!=="error"&&B(_,T,{once:!0})})}function B(_,y,w){typeof _.on=="function"&&U(_,"error",y,w)}function U(_,y,w,M){if(typeof _.on=="function")M.once?_.once(y,w):_.on(y,w);else if(typeof _.addEventListener=="function")_.addEventListener(y,function T(I){M.once&&_.removeEventListener(y,T),w(I)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof _)}return qr.exports}var Oi={},Nl;function Om(){if(Nl)return Oi;Nl=1,Object.defineProperty(Oi,"__esModule",{value:!0}),Oi.default=void 0;var J=s(Ro()),g=s(Oo());function s(h){return h&&h.__esModule?h:{default:h}}function C(h){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?C=function(d){return typeof d}:C=function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d},C(h)}function p(h,c){if(!(h instanceof c))throw new TypeError("Cannot call a class as a function")}function i(h,c){for(var d=0;d<c.length;d++){var S=c[d];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(h,S.key,S)}}function u(h,c,d){return c&&i(h.prototype,c),h}function l(h,c){return c&&(C(c)==="object"||typeof c=="function")?c:a(h)}function a(h){if(h===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return h}function m(h){return m=Object.setPrototypeOf?Object.getPrototypeOf:function(d){return d.__proto__||Object.getPrototypeOf(d)},m(h)}function f(h,c){if(typeof c!="function"&&c!==null)throw new TypeError("Super expression must either be null or a function");h.prototype=Object.create(c&&c.prototype,{constructor:{value:h,writable:!0,configurable:!0}}),c&&x(h,c)}function x(h,c){return x=Object.setPrototypeOf||function(S,B){return S.__proto__=B,S},x(h,c)}var v=function(h){f(c,h);function c(d){var S;if(p(this,c),S=l(this,m(c).call(this)),typeof d!="string")throw new Error("name must be a string");return S.name=d,S.components={},S}return u(c,[{key:"getName",value:function(){return J.default.clone(this.name)}},{key:"hasComponent",value:function(S){if(typeof S!="string")throw new Error("componentName must be a string");return this.components[S]!==void 0}},{key:"setComponent",value:function(S,B){if(typeof S!="string")throw new Error("componentName must be a string");var U=!1;this.components[S]===void 0&&(U=!0),this.components[S]=B,U&&this.emit("component:add",U)}},{key:"getComponent",value:function(S){if(typeof S!="string")throw new Error("componentName must be a string");return this.components[S]}},{key:"deleteComponent",value:function(S){if(typeof S!="string")throw new Error("componentName must be a string");this.hasComponent(S)&&(delete this.components[S],this.emit("component:remove",S))}},{key:"destroy",value:function(){this.emit("entity:remove",this.name)}}]),c}(g.default),r=v;return Oi.default=r,Oi}var Ii={},Gl;function Im(){if(Gl)return Ii;Gl=1,Object.defineProperty(Ii,"__esModule",{value:!0}),Ii.default=void 0;var J=s(Ro()),g=s(Oo());function s(h){return h&&h.__esModule?h:{default:h}}function C(h){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?C=function(d){return typeof d}:C=function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d},C(h)}function p(h,c){if(!(h instanceof c))throw new TypeError("Cannot call a class as a function")}function i(h,c){for(var d=0;d<c.length;d++){var S=c[d];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(h,S.key,S)}}function u(h,c,d){return c&&i(h.prototype,c),h}function l(h,c){return c&&(C(c)==="object"||typeof c=="function")?c:a(h)}function a(h){if(h===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return h}function m(h){return m=Object.setPrototypeOf?Object.getPrototypeOf:function(d){return d.__proto__||Object.getPrototypeOf(d)},m(h)}function f(h,c){if(typeof c!="function"&&c!==null)throw new TypeError("Super expression must either be null or a function");h.prototype=Object.create(c&&c.prototype,{constructor:{value:h,writable:!0,configurable:!0}}),c&&x(h,c)}function x(h,c){return x=Object.setPrototypeOf||function(S,B){return S.__proto__=B,S},x(h,c)}var v=function(h){f(c,h);function c(d,S,B){var U;if(p(this,c),U=l(this,m(c).call(this)),typeof d!="string")throw new Error("name must be a string");if(!(J.default.isArrayLike(S)&&J.default.every(S,J.default.isString)))throw new Error("components must be a string array");if(typeof B!="function")throw new Error("handler must be a function");return U.name=d,U.components=S,U.handler=B,U}return u(c,[{key:"isCompatibleEntity",value:function(S){return J.default.every(this.components,function(B){return S.hasComponent(B)})}},{key:"getName",value:function(){return J.default.clone(this.name)}},{key:"destroy",value:function(){this.emit("system:remove",this.name)}}]),c}(g.default),r=v;return Ii.default=r,Ii}var Hl;function Io(){if(Hl)return Ri;Hl=1,Object.defineProperty(Ri,"__esModule",{value:!0}),Ri.default=void 0;var J=p(Ro()),g=p(Oo()),s=p(Om()),C=p(Im());function p(d){return d&&d.__esModule?d:{default:d}}function i(d){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?i=function(B){return typeof B}:i=function(B){return B&&typeof Symbol=="function"&&B.constructor===Symbol&&B!==Symbol.prototype?"symbol":typeof B},i(d)}function u(d,S){if(!(d instanceof S))throw new TypeError("Cannot call a class as a function")}function l(d,S){for(var B=0;B<S.length;B++){var U=S[B];U.enumerable=U.enumerable||!1,U.configurable=!0,"value"in U&&(U.writable=!0),Object.defineProperty(d,U.key,U)}}function a(d,S,B){return S&&l(d.prototype,S),d}function m(d,S){return S&&(i(S)==="object"||typeof S=="function")?S:f(d)}function f(d){if(d===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return d}function x(d){return x=Object.setPrototypeOf?Object.getPrototypeOf:function(B){return B.__proto__||Object.getPrototypeOf(B)},x(d)}function v(d,S){if(typeof S!="function"&&S!==null)throw new TypeError("Super expression must either be null or a function");d.prototype=Object.create(S&&S.prototype,{constructor:{value:d,writable:!0,configurable:!0}}),S&&r(d,S)}function r(d,S){return r=Object.setPrototypeOf||function(U,_){return U.__proto__=_,U},r(d,S)}var h=function(d){v(S,d);function S(){var B;return u(this,S),B=m(this,x(S).call(this)),B.entities={},B.systems=[],B.systemVsEntities={},B}return a(S,[{key:"entity",value:function(U){var _=this;if(typeof U!="string")throw new Error("name must be a string");if(this.entities[U]!==void 0)throw new Error("Entity ".concat(U," already exists"));var y=new s.default(U);return y.on("component:add",function(){return _.updateSystemsVsEntities()}),y.on("component:delete",function(){return _.updateSystemsVsEntities()}),y.on("entity:remove",function(w){return _.removeEntity(w)}),this.entities[U]=y,y}},{key:"getEntity",value:function(U){if(typeof U!="string")throw new Error("name must be a string");return this.entities[U]}},{key:"removeEntity",value:function(U){delete this.entities[U],this.updateSystemsVsEntities()}},{key:"system",value:function(U,_,y){var w=this;if(typeof U!="string")throw new Error("name must be a string");if(!(J.default.isArrayLike(_)&&J.default.every(_,J.default.isString)))throw new Error("components must be a string array");if(typeof y!="function")throw new Error("handler must be a function");if(J.default.some(this.systems,function(T){return T.name===U}))throw new Error("System ".concat(U," already exists"));var M=new C.default(U,_,y);return M.on("system:remove",function(T){return w.removeSystem(T)}),this.systems.push(M),this.updateSystemsVsEntities(),M}},{key:"getSystem",value:function(U){if(typeof U!="string")throw new Error("name must be a string");return J.default.find(this.systems,function(_){return _.name===U})}},{key:"removeSystem",value:function(U){if(typeof U!="string")throw new Error("name must be a string");this.systems=J.default.filter(this.systems,function(_){return _.name!==U}),this.updateSystemsVsEntities()}},{key:"updateSystemsVsEntities",value:function(){var U=this;J.default.forEach(this.systems,function(_){var y=_.name,w=[];U.systemVsEntities[y]=w,J.default.forEach(U.entities,function(M){_.isCompatibleEntity(M)&&w.push(M)})})}},{key:"tick",value:function(){var U=this;this.emit("tick:before",this),J.default.forEach(this.systems,function(_){J.default.forEach(U.systemVsEntities[_.name],function(y){var w={};J.default.forEach(_.components,function(M){w[M]=y.components[M]}),_.handler(y,w)})}),this.emit("tick:after",this)}}]),S}(g.default),c=h;return Ri.default=c,Ri}var Li={},Kl;function Lm(){if(Kl)return Li;Kl=1,Object.defineProperty(Li,"__esModule",{value:!0}),Li.default=void 0;var J=g(Io());function g(a){return a&&a.__esModule?a:{default:a}}function s(a,m){if(!(a instanceof m))throw new TypeError("Cannot call a class as a function")}function C(a,m){for(var f=0;f<m.length;f++){var x=m[f];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(a,x.key,x)}}function p(a,m,f){return m&&C(a.prototype,m),a}function i(a){return"".concat(a,"-").concat(Math.floor(Math.random()*1e3))}var u=function(){function a(m){if(s(this,a),!(m instanceof J.default))throw new Error("engine must be a Engine instance");var f=i("clock"),x=i("time"),v=i("timer");this.time={},this.reset(),this.entity=m.entity(f),this.entity.setComponent(x,this.time),this.system=m.system(v,[x],function(r,h){var c=h[x],d=Date.now();c.ticks+=1,c.start===0&&(c.start=d),c.total=d-c.start,c.now>0&&(c.delta=d-c.now),c.now=d})}return p(a,[{key:"reset",value:function(){this.time.ticks=0,this.time.start=0,this.time.now=0,this.time.total=0,this.time.delta=0}},{key:"getTime",value:function(){return this.time}},{key:"getEntity",value:function(){return this.entity}},{key:"getSystem",value:function(){return this.system}}]),a}(),l=u;return Li.default=l,Li}var ki={},Vl;function km(){if(Vl)return ki;Vl=1,Object.defineProperty(ki,"__esModule",{value:!0}),ki.default=void 0;var J=g(Io());function g(l){return l&&l.__esModule?l:{default:l}}function s(l,a){if(!(l instanceof a))throw new TypeError("Cannot call a class as a function")}function C(l,a){for(var m=0;m<a.length;m++){var f=a[m];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(l,f.key,f)}}function p(l,a,m){return a&&C(l.prototype,a),l}var i=function(){function l(a){if(s(this,l),!(a instanceof J.default))throw new Error("engine must be a Engine instance");this.engine=a,this.time=0,this.setFps(0),this.stop()}return p(l,[{key:"setFps",value:function(m){if(typeof m!="number")throw new Error("fps must be a number");this.fps=0,m&&typeof m=="number"&&m>0&&(this.fps=parseInt(Math.round(m),10)),this.frameDuration=1e3/this.fps}},{key:"getFps",value:function(){return this.fps}},{key:"start",value:function(){this.started=!0,this.paused=!1,this.run()}},{key:"pause",value:function(){this.paused=!0}},{key:"stop",value:function(){this.prevFrameTime=null,this.started=!1,this.paused=!1}},{key:"isRunning",value:function(){return!!(this.started&&!this.paused)}},{key:"isPaused",value:function(){return!!(this.started&&this.paused)}},{key:"run",value:function(){var m=this,f=Date.now();this.engine.tick();var x=Date.now(),v=0;this.fps>0&&(v=Math.max(0,this.frameDuration-(x-f))),setTimeout(function(){m.isRunning()&&m.run()},v)}}]),l}(),u=i;return ki.default=u,ki}var zl;function Dm(){return zl||(zl=1,function(J){Object.defineProperty(J,"__esModule",{value:!0}),Object.defineProperty(J,"Engine",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(J,"Timer",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(J,"Simulator",{enumerable:!0,get:function(){return C.default}});var g=p(Io()),s=p(Lm()),C=p(km());function p(i){return i&&i.__esModule?i:{default:i}}}(Uo)),Uo}var Yl=Dm(),Qr={exports:{}};/*!
 * matter-js 0.20.0 by @liabru
 * http://brm.io/matter-js/
 * License MIT
 * 
 * The MIT License (MIT)
 * 
 * Copyright (c) Liam Brummitt and contributors.
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Fm=Qr.exports,$l;function Wm(){return $l||($l=1,function(J,g){(function(C,p){J.exports=p()})(Fm,function(){return function(s){var C={};function p(i){if(C[i])return C[i].exports;var u=C[i]={i,l:!1,exports:{}};return s[i].call(u.exports,u,u.exports,p),u.l=!0,u.exports}return p.m=s,p.c=C,p.d=function(i,u,l){p.o(i,u)||Object.defineProperty(i,u,{enumerable:!0,get:l})},p.r=function(i){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},p.t=function(i,u){if(u&1&&(i=p(i)),u&8||u&4&&typeof i=="object"&&i&&i.__esModule)return i;var l=Object.create(null);if(p.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:i}),u&2&&typeof i!="string")for(var a in i)p.d(l,a,(function(m){return i[m]}).bind(null,a));return l},p.n=function(i){var u=i&&i.__esModule?function(){return i.default}:function(){return i};return p.d(u,"a",u),u},p.o=function(i,u){return Object.prototype.hasOwnProperty.call(i,u)},p.p="",p(p.s=20)}([function(s,C){var p={};s.exports=p,function(){p._baseDelta=1e3/60,p._nextId=0,p._seed=0,p._nowStartTime=+new Date,p._warnedOnce={},p._decomp=null,p.extend=function(u,l){var a,m;typeof l=="boolean"?(a=2,m=l):(a=1,m=!0);for(var f=a;f<arguments.length;f++){var x=arguments[f];if(x)for(var v in x)m&&x[v]&&x[v].constructor===Object&&(!u[v]||u[v].constructor===Object)?(u[v]=u[v]||{},p.extend(u[v],m,x[v])):u[v]=x[v]}return u},p.clone=function(u,l){return p.extend({},l,u)},p.keys=function(u){if(Object.keys)return Object.keys(u);var l=[];for(var a in u)l.push(a);return l},p.values=function(u){var l=[];if(Object.keys){for(var a=Object.keys(u),m=0;m<a.length;m++)l.push(u[a[m]]);return l}for(var f in u)l.push(u[f]);return l},p.get=function(u,l,a,m){l=l.split(".").slice(a,m);for(var f=0;f<l.length;f+=1)u=u[l[f]];return u},p.set=function(u,l,a,m,f){var x=l.split(".").slice(m,f);return p.get(u,l,0,-1)[x[x.length-1]]=a,a},p.shuffle=function(u){for(var l=u.length-1;l>0;l--){var a=Math.floor(p.random()*(l+1)),m=u[l];u[l]=u[a],u[a]=m}return u},p.choose=function(u){return u[Math.floor(p.random()*u.length)]},p.isElement=function(u){return typeof HTMLElement<"u"?u instanceof HTMLElement:!!(u&&u.nodeType&&u.nodeName)},p.isArray=function(u){return Object.prototype.toString.call(u)==="[object Array]"},p.isFunction=function(u){return typeof u=="function"},p.isPlainObject=function(u){return typeof u=="object"&&u.constructor===Object},p.isString=function(u){return toString.call(u)==="[object String]"},p.clamp=function(u,l,a){return u<l?l:u>a?a:u},p.sign=function(u){return u<0?-1:1},p.now=function(){if(typeof window<"u"&&window.performance){if(window.performance.now)return window.performance.now();if(window.performance.webkitNow)return window.performance.webkitNow()}return Date.now?Date.now():new Date-p._nowStartTime},p.random=function(u,l){return u=typeof u<"u"?u:0,l=typeof l<"u"?l:1,u+i()*(l-u)};var i=function(){return p._seed=(p._seed*9301+49297)%233280,p._seed/233280};p.colorToNumber=function(u){return u=u.replace("#",""),u.length==3&&(u=u.charAt(0)+u.charAt(0)+u.charAt(1)+u.charAt(1)+u.charAt(2)+u.charAt(2)),parseInt(u,16)},p.logLevel=1,p.log=function(){console&&p.logLevel>0&&p.logLevel<=3&&console.log.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},p.info=function(){console&&p.logLevel>0&&p.logLevel<=2&&console.info.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},p.warn=function(){console&&p.logLevel>0&&p.logLevel<=3&&console.warn.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},p.warnOnce=function(){var u=Array.prototype.slice.call(arguments).join(" ");p._warnedOnce[u]||(p.warn(u),p._warnedOnce[u]=!0)},p.deprecated=function(u,l,a){u[l]=p.chain(function(){p.warnOnce("🔅 deprecated 🔅",a)},u[l])},p.nextId=function(){return p._nextId++},p.indexOf=function(u,l){if(u.indexOf)return u.indexOf(l);for(var a=0;a<u.length;a++)if(u[a]===l)return a;return-1},p.map=function(u,l){if(u.map)return u.map(l);for(var a=[],m=0;m<u.length;m+=1)a.push(l(u[m]));return a},p.topologicalSort=function(u){var l=[],a=[],m=[];for(var f in u)!a[f]&&!m[f]&&p._topologicalSort(f,a,m,u,l);return l},p._topologicalSort=function(u,l,a,m,f){var x=m[u]||[];a[u]=!0;for(var v=0;v<x.length;v+=1){var r=x[v];a[r]||l[r]||p._topologicalSort(r,l,a,m,f)}a[u]=!1,l[u]=!0,f.push(u)},p.chain=function(){for(var u=[],l=0;l<arguments.length;l+=1){var a=arguments[l];a._chained?u.push.apply(u,a._chained):u.push(a)}var m=function(){for(var f,x=new Array(arguments.length),v=0,r=arguments.length;v<r;v++)x[v]=arguments[v];for(v=0;v<u.length;v+=1){var h=u[v].apply(f,x);typeof h<"u"&&(f=h)}return f};return m._chained=u,m},p.chainPathBefore=function(u,l,a){return p.set(u,l,p.chain(a,p.get(u,l)))},p.chainPathAfter=function(u,l,a){return p.set(u,l,p.chain(p.get(u,l),a))},p.setDecomp=function(u){p._decomp=u},p.getDecomp=function(){var u=p._decomp;try{!u&&typeof window<"u"&&(u=window.decomp),!u&&typeof Ge<"u"&&(u=Ge.decomp)}catch{u=null}return u}}()},function(s,C){var p={};s.exports=p,function(){p.create=function(i){var u={min:{x:0,y:0},max:{x:0,y:0}};return i&&p.update(u,i),u},p.update=function(i,u,l){i.min.x=1/0,i.max.x=-1/0,i.min.y=1/0,i.max.y=-1/0;for(var a=0;a<u.length;a++){var m=u[a];m.x>i.max.x&&(i.max.x=m.x),m.x<i.min.x&&(i.min.x=m.x),m.y>i.max.y&&(i.max.y=m.y),m.y<i.min.y&&(i.min.y=m.y)}l&&(l.x>0?i.max.x+=l.x:i.min.x+=l.x,l.y>0?i.max.y+=l.y:i.min.y+=l.y)},p.contains=function(i,u){return u.x>=i.min.x&&u.x<=i.max.x&&u.y>=i.min.y&&u.y<=i.max.y},p.overlaps=function(i,u){return i.min.x<=u.max.x&&i.max.x>=u.min.x&&i.max.y>=u.min.y&&i.min.y<=u.max.y},p.translate=function(i,u){i.min.x+=u.x,i.max.x+=u.x,i.min.y+=u.y,i.max.y+=u.y},p.shift=function(i,u){var l=i.max.x-i.min.x,a=i.max.y-i.min.y;i.min.x=u.x,i.max.x=u.x+l,i.min.y=u.y,i.max.y=u.y+a}}()},function(s,C){var p={};s.exports=p,function(){p.create=function(i,u){return{x:i||0,y:u||0}},p.clone=function(i){return{x:i.x,y:i.y}},p.magnitude=function(i){return Math.sqrt(i.x*i.x+i.y*i.y)},p.magnitudeSquared=function(i){return i.x*i.x+i.y*i.y},p.rotate=function(i,u,l){var a=Math.cos(u),m=Math.sin(u);l||(l={});var f=i.x*a-i.y*m;return l.y=i.x*m+i.y*a,l.x=f,l},p.rotateAbout=function(i,u,l,a){var m=Math.cos(u),f=Math.sin(u);a||(a={});var x=l.x+((i.x-l.x)*m-(i.y-l.y)*f);return a.y=l.y+((i.x-l.x)*f+(i.y-l.y)*m),a.x=x,a},p.normalise=function(i){var u=p.magnitude(i);return u===0?{x:0,y:0}:{x:i.x/u,y:i.y/u}},p.dot=function(i,u){return i.x*u.x+i.y*u.y},p.cross=function(i,u){return i.x*u.y-i.y*u.x},p.cross3=function(i,u,l){return(u.x-i.x)*(l.y-i.y)-(u.y-i.y)*(l.x-i.x)},p.add=function(i,u,l){return l||(l={}),l.x=i.x+u.x,l.y=i.y+u.y,l},p.sub=function(i,u,l){return l||(l={}),l.x=i.x-u.x,l.y=i.y-u.y,l},p.mult=function(i,u){return{x:i.x*u,y:i.y*u}},p.div=function(i,u){return{x:i.x/u,y:i.y/u}},p.perp=function(i,u){return u=u===!0?-1:1,{x:u*-i.y,y:u*i.x}},p.neg=function(i){return{x:-i.x,y:-i.y}},p.angle=function(i,u){return Math.atan2(u.y-i.y,u.x-i.x)},p._temp=[p.create(),p.create(),p.create(),p.create(),p.create(),p.create()]}()},function(s,C,p){var i={};s.exports=i;var u=p(2),l=p(0);(function(){i.create=function(a,m){for(var f=[],x=0;x<a.length;x++){var v=a[x],r={x:v.x,y:v.y,index:x,body:m,isInternal:!1};f.push(r)}return f},i.fromPath=function(a,m){var f=/L?\s*([-\d.e]+)[\s,]*([-\d.e]+)*/ig,x=[];return a.replace(f,function(v,r,h){x.push({x:parseFloat(r),y:parseFloat(h)})}),i.create(x,m)},i.centre=function(a){for(var m=i.area(a,!0),f={x:0,y:0},x,v,r,h=0;h<a.length;h++)r=(h+1)%a.length,x=u.cross(a[h],a[r]),v=u.mult(u.add(a[h],a[r]),x),f=u.add(f,v);return u.div(f,6*m)},i.mean=function(a){for(var m={x:0,y:0},f=0;f<a.length;f++)m.x+=a[f].x,m.y+=a[f].y;return u.div(m,a.length)},i.area=function(a,m){for(var f=0,x=a.length-1,v=0;v<a.length;v++)f+=(a[x].x-a[v].x)*(a[x].y+a[v].y),x=v;return m?f/2:Math.abs(f)/2},i.inertia=function(a,m){for(var f=0,x=0,v=a,r,h,c=0;c<v.length;c++)h=(c+1)%v.length,r=Math.abs(u.cross(v[h],v[c])),f+=r*(u.dot(v[h],v[h])+u.dot(v[h],v[c])+u.dot(v[c],v[c])),x+=r;return m/6*(f/x)},i.translate=function(a,m,f){f=typeof f<"u"?f:1;var x=a.length,v=m.x*f,r=m.y*f,h;for(h=0;h<x;h++)a[h].x+=v,a[h].y+=r;return a},i.rotate=function(a,m,f){if(m!==0){var x=Math.cos(m),v=Math.sin(m),r=f.x,h=f.y,c=a.length,d,S,B,U;for(U=0;U<c;U++)d=a[U],S=d.x-r,B=d.y-h,d.x=r+(S*x-B*v),d.y=h+(S*v+B*x);return a}},i.contains=function(a,m){for(var f=m.x,x=m.y,v=a.length,r=a[v-1],h,c=0;c<v;c++){if(h=a[c],(f-r.x)*(h.y-r.y)+(x-r.y)*(r.x-h.x)>0)return!1;r=h}return!0},i.scale=function(a,m,f,x){if(m===1&&f===1)return a;x=x||i.centre(a);for(var v,r,h=0;h<a.length;h++)v=a[h],r=u.sub(v,x),a[h].x=x.x+r.x*m,a[h].y=x.y+r.y*f;return a},i.chamfer=function(a,m,f,x,v){typeof m=="number"?m=[m]:m=m||[8],f=typeof f<"u"?f:-1,x=x||2,v=v||14;for(var r=[],h=0;h<a.length;h++){var c=a[h-1>=0?h-1:a.length-1],d=a[h],S=a[(h+1)%a.length],B=m[h<m.length?h:m.length-1];if(B===0){r.push(d);continue}var U=u.normalise({x:d.y-c.y,y:c.x-d.x}),_=u.normalise({x:S.y-d.y,y:d.x-S.x}),y=Math.sqrt(2*Math.pow(B,2)),w=u.mult(l.clone(U),B),M=u.normalise(u.mult(u.add(U,_),.5)),T=u.sub(d,u.mult(M,y)),I=f;f===-1&&(I=Math.pow(B,.32)*1.75),I=l.clamp(I,x,v),I%2===1&&(I+=1);for(var A=Math.acos(u.dot(U,_)),L=A/I,D=0;D<I;D++)r.push(u.add(u.rotate(w,L*D),T))}return r},i.clockwiseSort=function(a){var m=i.mean(a);return a.sort(function(f,x){return u.angle(m,f)-u.angle(m,x)}),a},i.isConvex=function(a){var m=0,f=a.length,x,v,r,h;if(f<3)return null;for(x=0;x<f;x++)if(v=(x+1)%f,r=(x+2)%f,h=(a[v].x-a[x].x)*(a[r].y-a[v].y),h-=(a[v].y-a[x].y)*(a[r].x-a[v].x),h<0?m|=1:h>0&&(m|=2),m===3)return!1;return m!==0?!0:null},i.hull=function(a){var m=[],f=[],x,v;for(a=a.slice(0),a.sort(function(r,h){var c=r.x-h.x;return c!==0?c:r.y-h.y}),v=0;v<a.length;v+=1){for(x=a[v];f.length>=2&&u.cross3(f[f.length-2],f[f.length-1],x)<=0;)f.pop();f.push(x)}for(v=a.length-1;v>=0;v-=1){for(x=a[v];m.length>=2&&u.cross3(m[m.length-2],m[m.length-1],x)<=0;)m.pop();m.push(x)}return m.pop(),f.pop(),m.concat(f)}})()},function(s,C,p){var i={};s.exports=i;var u=p(3),l=p(2),a=p(7),m=p(0),f=p(1),x=p(11);(function(){i._timeCorrection=!0,i._inertiaScale=4,i._nextCollidingGroupId=1,i._nextNonCollidingGroupId=-1,i._nextCategory=1,i._baseDelta=1e3/60,i.create=function(r){var h={id:m.nextId(),type:"body",label:"Body",parts:[],plugin:{},angle:0,vertices:u.fromPath("L 0 0 L 40 0 L 40 40 L 0 40"),position:{x:0,y:0},force:{x:0,y:0},torque:0,positionImpulse:{x:0,y:0},constraintImpulse:{x:0,y:0,angle:0},totalContacts:0,speed:0,angularSpeed:0,velocity:{x:0,y:0},angularVelocity:0,isSensor:!1,isStatic:!1,isSleeping:!1,motion:0,sleepThreshold:60,density:.001,restitution:0,friction:.1,frictionStatic:.5,frictionAir:.01,collisionFilter:{category:1,mask:4294967295,group:0},slop:.05,timeScale:1,render:{visible:!0,opacity:1,strokeStyle:null,fillStyle:null,lineWidth:null,sprite:{xScale:1,yScale:1,xOffset:0,yOffset:0}},events:null,bounds:null,chamfer:null,circleRadius:0,positionPrev:null,anglePrev:0,parent:null,axes:null,area:0,mass:0,inertia:0,deltaTime:16.666666666666668,_original:null},c=m.extend(h,r);return v(c,r),c},i.nextGroup=function(r){return r?i._nextNonCollidingGroupId--:i._nextCollidingGroupId++},i.nextCategory=function(){return i._nextCategory=i._nextCategory<<1,i._nextCategory};var v=function(r,h){h=h||{},i.set(r,{bounds:r.bounds||f.create(r.vertices),positionPrev:r.positionPrev||l.clone(r.position),anglePrev:r.anglePrev||r.angle,vertices:r.vertices,parts:r.parts||[r],isStatic:r.isStatic,isSleeping:r.isSleeping,parent:r.parent||r}),u.rotate(r.vertices,r.angle,r.position),x.rotate(r.axes,r.angle),f.update(r.bounds,r.vertices,r.velocity),i.set(r,{axes:h.axes||r.axes,area:h.area||r.area,mass:h.mass||r.mass,inertia:h.inertia||r.inertia});var c=r.isStatic?"#14151f":m.choose(["#f19648","#f5d259","#f55a3c","#063e7b","#ececd1"]),d=r.isStatic?"#555":"#ccc",S=r.isStatic&&r.render.fillStyle===null?1:0;r.render.fillStyle=r.render.fillStyle||c,r.render.strokeStyle=r.render.strokeStyle||d,r.render.lineWidth=r.render.lineWidth||S,r.render.sprite.xOffset+=-(r.bounds.min.x-r.position.x)/(r.bounds.max.x-r.bounds.min.x),r.render.sprite.yOffset+=-(r.bounds.min.y-r.position.y)/(r.bounds.max.y-r.bounds.min.y)};i.set=function(r,h,c){var d;typeof h=="string"&&(d=h,h={},h[d]=c);for(d in h)if(Object.prototype.hasOwnProperty.call(h,d))switch(c=h[d],d){case"isStatic":i.setStatic(r,c);break;case"isSleeping":a.set(r,c);break;case"mass":i.setMass(r,c);break;case"density":i.setDensity(r,c);break;case"inertia":i.setInertia(r,c);break;case"vertices":i.setVertices(r,c);break;case"position":i.setPosition(r,c);break;case"angle":i.setAngle(r,c);break;case"velocity":i.setVelocity(r,c);break;case"angularVelocity":i.setAngularVelocity(r,c);break;case"speed":i.setSpeed(r,c);break;case"angularSpeed":i.setAngularSpeed(r,c);break;case"parts":i.setParts(r,c);break;case"centre":i.setCentre(r,c);break;default:r[d]=c}},i.setStatic=function(r,h){for(var c=0;c<r.parts.length;c++){var d=r.parts[c];h?(d.isStatic||(d._original={restitution:d.restitution,friction:d.friction,mass:d.mass,inertia:d.inertia,density:d.density,inverseMass:d.inverseMass,inverseInertia:d.inverseInertia}),d.restitution=0,d.friction=1,d.mass=d.inertia=d.density=1/0,d.inverseMass=d.inverseInertia=0,d.positionPrev.x=d.position.x,d.positionPrev.y=d.position.y,d.anglePrev=d.angle,d.angularVelocity=0,d.speed=0,d.angularSpeed=0,d.motion=0):d._original&&(d.restitution=d._original.restitution,d.friction=d._original.friction,d.mass=d._original.mass,d.inertia=d._original.inertia,d.density=d._original.density,d.inverseMass=d._original.inverseMass,d.inverseInertia=d._original.inverseInertia,d._original=null),d.isStatic=h}},i.setMass=function(r,h){var c=r.inertia/(r.mass/6);r.inertia=c*(h/6),r.inverseInertia=1/r.inertia,r.mass=h,r.inverseMass=1/r.mass,r.density=r.mass/r.area},i.setDensity=function(r,h){i.setMass(r,h*r.area),r.density=h},i.setInertia=function(r,h){r.inertia=h,r.inverseInertia=1/r.inertia},i.setVertices=function(r,h){h[0].body===r?r.vertices=h:r.vertices=u.create(h,r),r.axes=x.fromVertices(r.vertices),r.area=u.area(r.vertices),i.setMass(r,r.density*r.area);var c=u.centre(r.vertices);u.translate(r.vertices,c,-1),i.setInertia(r,i._inertiaScale*u.inertia(r.vertices,r.mass)),u.translate(r.vertices,r.position),f.update(r.bounds,r.vertices,r.velocity)},i.setParts=function(r,h,c){var d;for(h=h.slice(0),r.parts.length=0,r.parts.push(r),r.parent=r,d=0;d<h.length;d++){var S=h[d];S!==r&&(S.parent=r,r.parts.push(S))}if(r.parts.length!==1){if(c=typeof c<"u"?c:!0,c){var B=[];for(d=0;d<h.length;d++)B=B.concat(h[d].vertices);u.clockwiseSort(B);var U=u.hull(B),_=u.centre(U);i.setVertices(r,U),u.translate(r.vertices,_)}var y=i._totalProperties(r);r.area=y.area,r.parent=r,r.position.x=y.centre.x,r.position.y=y.centre.y,r.positionPrev.x=y.centre.x,r.positionPrev.y=y.centre.y,i.setMass(r,y.mass),i.setInertia(r,y.inertia),i.setPosition(r,y.centre)}},i.setCentre=function(r,h,c){c?(r.positionPrev.x+=h.x,r.positionPrev.y+=h.y,r.position.x+=h.x,r.position.y+=h.y):(r.positionPrev.x=h.x-(r.position.x-r.positionPrev.x),r.positionPrev.y=h.y-(r.position.y-r.positionPrev.y),r.position.x=h.x,r.position.y=h.y)},i.setPosition=function(r,h,c){var d=l.sub(h,r.position);c?(r.positionPrev.x=r.position.x,r.positionPrev.y=r.position.y,r.velocity.x=d.x,r.velocity.y=d.y,r.speed=l.magnitude(d)):(r.positionPrev.x+=d.x,r.positionPrev.y+=d.y);for(var S=0;S<r.parts.length;S++){var B=r.parts[S];B.position.x+=d.x,B.position.y+=d.y,u.translate(B.vertices,d),f.update(B.bounds,B.vertices,r.velocity)}},i.setAngle=function(r,h,c){var d=h-r.angle;c?(r.anglePrev=r.angle,r.angularVelocity=d,r.angularSpeed=Math.abs(d)):r.anglePrev+=d;for(var S=0;S<r.parts.length;S++){var B=r.parts[S];B.angle+=d,u.rotate(B.vertices,d,r.position),x.rotate(B.axes,d),f.update(B.bounds,B.vertices,r.velocity),S>0&&l.rotateAbout(B.position,d,r.position,B.position)}},i.setVelocity=function(r,h){var c=r.deltaTime/i._baseDelta;r.positionPrev.x=r.position.x-h.x*c,r.positionPrev.y=r.position.y-h.y*c,r.velocity.x=(r.position.x-r.positionPrev.x)/c,r.velocity.y=(r.position.y-r.positionPrev.y)/c,r.speed=l.magnitude(r.velocity)},i.getVelocity=function(r){var h=i._baseDelta/r.deltaTime;return{x:(r.position.x-r.positionPrev.x)*h,y:(r.position.y-r.positionPrev.y)*h}},i.getSpeed=function(r){return l.magnitude(i.getVelocity(r))},i.setSpeed=function(r,h){i.setVelocity(r,l.mult(l.normalise(i.getVelocity(r)),h))},i.setAngularVelocity=function(r,h){var c=r.deltaTime/i._baseDelta;r.anglePrev=r.angle-h*c,r.angularVelocity=(r.angle-r.anglePrev)/c,r.angularSpeed=Math.abs(r.angularVelocity)},i.getAngularVelocity=function(r){return(r.angle-r.anglePrev)*i._baseDelta/r.deltaTime},i.getAngularSpeed=function(r){return Math.abs(i.getAngularVelocity(r))},i.setAngularSpeed=function(r,h){i.setAngularVelocity(r,m.sign(i.getAngularVelocity(r))*h)},i.translate=function(r,h,c){i.setPosition(r,l.add(r.position,h),c)},i.rotate=function(r,h,c,d){if(!c)i.setAngle(r,r.angle+h,d);else{var S=Math.cos(h),B=Math.sin(h),U=r.position.x-c.x,_=r.position.y-c.y;i.setPosition(r,{x:c.x+(U*S-_*B),y:c.y+(U*B+_*S)},d),i.setAngle(r,r.angle+h,d)}},i.scale=function(r,h,c,d){var S=0,B=0;d=d||r.position;for(var U=0;U<r.parts.length;U++){var _=r.parts[U];u.scale(_.vertices,h,c,d),_.axes=x.fromVertices(_.vertices),_.area=u.area(_.vertices),i.setMass(_,r.density*_.area),u.translate(_.vertices,{x:-_.position.x,y:-_.position.y}),i.setInertia(_,i._inertiaScale*u.inertia(_.vertices,_.mass)),u.translate(_.vertices,{x:_.position.x,y:_.position.y}),U>0&&(S+=_.area,B+=_.inertia),_.position.x=d.x+(_.position.x-d.x)*h,_.position.y=d.y+(_.position.y-d.y)*c,f.update(_.bounds,_.vertices,r.velocity)}r.parts.length>1&&(r.area=S,r.isStatic||(i.setMass(r,r.density*S),i.setInertia(r,B))),r.circleRadius&&(h===c?r.circleRadius*=h:r.circleRadius=null)},i.update=function(r,h){h=(typeof h<"u"?h:1e3/60)*r.timeScale;var c=h*h,d=i._timeCorrection?h/(r.deltaTime||h):1,S=1-r.frictionAir*(h/m._baseDelta),B=(r.position.x-r.positionPrev.x)*d,U=(r.position.y-r.positionPrev.y)*d;r.velocity.x=B*S+r.force.x/r.mass*c,r.velocity.y=U*S+r.force.y/r.mass*c,r.positionPrev.x=r.position.x,r.positionPrev.y=r.position.y,r.position.x+=r.velocity.x,r.position.y+=r.velocity.y,r.deltaTime=h,r.angularVelocity=(r.angle-r.anglePrev)*S*d+r.torque/r.inertia*c,r.anglePrev=r.angle,r.angle+=r.angularVelocity;for(var _=0;_<r.parts.length;_++){var y=r.parts[_];u.translate(y.vertices,r.velocity),_>0&&(y.position.x+=r.velocity.x,y.position.y+=r.velocity.y),r.angularVelocity!==0&&(u.rotate(y.vertices,r.angularVelocity,r.position),x.rotate(y.axes,r.angularVelocity),_>0&&l.rotateAbout(y.position,r.angularVelocity,r.position,y.position)),f.update(y.bounds,y.vertices,r.velocity)}},i.updateVelocities=function(r){var h=i._baseDelta/r.deltaTime,c=r.velocity;c.x=(r.position.x-r.positionPrev.x)*h,c.y=(r.position.y-r.positionPrev.y)*h,r.speed=Math.sqrt(c.x*c.x+c.y*c.y),r.angularVelocity=(r.angle-r.anglePrev)*h,r.angularSpeed=Math.abs(r.angularVelocity)},i.applyForce=function(r,h,c){var d={x:h.x-r.position.x,y:h.y-r.position.y};r.force.x+=c.x,r.force.y+=c.y,r.torque+=d.x*c.y-d.y*c.x},i._totalProperties=function(r){for(var h={mass:0,area:0,inertia:0,centre:{x:0,y:0}},c=r.parts.length===1?0:1;c<r.parts.length;c++){var d=r.parts[c],S=d.mass!==1/0?d.mass:1;h.mass+=S,h.area+=d.area,h.inertia+=d.inertia,h.centre=l.add(h.centre,l.mult(d.position,S))}return h.centre=l.div(h.centre,h.mass),h}})()},function(s,C,p){var i={};s.exports=i;var u=p(0);(function(){i.on=function(l,a,m){for(var f=a.split(" "),x,v=0;v<f.length;v++)x=f[v],l.events=l.events||{},l.events[x]=l.events[x]||[],l.events[x].push(m);return m},i.off=function(l,a,m){if(!a){l.events={};return}typeof a=="function"&&(m=a,a=u.keys(l.events).join(" "));for(var f=a.split(" "),x=0;x<f.length;x++){var v=l.events[f[x]],r=[];if(m&&v)for(var h=0;h<v.length;h++)v[h]!==m&&r.push(v[h]);l.events[f[x]]=r}},i.trigger=function(l,a,m){var f,x,v,r,h=l.events;if(h&&u.keys(h).length>0){m||(m={}),f=a.split(" ");for(var c=0;c<f.length;c++)if(x=f[c],v=h[x],v){r=u.clone(m,!1),r.name=x,r.source=l;for(var d=0;d<v.length;d++)v[d].apply(l,[r])}}}})()},function(s,C,p){var i={};s.exports=i;var u=p(5),l=p(0),a=p(1),m=p(4);(function(){i.create=function(f){return l.extend({id:l.nextId(),type:"composite",parent:null,isModified:!1,bodies:[],constraints:[],composites:[],label:"Composite",plugin:{},cache:{allBodies:null,allConstraints:null,allComposites:null}},f)},i.setModified=function(f,x,v,r){if(f.isModified=x,x&&f.cache&&(f.cache.allBodies=null,f.cache.allConstraints=null,f.cache.allComposites=null),v&&f.parent&&i.setModified(f.parent,x,v,r),r)for(var h=0;h<f.composites.length;h++){var c=f.composites[h];i.setModified(c,x,v,r)}},i.add=function(f,x){var v=[].concat(x);u.trigger(f,"beforeAdd",{object:x});for(var r=0;r<v.length;r++){var h=v[r];switch(h.type){case"body":if(h.parent!==h){l.warn("Composite.add: skipped adding a compound body part (you must add its parent instead)");break}i.addBody(f,h);break;case"constraint":i.addConstraint(f,h);break;case"composite":i.addComposite(f,h);break;case"mouseConstraint":i.addConstraint(f,h.constraint);break}}return u.trigger(f,"afterAdd",{object:x}),f},i.remove=function(f,x,v){var r=[].concat(x);u.trigger(f,"beforeRemove",{object:x});for(var h=0;h<r.length;h++){var c=r[h];switch(c.type){case"body":i.removeBody(f,c,v);break;case"constraint":i.removeConstraint(f,c,v);break;case"composite":i.removeComposite(f,c,v);break;case"mouseConstraint":i.removeConstraint(f,c.constraint);break}}return u.trigger(f,"afterRemove",{object:x}),f},i.addComposite=function(f,x){return f.composites.push(x),x.parent=f,i.setModified(f,!0,!0,!1),f},i.removeComposite=function(f,x,v){var r=l.indexOf(f.composites,x);if(r!==-1){var h=i.allBodies(x);i.removeCompositeAt(f,r);for(var c=0;c<h.length;c++)h[c].sleepCounter=0}if(v)for(var c=0;c<f.composites.length;c++)i.removeComposite(f.composites[c],x,!0);return f},i.removeCompositeAt=function(f,x){return f.composites.splice(x,1),i.setModified(f,!0,!0,!1),f},i.addBody=function(f,x){return f.bodies.push(x),i.setModified(f,!0,!0,!1),f},i.removeBody=function(f,x,v){var r=l.indexOf(f.bodies,x);if(r!==-1&&(i.removeBodyAt(f,r),x.sleepCounter=0),v)for(var h=0;h<f.composites.length;h++)i.removeBody(f.composites[h],x,!0);return f},i.removeBodyAt=function(f,x){return f.bodies.splice(x,1),i.setModified(f,!0,!0,!1),f},i.addConstraint=function(f,x){return f.constraints.push(x),i.setModified(f,!0,!0,!1),f},i.removeConstraint=function(f,x,v){var r=l.indexOf(f.constraints,x);if(r!==-1&&i.removeConstraintAt(f,r),v)for(var h=0;h<f.composites.length;h++)i.removeConstraint(f.composites[h],x,!0);return f},i.removeConstraintAt=function(f,x){return f.constraints.splice(x,1),i.setModified(f,!0,!0,!1),f},i.clear=function(f,x,v){if(v)for(var r=0;r<f.composites.length;r++)i.clear(f.composites[r],x,!0);return x?f.bodies=f.bodies.filter(function(h){return h.isStatic}):f.bodies.length=0,f.constraints.length=0,f.composites.length=0,i.setModified(f,!0,!0,!1),f},i.allBodies=function(f){if(f.cache&&f.cache.allBodies)return f.cache.allBodies;for(var x=[].concat(f.bodies),v=0;v<f.composites.length;v++)x=x.concat(i.allBodies(f.composites[v]));return f.cache&&(f.cache.allBodies=x),x},i.allConstraints=function(f){if(f.cache&&f.cache.allConstraints)return f.cache.allConstraints;for(var x=[].concat(f.constraints),v=0;v<f.composites.length;v++)x=x.concat(i.allConstraints(f.composites[v]));return f.cache&&(f.cache.allConstraints=x),x},i.allComposites=function(f){if(f.cache&&f.cache.allComposites)return f.cache.allComposites;for(var x=[].concat(f.composites),v=0;v<f.composites.length;v++)x=x.concat(i.allComposites(f.composites[v]));return f.cache&&(f.cache.allComposites=x),x},i.get=function(f,x,v){var r,h;switch(v){case"body":r=i.allBodies(f);break;case"constraint":r=i.allConstraints(f);break;case"composite":r=i.allComposites(f).concat(f);break}return r?(h=r.filter(function(c){return c.id.toString()===x.toString()}),h.length===0?null:h[0]):null},i.move=function(f,x,v){return i.remove(f,x),i.add(v,x),f},i.rebase=function(f){for(var x=i.allBodies(f).concat(i.allConstraints(f)).concat(i.allComposites(f)),v=0;v<x.length;v++)x[v].id=l.nextId();return f},i.translate=function(f,x,v){for(var r=v?i.allBodies(f):f.bodies,h=0;h<r.length;h++)m.translate(r[h],x);return f},i.rotate=function(f,x,v,r){for(var h=Math.cos(x),c=Math.sin(x),d=r?i.allBodies(f):f.bodies,S=0;S<d.length;S++){var B=d[S],U=B.position.x-v.x,_=B.position.y-v.y;m.setPosition(B,{x:v.x+(U*h-_*c),y:v.y+(U*c+_*h)}),m.rotate(B,x)}return f},i.scale=function(f,x,v,r,h){for(var c=h?i.allBodies(f):f.bodies,d=0;d<c.length;d++){var S=c[d],B=S.position.x-r.x,U=S.position.y-r.y;m.setPosition(S,{x:r.x+B*x,y:r.y+U*v}),m.scale(S,x,v)}return f},i.bounds=function(f){for(var x=i.allBodies(f),v=[],r=0;r<x.length;r+=1){var h=x[r];v.push(h.bounds.min,h.bounds.max)}return a.create(v)}})()},function(s,C,p){var i={};s.exports=i;var u=p(4),l=p(5),a=p(0);(function(){i._motionWakeThreshold=.18,i._motionSleepThreshold=.08,i._minBias=.9,i.update=function(m,f){for(var x=f/a._baseDelta,v=i._motionSleepThreshold,r=0;r<m.length;r++){var h=m[r],c=u.getSpeed(h),d=u.getAngularSpeed(h),S=c*c+d*d;if(h.force.x!==0||h.force.y!==0){i.set(h,!1);continue}var B=Math.min(h.motion,S),U=Math.max(h.motion,S);h.motion=i._minBias*B+(1-i._minBias)*U,h.sleepThreshold>0&&h.motion<v?(h.sleepCounter+=1,h.sleepCounter>=h.sleepThreshold/x&&i.set(h,!0)):h.sleepCounter>0&&(h.sleepCounter-=1)}},i.afterCollisions=function(m){for(var f=i._motionSleepThreshold,x=0;x<m.length;x++){var v=m[x];if(v.isActive){var r=v.collision,h=r.bodyA.parent,c=r.bodyB.parent;if(!(h.isSleeping&&c.isSleeping||h.isStatic||c.isStatic)&&(h.isSleeping||c.isSleeping)){var d=h.isSleeping&&!h.isStatic?h:c,S=d===h?c:h;!d.isStatic&&S.motion>f&&i.set(d,!1)}}}},i.set=function(m,f){var x=m.isSleeping;f?(m.isSleeping=!0,m.sleepCounter=m.sleepThreshold,m.positionImpulse.x=0,m.positionImpulse.y=0,m.positionPrev.x=m.position.x,m.positionPrev.y=m.position.y,m.anglePrev=m.angle,m.speed=0,m.angularSpeed=0,m.motion=0,x||l.trigger(m,"sleepStart")):(m.isSleeping=!1,m.sleepCounter=0,x&&l.trigger(m,"sleepEnd"))}})()},function(s,C,p){var i={};s.exports=i;var u=p(3),l=p(9);(function(){var a=[],m={overlap:0,axis:null},f={overlap:0,axis:null};i.create=function(x,v){return{pair:null,collided:!1,bodyA:x,bodyB:v,parentA:x.parent,parentB:v.parent,depth:0,normal:{x:0,y:0},tangent:{x:0,y:0},penetration:{x:0,y:0},supports:[null,null],supportCount:0}},i.collides=function(x,v,r){if(i._overlapAxes(m,x.vertices,v.vertices,x.axes),m.overlap<=0||(i._overlapAxes(f,v.vertices,x.vertices,v.axes),f.overlap<=0))return null;var h=r&&r.table[l.id(x,v)],c;h?c=h.collision:(c=i.create(x,v),c.collided=!0,c.bodyA=x.id<v.id?x:v,c.bodyB=x.id<v.id?v:x,c.parentA=c.bodyA.parent,c.parentB=c.bodyB.parent),x=c.bodyA,v=c.bodyB;var d;m.overlap<f.overlap?d=m:d=f;var S=c.normal,B=c.tangent,U=c.penetration,_=c.supports,y=d.overlap,w=d.axis,M=w.x,T=w.y,I=v.position.x-x.position.x,A=v.position.y-x.position.y;M*I+T*A>=0&&(M=-M,T=-T),S.x=M,S.y=T,B.x=-T,B.y=M,U.x=M*y,U.y=T*y,c.depth=y;var L=i._findSupports(x,v,S,1),D=0;if(u.contains(x.vertices,L[0])&&(_[D++]=L[0]),u.contains(x.vertices,L[1])&&(_[D++]=L[1]),D<2){var K=i._findSupports(v,x,S,-1);u.contains(v.vertices,K[0])&&(_[D++]=K[0]),D<2&&u.contains(v.vertices,K[1])&&(_[D++]=K[1])}return D===0&&(_[D++]=L[0]),c.supportCount=D,c},i._overlapAxes=function(x,v,r,h){var c=v.length,d=r.length,S=v[0].x,B=v[0].y,U=r[0].x,_=r[0].y,y=h.length,w=Number.MAX_VALUE,M=0,T,I,A,L,D,K;for(D=0;D<y;D++){var X=h[D],Z=X.x,et=X.y,Q=S*Z+B*et,at=U*Z+_*et,vt=Q,_t=at;for(K=1;K<c;K+=1)L=v[K].x*Z+v[K].y*et,L>vt?vt=L:L<Q&&(Q=L);for(K=1;K<d;K+=1)L=r[K].x*Z+r[K].y*et,L>_t?_t=L:L<at&&(at=L);if(I=vt-at,A=_t-Q,T=I<A?I:A,T<w&&(w=T,M=D,T<=0))break}x.axis=h[M],x.overlap=w},i._findSupports=function(x,v,r,h){var c=v.vertices,d=c.length,S=x.position.x,B=x.position.y,U=r.x*h,_=r.y*h,y=c[0],w=y,M=U*(S-w.x)+_*(B-w.y),T,I,A;for(A=1;A<d;A+=1)w=c[A],I=U*(S-w.x)+_*(B-w.y),I<M&&(M=I,y=w);return T=c[(d+y.index-1)%d],M=U*(S-T.x)+_*(B-T.y),w=c[(y.index+1)%d],U*(S-w.x)+_*(B-w.y)<M?(a[0]=y,a[1]=w,a):(a[0]=y,a[1]=T,a)}})()},function(s,C,p){var i={};s.exports=i;var u=p(16);(function(){i.create=function(l,a){var m=l.bodyA,f=l.bodyB,x={id:i.id(m,f),bodyA:m,bodyB:f,collision:l,contacts:[u.create(),u.create()],contactCount:0,separation:0,isActive:!0,isSensor:m.isSensor||f.isSensor,timeCreated:a,timeUpdated:a,inverseMass:0,friction:0,frictionStatic:0,restitution:0,slop:0};return i.update(x,l,a),x},i.update=function(l,a,m){var f=a.supports,x=a.supportCount,v=l.contacts,r=a.parentA,h=a.parentB;l.isActive=!0,l.timeUpdated=m,l.collision=a,l.separation=a.depth,l.inverseMass=r.inverseMass+h.inverseMass,l.friction=r.friction<h.friction?r.friction:h.friction,l.frictionStatic=r.frictionStatic>h.frictionStatic?r.frictionStatic:h.frictionStatic,l.restitution=r.restitution>h.restitution?r.restitution:h.restitution,l.slop=r.slop>h.slop?r.slop:h.slop,l.contactCount=x,a.pair=l;var c=f[0],d=v[0],S=f[1],B=v[1];(B.vertex===c||d.vertex===S)&&(v[1]=d,v[0]=d=B,B=v[1]),d.vertex=c,B.vertex=S},i.setActive=function(l,a,m){a?(l.isActive=!0,l.timeUpdated=m):(l.isActive=!1,l.contactCount=0)},i.id=function(l,a){return l.id<a.id?l.id.toString(36)+":"+a.id.toString(36):a.id.toString(36)+":"+l.id.toString(36)}})()},function(s,C,p){var i={};s.exports=i;var u=p(3),l=p(2),a=p(7),m=p(1),f=p(11),x=p(0);(function(){i._warming=.4,i._torqueDampen=1,i._minLength=1e-6,i.create=function(v){var r=v;r.bodyA&&!r.pointA&&(r.pointA={x:0,y:0}),r.bodyB&&!r.pointB&&(r.pointB={x:0,y:0});var h=r.bodyA?l.add(r.bodyA.position,r.pointA):r.pointA,c=r.bodyB?l.add(r.bodyB.position,r.pointB):r.pointB,d=l.magnitude(l.sub(h,c));r.length=typeof r.length<"u"?r.length:d,r.id=r.id||x.nextId(),r.label=r.label||"Constraint",r.type="constraint",r.stiffness=r.stiffness||(r.length>0?1:.7),r.damping=r.damping||0,r.angularStiffness=r.angularStiffness||0,r.angleA=r.bodyA?r.bodyA.angle:r.angleA,r.angleB=r.bodyB?r.bodyB.angle:r.angleB,r.plugin={};var S={visible:!0,lineWidth:2,strokeStyle:"#ffffff",type:"line",anchors:!0};return r.length===0&&r.stiffness>.1?(S.type="pin",S.anchors=!1):r.stiffness<.9&&(S.type="spring"),r.render=x.extend(S,r.render),r},i.preSolveAll=function(v){for(var r=0;r<v.length;r+=1){var h=v[r],c=h.constraintImpulse;h.isStatic||c.x===0&&c.y===0&&c.angle===0||(h.position.x+=c.x,h.position.y+=c.y,h.angle+=c.angle)}},i.solveAll=function(v,r){for(var h=x.clamp(r/x._baseDelta,0,1),c=0;c<v.length;c+=1){var d=v[c],S=!d.bodyA||d.bodyA&&d.bodyA.isStatic,B=!d.bodyB||d.bodyB&&d.bodyB.isStatic;(S||B)&&i.solve(v[c],h)}for(c=0;c<v.length;c+=1)d=v[c],S=!d.bodyA||d.bodyA&&d.bodyA.isStatic,B=!d.bodyB||d.bodyB&&d.bodyB.isStatic,!S&&!B&&i.solve(v[c],h)},i.solve=function(v,r){var h=v.bodyA,c=v.bodyB,d=v.pointA,S=v.pointB;if(!(!h&&!c)){h&&!h.isStatic&&(l.rotate(d,h.angle-v.angleA,d),v.angleA=h.angle),c&&!c.isStatic&&(l.rotate(S,c.angle-v.angleB,S),v.angleB=c.angle);var B=d,U=S;if(h&&(B=l.add(h.position,d)),c&&(U=l.add(c.position,S)),!(!B||!U)){var _=l.sub(B,U),y=l.magnitude(_);y<i._minLength&&(y=i._minLength);var w=(y-v.length)/y,M=v.stiffness>=1||v.length===0,T=M?v.stiffness*r:v.stiffness*r*r,I=v.damping*r,A=l.mult(_,w*T),L=(h?h.inverseMass:0)+(c?c.inverseMass:0),D=(h?h.inverseInertia:0)+(c?c.inverseInertia:0),K=L+D,X,Z,et,Q,at;if(I>0){var vt=l.create();et=l.div(_,y),at=l.sub(c&&l.sub(c.position,c.positionPrev)||vt,h&&l.sub(h.position,h.positionPrev)||vt),Q=l.dot(et,at)}h&&!h.isStatic&&(Z=h.inverseMass/L,h.constraintImpulse.x-=A.x*Z,h.constraintImpulse.y-=A.y*Z,h.position.x-=A.x*Z,h.position.y-=A.y*Z,I>0&&(h.positionPrev.x-=I*et.x*Q*Z,h.positionPrev.y-=I*et.y*Q*Z),X=l.cross(d,A)/K*i._torqueDampen*h.inverseInertia*(1-v.angularStiffness),h.constraintImpulse.angle-=X,h.angle-=X),c&&!c.isStatic&&(Z=c.inverseMass/L,c.constraintImpulse.x+=A.x*Z,c.constraintImpulse.y+=A.y*Z,c.position.x+=A.x*Z,c.position.y+=A.y*Z,I>0&&(c.positionPrev.x+=I*et.x*Q*Z,c.positionPrev.y+=I*et.y*Q*Z),X=l.cross(S,A)/K*i._torqueDampen*c.inverseInertia*(1-v.angularStiffness),c.constraintImpulse.angle+=X,c.angle+=X)}}},i.postSolveAll=function(v){for(var r=0;r<v.length;r++){var h=v[r],c=h.constraintImpulse;if(!(h.isStatic||c.x===0&&c.y===0&&c.angle===0)){a.set(h,!1);for(var d=0;d<h.parts.length;d++){var S=h.parts[d];u.translate(S.vertices,c),d>0&&(S.position.x+=c.x,S.position.y+=c.y),c.angle!==0&&(u.rotate(S.vertices,c.angle,h.position),f.rotate(S.axes,c.angle),d>0&&l.rotateAbout(S.position,c.angle,h.position,S.position)),m.update(S.bounds,S.vertices,h.velocity)}c.angle*=i._warming,c.x*=i._warming,c.y*=i._warming}}},i.pointAWorld=function(v){return{x:(v.bodyA?v.bodyA.position.x:0)+(v.pointA?v.pointA.x:0),y:(v.bodyA?v.bodyA.position.y:0)+(v.pointA?v.pointA.y:0)}},i.pointBWorld=function(v){return{x:(v.bodyB?v.bodyB.position.x:0)+(v.pointB?v.pointB.x:0),y:(v.bodyB?v.bodyB.position.y:0)+(v.pointB?v.pointB.y:0)}},i.currentLength=function(v){var r=(v.bodyA?v.bodyA.position.x:0)+(v.pointA?v.pointA.x:0),h=(v.bodyA?v.bodyA.position.y:0)+(v.pointA?v.pointA.y:0),c=(v.bodyB?v.bodyB.position.x:0)+(v.pointB?v.pointB.x:0),d=(v.bodyB?v.bodyB.position.y:0)+(v.pointB?v.pointB.y:0),S=r-c,B=h-d;return Math.sqrt(S*S+B*B)}})()},function(s,C,p){var i={};s.exports=i;var u=p(2),l=p(0);(function(){i.fromVertices=function(a){for(var m={},f=0;f<a.length;f++){var x=(f+1)%a.length,v=u.normalise({x:a[x].y-a[f].y,y:a[f].x-a[x].x}),r=v.y===0?1/0:v.x/v.y;r=r.toFixed(3).toString(),m[r]=v}return l.values(m)},i.rotate=function(a,m){if(m!==0)for(var f=Math.cos(m),x=Math.sin(m),v=0;v<a.length;v++){var r=a[v],h;h=r.x*f-r.y*x,r.y=r.x*x+r.y*f,r.x=h}}})()},function(s,C,p){var i={};s.exports=i;var u=p(3),l=p(0),a=p(4),m=p(1),f=p(2);(function(){i.rectangle=function(x,v,r,h,c){c=c||{};var d={label:"Rectangle Body",position:{x,y:v},vertices:u.fromPath("L 0 0 L "+r+" 0 L "+r+" "+h+" L 0 "+h)};if(c.chamfer){var S=c.chamfer;d.vertices=u.chamfer(d.vertices,S.radius,S.quality,S.qualityMin,S.qualityMax),delete c.chamfer}return a.create(l.extend({},d,c))},i.trapezoid=function(x,v,r,h,c,d){d=d||{},c>=1&&l.warn("Bodies.trapezoid: slope parameter must be < 1."),c*=.5;var S=(1-c*2)*r,B=r*c,U=B+S,_=U+B,y;c<.5?y="L 0 0 L "+B+" "+-h+" L "+U+" "+-h+" L "+_+" 0":y="L 0 0 L "+U+" "+-h+" L "+_+" 0";var w={label:"Trapezoid Body",position:{x,y:v},vertices:u.fromPath(y)};if(d.chamfer){var M=d.chamfer;w.vertices=u.chamfer(w.vertices,M.radius,M.quality,M.qualityMin,M.qualityMax),delete d.chamfer}return a.create(l.extend({},w,d))},i.circle=function(x,v,r,h,c){h=h||{};var d={label:"Circle Body",circleRadius:r};c=c||25;var S=Math.ceil(Math.max(10,Math.min(c,r)));return S%2===1&&(S+=1),i.polygon(x,v,S,r,l.extend({},d,h))},i.polygon=function(x,v,r,h,c){if(c=c||{},r<3)return i.circle(x,v,h,c);for(var d=2*Math.PI/r,S="",B=d*.5,U=0;U<r;U+=1){var _=B+U*d,y=Math.cos(_)*h,w=Math.sin(_)*h;S+="L "+y.toFixed(3)+" "+w.toFixed(3)+" "}var M={label:"Polygon Body",position:{x,y:v},vertices:u.fromPath(S)};if(c.chamfer){var T=c.chamfer;M.vertices=u.chamfer(M.vertices,T.radius,T.quality,T.qualityMin,T.qualityMax),delete c.chamfer}return a.create(l.extend({},M,c))},i.fromVertices=function(x,v,r,h,c,d,S,B){var U=l.getDecomp(),_,y,w,M,T,I,A,L,D,K,X;for(_=!!(U&&U.quickDecomp),h=h||{},w=[],c=typeof c<"u"?c:!1,d=typeof d<"u"?d:.01,S=typeof S<"u"?S:10,B=typeof B<"u"?B:.01,l.isArray(r[0])||(r=[r]),K=0;K<r.length;K+=1)if(I=r[K],M=u.isConvex(I),T=!M,T&&!_&&l.warnOnce("Bodies.fromVertices: Install the 'poly-decomp' library and use Common.setDecomp or provide 'decomp' as a global to decompose concave vertices."),M||!_)M?I=u.clockwiseSort(I):I=u.hull(I),w.push({position:{x,y:v},vertices:I});else{var Z=I.map(function(ft){return[ft.x,ft.y]});U.makeCCW(Z),d!==!1&&U.removeCollinearPoints(Z,d),B!==!1&&U.removeDuplicatePoints&&U.removeDuplicatePoints(Z,B);var et=U.quickDecomp(Z);for(A=0;A<et.length;A++){var Q=et[A],at=Q.map(function(ft){return{x:ft[0],y:ft[1]}});S>0&&u.area(at)<S||w.push({position:u.centre(at),vertices:at})}}for(A=0;A<w.length;A++)w[A]=a.create(l.extend(w[A],h));if(c){var vt=5;for(A=0;A<w.length;A++){var _t=w[A];for(L=A+1;L<w.length;L++){var Ct=w[L];if(m.overlaps(_t.bounds,Ct.bounds)){var kt=_t.vertices,ut=Ct.vertices;for(D=0;D<_t.vertices.length;D++)for(X=0;X<Ct.vertices.length;X++){var fe=f.magnitudeSquared(f.sub(kt[(D+1)%kt.length],ut[X])),Wt=f.magnitudeSquared(f.sub(kt[D],ut[(X+1)%ut.length]));fe<vt&&Wt<vt&&(kt[D].isInternal=!0,ut[X].isInternal=!0)}}}}}return w.length>1?(y=a.create(l.extend({parts:w.slice(0)},h)),a.setPosition(y,{x,y:v}),y):w[0]}})()},function(s,C,p){var i={};s.exports=i;var u=p(0),l=p(8);(function(){i.create=function(a){var m={bodies:[],collisions:[],pairs:null};return u.extend(m,a)},i.setBodies=function(a,m){a.bodies=m.slice(0)},i.clear=function(a){a.bodies=[],a.collisions=[]},i.collisions=function(a){var m=a.pairs,f=a.bodies,x=f.length,v=i.canCollide,r=l.collides,h=a.collisions,c=0,d,S;for(f.sort(i._compareBoundsX),d=0;d<x;d++){var B=f[d],U=B.bounds,_=B.bounds.max.x,y=B.bounds.max.y,w=B.bounds.min.y,M=B.isStatic||B.isSleeping,T=B.parts.length,I=T===1;for(S=d+1;S<x;S++){var A=f[S],L=A.bounds;if(L.min.x>_)break;if(!(y<L.min.y||w>L.max.y)&&!(M&&(A.isStatic||A.isSleeping))&&v(B.collisionFilter,A.collisionFilter)){var D=A.parts.length;if(I&&D===1){var K=r(B,A,m);K&&(h[c++]=K)}else for(var X=T>1?1:0,Z=D>1?1:0,et=X;et<T;et++)for(var Q=B.parts[et],U=Q.bounds,at=Z;at<D;at++){var vt=A.parts[at],L=vt.bounds;if(!(U.min.x>L.max.x||U.max.x<L.min.x||U.max.y<L.min.y||U.min.y>L.max.y)){var K=r(Q,vt,m);K&&(h[c++]=K)}}}}}return h.length!==c&&(h.length=c),h},i.canCollide=function(a,m){return a.group===m.group&&a.group!==0?a.group>0:(a.mask&m.category)!==0&&(m.mask&a.category)!==0},i._compareBoundsX=function(a,m){return a.bounds.min.x-m.bounds.min.x}})()},function(s,C,p){var i={};s.exports=i;var u=p(0);(function(){i.create=function(l){var a={};return l||u.log("Mouse.create: element was undefined, defaulting to document.body","warn"),a.element=l||document.body,a.absolute={x:0,y:0},a.position={x:0,y:0},a.mousedownPosition={x:0,y:0},a.mouseupPosition={x:0,y:0},a.offset={x:0,y:0},a.scale={x:1,y:1},a.wheelDelta=0,a.button=-1,a.pixelRatio=parseInt(a.element.getAttribute("data-pixel-ratio"),10)||1,a.sourceEvents={mousemove:null,mousedown:null,mouseup:null,mousewheel:null},a.mousemove=function(m){var f=i._getRelativeMousePosition(m,a.element,a.pixelRatio),x=m.changedTouches;x&&(a.button=0,m.preventDefault()),a.absolute.x=f.x,a.absolute.y=f.y,a.position.x=a.absolute.x*a.scale.x+a.offset.x,a.position.y=a.absolute.y*a.scale.y+a.offset.y,a.sourceEvents.mousemove=m},a.mousedown=function(m){var f=i._getRelativeMousePosition(m,a.element,a.pixelRatio),x=m.changedTouches;x?(a.button=0,m.preventDefault()):a.button=m.button,a.absolute.x=f.x,a.absolute.y=f.y,a.position.x=a.absolute.x*a.scale.x+a.offset.x,a.position.y=a.absolute.y*a.scale.y+a.offset.y,a.mousedownPosition.x=a.position.x,a.mousedownPosition.y=a.position.y,a.sourceEvents.mousedown=m},a.mouseup=function(m){var f=i._getRelativeMousePosition(m,a.element,a.pixelRatio),x=m.changedTouches;x&&m.preventDefault(),a.button=-1,a.absolute.x=f.x,a.absolute.y=f.y,a.position.x=a.absolute.x*a.scale.x+a.offset.x,a.position.y=a.absolute.y*a.scale.y+a.offset.y,a.mouseupPosition.x=a.position.x,a.mouseupPosition.y=a.position.y,a.sourceEvents.mouseup=m},a.mousewheel=function(m){a.wheelDelta=Math.max(-1,Math.min(1,m.wheelDelta||-m.detail)),m.preventDefault(),a.sourceEvents.mousewheel=m},i.setElement(a,a.element),a},i.setElement=function(l,a){l.element=a,a.addEventListener("mousemove",l.mousemove,{passive:!0}),a.addEventListener("mousedown",l.mousedown,{passive:!0}),a.addEventListener("mouseup",l.mouseup,{passive:!0}),a.addEventListener("wheel",l.mousewheel,{passive:!1}),a.addEventListener("touchmove",l.mousemove,{passive:!1}),a.addEventListener("touchstart",l.mousedown,{passive:!1}),a.addEventListener("touchend",l.mouseup,{passive:!1})},i.clearSourceEvents=function(l){l.sourceEvents.mousemove=null,l.sourceEvents.mousedown=null,l.sourceEvents.mouseup=null,l.sourceEvents.mousewheel=null,l.wheelDelta=0},i.setOffset=function(l,a){l.offset.x=a.x,l.offset.y=a.y,l.position.x=l.absolute.x*l.scale.x+l.offset.x,l.position.y=l.absolute.y*l.scale.y+l.offset.y},i.setScale=function(l,a){l.scale.x=a.x,l.scale.y=a.y,l.position.x=l.absolute.x*l.scale.x+l.offset.x,l.position.y=l.absolute.y*l.scale.y+l.offset.y},i._getRelativeMousePosition=function(l,a,m){var f=a.getBoundingClientRect(),x=document.documentElement||document.body.parentNode||document.body,v=window.pageXOffset!==void 0?window.pageXOffset:x.scrollLeft,r=window.pageYOffset!==void 0?window.pageYOffset:x.scrollTop,h=l.changedTouches,c,d;return h?(c=h[0].pageX-f.left-v,d=h[0].pageY-f.top-r):(c=l.pageX-f.left-v,d=l.pageY-f.top-r),{x:c/(a.clientWidth/(a.width||a.clientWidth)*m),y:d/(a.clientHeight/(a.height||a.clientHeight)*m)}}})()},function(s,C,p){var i={};s.exports=i;var u=p(0);(function(){i._registry={},i.register=function(l){if(i.isPlugin(l)||u.warn("Plugin.register:",i.toString(l),"does not implement all required fields."),l.name in i._registry){var a=i._registry[l.name],m=i.versionParse(l.version).number,f=i.versionParse(a.version).number;m>f?(u.warn("Plugin.register:",i.toString(a),"was upgraded to",i.toString(l)),i._registry[l.name]=l):m<f?u.warn("Plugin.register:",i.toString(a),"can not be downgraded to",i.toString(l)):l!==a&&u.warn("Plugin.register:",i.toString(l),"is already registered to different plugin object")}else i._registry[l.name]=l;return l},i.resolve=function(l){return i._registry[i.dependencyParse(l).name]},i.toString=function(l){return typeof l=="string"?l:(l.name||"anonymous")+"@"+(l.version||l.range||"0.0.0")},i.isPlugin=function(l){return l&&l.name&&l.version&&l.install},i.isUsed=function(l,a){return l.used.indexOf(a)>-1},i.isFor=function(l,a){var m=l.for&&i.dependencyParse(l.for);return!l.for||a.name===m.name&&i.versionSatisfies(a.version,m.range)},i.use=function(l,a){if(l.uses=(l.uses||[]).concat(a||[]),l.uses.length===0){u.warn("Plugin.use:",i.toString(l),"does not specify any dependencies to install.");return}for(var m=i.dependencies(l),f=u.topologicalSort(m),x=[],v=0;v<f.length;v+=1)if(f[v]!==l.name){var r=i.resolve(f[v]);if(!r){x.push("❌ "+f[v]);continue}i.isUsed(l,r.name)||(i.isFor(r,l)||(u.warn("Plugin.use:",i.toString(r),"is for",r.for,"but installed on",i.toString(l)+"."),r._warned=!0),r.install?r.install(l):(u.warn("Plugin.use:",i.toString(r),"does not specify an install function."),r._warned=!0),r._warned?(x.push("🔶 "+i.toString(r)),delete r._warned):x.push("✅ "+i.toString(r)),l.used.push(r.name))}x.length>0&&u.info(x.join("  "))},i.dependencies=function(l,a){var m=i.dependencyParse(l),f=m.name;if(a=a||{},!(f in a)){l=i.resolve(l)||l,a[f]=u.map(l.uses||[],function(v){i.isPlugin(v)&&i.register(v);var r=i.dependencyParse(v),h=i.resolve(v);return h&&!i.versionSatisfies(h.version,r.range)?(u.warn("Plugin.dependencies:",i.toString(h),"does not satisfy",i.toString(r),"used by",i.toString(m)+"."),h._warned=!0,l._warned=!0):h||(u.warn("Plugin.dependencies:",i.toString(v),"used by",i.toString(m),"could not be resolved."),l._warned=!0),r.name});for(var x=0;x<a[f].length;x+=1)i.dependencies(a[f][x],a);return a}},i.dependencyParse=function(l){if(u.isString(l)){var a=/^[\w-]+(@(\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-+]+)?))?$/;return a.test(l)||u.warn("Plugin.dependencyParse:",l,"is not a valid dependency string."),{name:l.split("@")[0],range:l.split("@")[1]||"*"}}return{name:l.name,range:l.range||l.version}},i.versionParse=function(l){var a=/^(\*)|(\^|~|>=|>)?\s*((\d+)\.(\d+)\.(\d+))(-[0-9A-Za-z-+]+)?$/;a.test(l)||u.warn("Plugin.versionParse:",l,"is not a valid version or range.");var m=a.exec(l),f=Number(m[4]),x=Number(m[5]),v=Number(m[6]);return{isRange:!!(m[1]||m[2]),version:m[3],range:l,operator:m[1]||m[2]||"",major:f,minor:x,patch:v,parts:[f,x,v],prerelease:m[7],number:f*1e8+x*1e4+v}},i.versionSatisfies=function(l,a){a=a||"*";var m=i.versionParse(a),f=i.versionParse(l);if(m.isRange){if(m.operator==="*"||l==="*")return!0;if(m.operator===">")return f.number>m.number;if(m.operator===">=")return f.number>=m.number;if(m.operator==="~")return f.major===m.major&&f.minor===m.minor&&f.patch>=m.patch;if(m.operator==="^")return m.major>0?f.major===m.major&&f.number>=m.number:m.minor>0?f.minor===m.minor&&f.patch>=m.patch:f.patch===m.patch}return l===a||l==="*"}})()},function(s,C){var p={};s.exports=p,function(){p.create=function(i){return{vertex:i,normalImpulse:0,tangentImpulse:0}}}()},function(s,C,p){var i={};s.exports=i;var u=p(7),l=p(18),a=p(13),m=p(19),f=p(5),x=p(6),v=p(10),r=p(0),h=p(4);(function(){i._deltaMax=1e3/60,i.create=function(c){c=c||{};var d={positionIterations:6,velocityIterations:4,constraintIterations:2,enableSleeping:!1,events:[],plugin:{},gravity:{x:0,y:1,scale:.001},timing:{timestamp:0,timeScale:1,lastDelta:0,lastElapsed:0,lastUpdatesPerFrame:0}},S=r.extend(d,c);return S.world=c.world||x.create({label:"World"}),S.pairs=c.pairs||m.create(),S.detector=c.detector||a.create(),S.detector.pairs=S.pairs,S.grid={buckets:[]},S.world.gravity=S.gravity,S.broadphase=S.grid,S.metrics={},S},i.update=function(c,d){var S=r.now(),B=c.world,U=c.detector,_=c.pairs,y=c.timing,w=y.timestamp,M;d>i._deltaMax&&r.warnOnce("Matter.Engine.update: delta argument is recommended to be less than or equal to",i._deltaMax.toFixed(3),"ms."),d=typeof d<"u"?d:r._baseDelta,d*=y.timeScale,y.timestamp+=d,y.lastDelta=d;var T={timestamp:y.timestamp,delta:d};f.trigger(c,"beforeUpdate",T);var I=x.allBodies(B),A=x.allConstraints(B);for(B.isModified&&(a.setBodies(U,I),x.setModified(B,!1,!1,!0)),c.enableSleeping&&u.update(I,d),i._bodiesApplyGravity(I,c.gravity),d>0&&i._bodiesUpdate(I,d),f.trigger(c,"beforeSolve",T),v.preSolveAll(I),M=0;M<c.constraintIterations;M++)v.solveAll(A,d);v.postSolveAll(I);var L=a.collisions(U);m.update(_,L,w),c.enableSleeping&&u.afterCollisions(_.list),_.collisionStart.length>0&&f.trigger(c,"collisionStart",{pairs:_.collisionStart,timestamp:y.timestamp,delta:d});var D=r.clamp(20/c.positionIterations,0,1);for(l.preSolvePosition(_.list),M=0;M<c.positionIterations;M++)l.solvePosition(_.list,d,D);for(l.postSolvePosition(I),v.preSolveAll(I),M=0;M<c.constraintIterations;M++)v.solveAll(A,d);for(v.postSolveAll(I),l.preSolveVelocity(_.list),M=0;M<c.velocityIterations;M++)l.solveVelocity(_.list,d);return i._bodiesUpdateVelocities(I),_.collisionActive.length>0&&f.trigger(c,"collisionActive",{pairs:_.collisionActive,timestamp:y.timestamp,delta:d}),_.collisionEnd.length>0&&f.trigger(c,"collisionEnd",{pairs:_.collisionEnd,timestamp:y.timestamp,delta:d}),i._bodiesClearForces(I),f.trigger(c,"afterUpdate",T),c.timing.lastElapsed=r.now()-S,c},i.merge=function(c,d){if(r.extend(c,d),d.world){c.world=d.world,i.clear(c);for(var S=x.allBodies(c.world),B=0;B<S.length;B++){var U=S[B];u.set(U,!1),U.id=r.nextId()}}},i.clear=function(c){m.clear(c.pairs),a.clear(c.detector)},i._bodiesClearForces=function(c){for(var d=c.length,S=0;S<d;S++){var B=c[S];B.force.x=0,B.force.y=0,B.torque=0}},i._bodiesApplyGravity=function(c,d){var S=typeof d.scale<"u"?d.scale:.001,B=c.length;if(!(d.x===0&&d.y===0||S===0))for(var U=0;U<B;U++){var _=c[U];_.isStatic||_.isSleeping||(_.force.y+=_.mass*d.y*S,_.force.x+=_.mass*d.x*S)}},i._bodiesUpdate=function(c,d){for(var S=c.length,B=0;B<S;B++){var U=c[B];U.isStatic||U.isSleeping||h.update(U,d)}},i._bodiesUpdateVelocities=function(c){for(var d=c.length,S=0;S<d;S++)h.updateVelocities(c[S])}})()},function(s,C,p){var i={};s.exports=i;var u=p(3),l=p(0),a=p(1);(function(){i._restingThresh=2,i._restingThreshTangent=Math.sqrt(6),i._positionDampen=.9,i._positionWarming=.8,i._frictionNormalMultiplier=5,i._frictionMaxStatic=Number.MAX_VALUE,i.preSolvePosition=function(m){var f,x,v,r=m.length;for(f=0;f<r;f++)x=m[f],x.isActive&&(v=x.contactCount,x.collision.parentA.totalContacts+=v,x.collision.parentB.totalContacts+=v)},i.solvePosition=function(m,f,x){var v,r,h,c,d,S,B,U,_=i._positionDampen*(x||1),y=l.clamp(f/l._baseDelta,0,1),w=m.length;for(v=0;v<w;v++)r=m[v],!(!r.isActive||r.isSensor)&&(h=r.collision,c=h.parentA,d=h.parentB,S=h.normal,r.separation=h.depth+S.x*(d.positionImpulse.x-c.positionImpulse.x)+S.y*(d.positionImpulse.y-c.positionImpulse.y));for(v=0;v<w;v++)r=m[v],!(!r.isActive||r.isSensor)&&(h=r.collision,c=h.parentA,d=h.parentB,S=h.normal,U=r.separation-r.slop*y,(c.isStatic||d.isStatic)&&(U*=2),c.isStatic||c.isSleeping||(B=_/c.totalContacts,c.positionImpulse.x+=S.x*U*B,c.positionImpulse.y+=S.y*U*B),d.isStatic||d.isSleeping||(B=_/d.totalContacts,d.positionImpulse.x-=S.x*U*B,d.positionImpulse.y-=S.y*U*B))},i.postSolvePosition=function(m){for(var f=i._positionWarming,x=m.length,v=u.translate,r=a.update,h=0;h<x;h++){var c=m[h],d=c.positionImpulse,S=d.x,B=d.y,U=c.velocity;if(c.totalContacts=0,S!==0||B!==0){for(var _=0;_<c.parts.length;_++){var y=c.parts[_];v(y.vertices,d),r(y.bounds,y.vertices,U),y.position.x+=S,y.position.y+=B}c.positionPrev.x+=S,c.positionPrev.y+=B,S*U.x+B*U.y<0?(d.x=0,d.y=0):(d.x*=f,d.y*=f)}}},i.preSolveVelocity=function(m){var f=m.length,x,v;for(x=0;x<f;x++){var r=m[x];if(!(!r.isActive||r.isSensor)){var h=r.contacts,c=r.contactCount,d=r.collision,S=d.parentA,B=d.parentB,U=d.normal,_=d.tangent;for(v=0;v<c;v++){var y=h[v],w=y.vertex,M=y.normalImpulse,T=y.tangentImpulse;if(M!==0||T!==0){var I=U.x*M+_.x*T,A=U.y*M+_.y*T;S.isStatic||S.isSleeping||(S.positionPrev.x+=I*S.inverseMass,S.positionPrev.y+=A*S.inverseMass,S.anglePrev+=S.inverseInertia*((w.x-S.position.x)*A-(w.y-S.position.y)*I)),B.isStatic||B.isSleeping||(B.positionPrev.x-=I*B.inverseMass,B.positionPrev.y-=A*B.inverseMass,B.anglePrev-=B.inverseInertia*((w.x-B.position.x)*A-(w.y-B.position.y)*I))}}}}},i.solveVelocity=function(m,f){var x=f/l._baseDelta,v=x*x,r=v*x,h=-i._restingThresh*x,c=i._restingThreshTangent,d=i._frictionNormalMultiplier*x,S=i._frictionMaxStatic,B=m.length,U,_,y,w;for(y=0;y<B;y++){var M=m[y];if(!(!M.isActive||M.isSensor)){var T=M.collision,I=T.parentA,A=T.parentB,L=T.normal.x,D=T.normal.y,K=T.tangent.x,X=T.tangent.y,Z=M.inverseMass,et=M.friction*M.frictionStatic*d,Q=M.contacts,at=M.contactCount,vt=1/at,_t=I.position.x-I.positionPrev.x,Ct=I.position.y-I.positionPrev.y,kt=I.angle-I.anglePrev,ut=A.position.x-A.positionPrev.x,fe=A.position.y-A.positionPrev.y,Wt=A.angle-A.anglePrev;for(w=0;w<at;w++){var ft=Q[w],$t=ft.vertex,Pt=$t.x-I.position.x,re=$t.y-I.position.y,Xt=$t.x-A.position.x,Vt=$t.y-A.position.y,It=_t-re*kt,Rn=Ct+Pt*kt,te=ut-Vt*Wt,He=fe+Xt*Wt,On=It-te,se=Rn-He,rn=L*On+D*se,ce=K*On+X*se,he=M.separation+rn,Nt=Math.min(he,1);Nt=he<0?0:Nt;var ge=Nt*et;ce<-ge||ce>ge?(_=ce>0?ce:-ce,U=M.friction*(ce>0?1:-1)*r,U<-_?U=-_:U>_&&(U=_)):(U=ce,_=S);var Zt=Pt*D-re*L,Cn=Xt*D-Vt*L,Be=vt/(Z+I.inverseInertia*Zt*Zt+A.inverseInertia*Cn*Cn),sn=(1+M.restitution)*rn*Be;if(U*=Be,rn<h)ft.normalImpulse=0;else{var Ke=ft.normalImpulse;ft.normalImpulse+=sn,ft.normalImpulse>0&&(ft.normalImpulse=0),sn=ft.normalImpulse-Ke}if(ce<-c||ce>c)ft.tangentImpulse=0;else{var pe=ft.tangentImpulse;ft.tangentImpulse+=U,ft.tangentImpulse<-_&&(ft.tangentImpulse=-_),ft.tangentImpulse>_&&(ft.tangentImpulse=_),U=ft.tangentImpulse-pe}var Ae=L*sn+K*U,Ue=D*sn+X*U;I.isStatic||I.isSleeping||(I.positionPrev.x+=Ae*I.inverseMass,I.positionPrev.y+=Ue*I.inverseMass,I.anglePrev+=(Pt*Ue-re*Ae)*I.inverseInertia),A.isStatic||A.isSleeping||(A.positionPrev.x-=Ae*A.inverseMass,A.positionPrev.y-=Ue*A.inverseMass,A.anglePrev-=(Xt*Ue-Vt*Ae)*A.inverseInertia)}}}}})()},function(s,C,p){var i={};s.exports=i;var u=p(9),l=p(0);(function(){i.create=function(a){return l.extend({table:{},list:[],collisionStart:[],collisionActive:[],collisionEnd:[]},a)},i.update=function(a,m,f){var x=u.update,v=u.create,r=u.setActive,h=a.table,c=a.list,d=c.length,S=d,B=a.collisionStart,U=a.collisionEnd,_=a.collisionActive,y=m.length,w=0,M=0,T=0,I,A,L;for(L=0;L<y;L++)I=m[L],A=I.pair,A?(A.isActive&&(_[T++]=A),x(A,I,f)):(A=v(I,f),h[A.id]=A,B[w++]=A,c[S++]=A);for(S=0,d=c.length,L=0;L<d;L++)A=c[L],A.timeUpdated>=f?c[S++]=A:(r(A,!1,f),A.collision.bodyA.sleepCounter>0&&A.collision.bodyB.sleepCounter>0?c[S++]=A:(U[M++]=A,delete h[A.id]));c.length!==S&&(c.length=S),B.length!==w&&(B.length=w),U.length!==M&&(U.length=M),_.length!==T&&(_.length=T)},i.clear=function(a){return a.table={},a.list.length=0,a.collisionStart.length=0,a.collisionActive.length=0,a.collisionEnd.length=0,a}})()},function(s,C,p){var i=s.exports=p(21);i.Axes=p(11),i.Bodies=p(12),i.Body=p(4),i.Bounds=p(1),i.Collision=p(8),i.Common=p(0),i.Composite=p(6),i.Composites=p(22),i.Constraint=p(10),i.Contact=p(16),i.Detector=p(13),i.Engine=p(17),i.Events=p(5),i.Grid=p(23),i.Mouse=p(14),i.MouseConstraint=p(24),i.Pair=p(9),i.Pairs=p(19),i.Plugin=p(15),i.Query=p(25),i.Render=p(26),i.Resolver=p(18),i.Runner=p(27),i.SAT=p(28),i.Sleeping=p(7),i.Svg=p(29),i.Vector=p(2),i.Vertices=p(3),i.World=p(30),i.Engine.run=i.Runner.run,i.Common.deprecated(i.Engine,"run","Engine.run ➤ use Matter.Runner.run(engine) instead")},function(s,C,p){var i={};s.exports=i;var u=p(15),l=p(0);(function(){i.name="matter-js",i.version="0.20.0",i.uses=[],i.used=[],i.use=function(){u.use(i,Array.prototype.slice.call(arguments))},i.before=function(a,m){return a=a.replace(/^Matter./,""),l.chainPathBefore(i,a,m)},i.after=function(a,m){return a=a.replace(/^Matter./,""),l.chainPathAfter(i,a,m)}})()},function(s,C,p){var i={};s.exports=i;var u=p(6),l=p(10),a=p(0),m=p(4),f=p(12),x=a.deprecated;(function(){i.stack=function(v,r,h,c,d,S,B){for(var U=u.create({label:"Stack"}),_=v,y=r,w,M=0,T=0;T<c;T++){for(var I=0,A=0;A<h;A++){var L=B(_,y,A,T,w,M);if(L){var D=L.bounds.max.y-L.bounds.min.y,K=L.bounds.max.x-L.bounds.min.x;D>I&&(I=D),m.translate(L,{x:K*.5,y:D*.5}),_=L.bounds.max.x+d,u.addBody(U,L),w=L,M+=1}else _+=d}y+=I+S,_=v}return U},i.chain=function(v,r,h,c,d,S){for(var B=v.bodies,U=1;U<B.length;U++){var _=B[U-1],y=B[U],w=_.bounds.max.y-_.bounds.min.y,M=_.bounds.max.x-_.bounds.min.x,T=y.bounds.max.y-y.bounds.min.y,I=y.bounds.max.x-y.bounds.min.x,A={bodyA:_,pointA:{x:M*r,y:w*h},bodyB:y,pointB:{x:I*c,y:T*d}},L=a.extend(A,S);u.addConstraint(v,l.create(L))}return v.label+=" Chain",v},i.mesh=function(v,r,h,c,d){var S=v.bodies,B,U,_,y,w;for(B=0;B<h;B++){for(U=1;U<r;U++)_=S[U-1+B*r],y=S[U+B*r],u.addConstraint(v,l.create(a.extend({bodyA:_,bodyB:y},d)));if(B>0)for(U=0;U<r;U++)_=S[U+(B-1)*r],y=S[U+B*r],u.addConstraint(v,l.create(a.extend({bodyA:_,bodyB:y},d))),c&&U>0&&(w=S[U-1+(B-1)*r],u.addConstraint(v,l.create(a.extend({bodyA:w,bodyB:y},d)))),c&&U<r-1&&(w=S[U+1+(B-1)*r],u.addConstraint(v,l.create(a.extend({bodyA:w,bodyB:y},d))))}return v.label+=" Mesh",v},i.pyramid=function(v,r,h,c,d,S,B){return i.stack(v,r,h,c,d,S,function(U,_,y,w,M,T){var I=Math.min(c,Math.ceil(h/2)),A=M?M.bounds.max.x-M.bounds.min.x:0;if(!(w>I)){w=I-w;var L=w,D=h-1-w;if(!(y<L||y>D)){T===1&&m.translate(M,{x:(y+(h%2===1?1:-1))*A,y:0});var K=M?y*A:0;return B(v+K+y*d,_,y,w,M,T)}}})},i.newtonsCradle=function(v,r,h,c,d){for(var S=u.create({label:"Newtons Cradle"}),B=0;B<h;B++){var U=1.9,_=f.circle(v+B*(c*U),r+d,c,{inertia:1/0,restitution:1,friction:0,frictionAir:1e-4,slop:1}),y=l.create({pointA:{x:v+B*(c*U),y:r},bodyB:_});u.addBody(S,_),u.addConstraint(S,y)}return S},x(i,"newtonsCradle","Composites.newtonsCradle ➤ moved to newtonsCradle example"),i.car=function(v,r,h,c,d){var S=m.nextGroup(!0),B=20,U=-h*.5+B,_=h*.5-B,y=0,w=u.create({label:"Car"}),M=f.rectangle(v,r,h,c,{collisionFilter:{group:S},chamfer:{radius:c*.5},density:2e-4}),T=f.circle(v+U,r+y,d,{collisionFilter:{group:S},friction:.8}),I=f.circle(v+_,r+y,d,{collisionFilter:{group:S},friction:.8}),A=l.create({bodyB:M,pointB:{x:U,y},bodyA:T,stiffness:1,length:0}),L=l.create({bodyB:M,pointB:{x:_,y},bodyA:I,stiffness:1,length:0});return u.addBody(w,M),u.addBody(w,T),u.addBody(w,I),u.addConstraint(w,A),u.addConstraint(w,L),w},x(i,"car","Composites.car ➤ moved to car example"),i.softBody=function(v,r,h,c,d,S,B,U,_,y){_=a.extend({inertia:1/0},_),y=a.extend({stiffness:.2,render:{type:"line",anchors:!1}},y);var w=i.stack(v,r,h,c,d,S,function(M,T){return f.circle(M,T,U,_)});return i.mesh(w,h,c,B,y),w.label="Soft Body",w},x(i,"softBody","Composites.softBody ➤ moved to softBody and cloth examples")})()},function(s,C,p){var i={};s.exports=i;var u=p(9),l=p(0),a=l.deprecated;(function(){i.create=function(m){var f={buckets:{},pairs:{},pairsList:[],bucketWidth:48,bucketHeight:48};return l.extend(f,m)},i.update=function(m,f,x,v){var r,h,c,d=x.world,S=m.buckets,B,U,_=!1;for(r=0;r<f.length;r++){var y=f[r];if(!(y.isSleeping&&!v)&&!(d.bounds&&(y.bounds.max.x<d.bounds.min.x||y.bounds.min.x>d.bounds.max.x||y.bounds.max.y<d.bounds.min.y||y.bounds.min.y>d.bounds.max.y))){var w=i._getRegion(m,y);if(!y.region||w.id!==y.region.id||v){(!y.region||v)&&(y.region=w);var M=i._regionUnion(w,y.region);for(h=M.startCol;h<=M.endCol;h++)for(c=M.startRow;c<=M.endRow;c++){U=i._getBucketId(h,c),B=S[U];var T=h>=w.startCol&&h<=w.endCol&&c>=w.startRow&&c<=w.endRow,I=h>=y.region.startCol&&h<=y.region.endCol&&c>=y.region.startRow&&c<=y.region.endRow;!T&&I&&I&&B&&i._bucketRemoveBody(m,B,y),(y.region===w||T&&!I||v)&&(B||(B=i._createBucket(S,U)),i._bucketAddBody(m,B,y))}y.region=w,_=!0}}}_&&(m.pairsList=i._createActivePairsList(m))},a(i,"update","Grid.update ➤ replaced by Matter.Detector"),i.clear=function(m){m.buckets={},m.pairs={},m.pairsList=[]},a(i,"clear","Grid.clear ➤ replaced by Matter.Detector"),i._regionUnion=function(m,f){var x=Math.min(m.startCol,f.startCol),v=Math.max(m.endCol,f.endCol),r=Math.min(m.startRow,f.startRow),h=Math.max(m.endRow,f.endRow);return i._createRegion(x,v,r,h)},i._getRegion=function(m,f){var x=f.bounds,v=Math.floor(x.min.x/m.bucketWidth),r=Math.floor(x.max.x/m.bucketWidth),h=Math.floor(x.min.y/m.bucketHeight),c=Math.floor(x.max.y/m.bucketHeight);return i._createRegion(v,r,h,c)},i._createRegion=function(m,f,x,v){return{id:m+","+f+","+x+","+v,startCol:m,endCol:f,startRow:x,endRow:v}},i._getBucketId=function(m,f){return"C"+m+"R"+f},i._createBucket=function(m,f){var x=m[f]=[];return x},i._bucketAddBody=function(m,f,x){var v=m.pairs,r=u.id,h=f.length,c;for(c=0;c<h;c++){var d=f[c];if(!(x.id===d.id||x.isStatic&&d.isStatic)){var S=r(x,d),B=v[S];B?B[2]+=1:v[S]=[x,d,1]}}f.push(x)},i._bucketRemoveBody=function(m,f,x){var v=m.pairs,r=u.id,h;f.splice(l.indexOf(f,x),1);var c=f.length;for(h=0;h<c;h++){var d=v[r(x,f[h])];d&&(d[2]-=1)}},i._createActivePairsList=function(m){var f,x=m.pairs,v=l.keys(x),r=v.length,h=[],c;for(c=0;c<r;c++)f=x[v[c]],f[2]>0?h.push(f):delete x[v[c]];return h}})()},function(s,C,p){var i={};s.exports=i;var u=p(3),l=p(7),a=p(14),m=p(5),f=p(13),x=p(10),v=p(6),r=p(0),h=p(1);(function(){i.create=function(c,d){var S=(c?c.mouse:null)||(d?d.mouse:null);S||(c&&c.render&&c.render.canvas?S=a.create(c.render.canvas):d&&d.element?S=a.create(d.element):(S=a.create(),r.warn("MouseConstraint.create: options.mouse was undefined, options.element was undefined, may not function as expected")));var B=x.create({label:"Mouse Constraint",pointA:S.position,pointB:{x:0,y:0},length:.01,stiffness:.1,angularStiffness:1,render:{strokeStyle:"#90EE90",lineWidth:3}}),U={type:"mouseConstraint",mouse:S,element:null,body:null,constraint:B,collisionFilter:{category:1,mask:4294967295,group:0}},_=r.extend(U,d);return m.on(c,"beforeUpdate",function(){var y=v.allBodies(c.world);i.update(_,y),i._triggerEvents(_)}),_},i.update=function(c,d){var S=c.mouse,B=c.constraint,U=c.body;if(S.button===0){if(B.bodyB)l.set(B.bodyB,!1),B.pointA=S.position;else for(var _=0;_<d.length;_++)if(U=d[_],h.contains(U.bounds,S.position)&&f.canCollide(U.collisionFilter,c.collisionFilter))for(var y=U.parts.length>1?1:0;y<U.parts.length;y++){var w=U.parts[y];if(u.contains(w.vertices,S.position)){B.pointA=S.position,B.bodyB=c.body=U,B.pointB={x:S.position.x-U.position.x,y:S.position.y-U.position.y},B.angleB=U.angle,l.set(U,!1),m.trigger(c,"startdrag",{mouse:S,body:U});break}}}else B.bodyB=c.body=null,B.pointB=null,U&&m.trigger(c,"enddrag",{mouse:S,body:U})},i._triggerEvents=function(c){var d=c.mouse,S=d.sourceEvents;S.mousemove&&m.trigger(c,"mousemove",{mouse:d}),S.mousedown&&m.trigger(c,"mousedown",{mouse:d}),S.mouseup&&m.trigger(c,"mouseup",{mouse:d}),a.clearSourceEvents(d)}})()},function(s,C,p){var i={};s.exports=i;var u=p(2),l=p(8),a=p(1),m=p(12),f=p(3);(function(){i.collides=function(x,v){for(var r=[],h=v.length,c=x.bounds,d=l.collides,S=a.overlaps,B=0;B<h;B++){var U=v[B],_=U.parts.length,y=_===1?0:1;if(S(U.bounds,c))for(var w=y;w<_;w++){var M=U.parts[w];if(S(M.bounds,c)){var T=d(M,x);if(T){r.push(T);break}}}}return r},i.ray=function(x,v,r,h){h=h||1e-100;for(var c=u.angle(v,r),d=u.magnitude(u.sub(v,r)),S=(r.x+v.x)*.5,B=(r.y+v.y)*.5,U=m.rectangle(S,B,d,h,{angle:c}),_=i.collides(U,x),y=0;y<_.length;y+=1){var w=_[y];w.body=w.bodyB=w.bodyA}return _},i.region=function(x,v,r){for(var h=[],c=0;c<x.length;c++){var d=x[c],S=a.overlaps(d.bounds,v);(S&&!r||!S&&r)&&h.push(d)}return h},i.point=function(x,v){for(var r=[],h=0;h<x.length;h++){var c=x[h];if(a.contains(c.bounds,v))for(var d=c.parts.length===1?0:1;d<c.parts.length;d++){var S=c.parts[d];if(a.contains(S.bounds,v)&&f.contains(S.vertices,v)){r.push(c);break}}}return r}})()},function(s,C,p){var i={};s.exports=i;var u=p(4),l=p(0),a=p(6),m=p(1),f=p(5),x=p(2),v=p(14);(function(){var r,h;typeof window<"u"&&(r=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(y){window.setTimeout(function(){y(l.now())},1e3/60)},h=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),i._goodFps=30,i._goodDelta=1e3/60,i.create=function(y){var w={engine:null,element:null,canvas:null,mouse:null,frameRequestId:null,timing:{historySize:60,delta:0,deltaHistory:[],lastTime:0,lastTimestamp:0,lastElapsed:0,timestampElapsed:0,timestampElapsedHistory:[],engineDeltaHistory:[],engineElapsedHistory:[],engineUpdatesHistory:[],elapsedHistory:[]},options:{width:800,height:600,pixelRatio:1,background:"#14151f",wireframeBackground:"#14151f",wireframeStrokeStyle:"#bbb",hasBounds:!!y.bounds,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showStats:!1,showPerformance:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showSeparations:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showVertexNumbers:!1,showConvexHulls:!1,showInternalEdges:!1,showMousePosition:!1}},M=l.extend(w,y);return M.canvas&&(M.canvas.width=M.options.width||M.canvas.width,M.canvas.height=M.options.height||M.canvas.height),M.mouse=y.mouse,M.engine=y.engine,M.canvas=M.canvas||S(M.options.width,M.options.height),M.context=M.canvas.getContext("2d"),M.textures={},M.bounds=M.bounds||{min:{x:0,y:0},max:{x:M.canvas.width,y:M.canvas.height}},M.controller=i,M.options.showBroadphase=!1,M.options.pixelRatio!==1&&i.setPixelRatio(M,M.options.pixelRatio),l.isElement(M.element)&&M.element.appendChild(M.canvas),M},i.run=function(y){(function w(M){y.frameRequestId=r(w),c(y,M),i.world(y,M),y.context.setTransform(y.options.pixelRatio,0,0,y.options.pixelRatio,0,0),(y.options.showStats||y.options.showDebug)&&i.stats(y,y.context,M),(y.options.showPerformance||y.options.showDebug)&&i.performance(y,y.context,M),y.context.setTransform(1,0,0,1,0,0)})()},i.stop=function(y){h(y.frameRequestId)},i.setPixelRatio=function(y,w){var M=y.options,T=y.canvas;w==="auto"&&(w=B(T)),M.pixelRatio=w,T.setAttribute("data-pixel-ratio",w),T.width=M.width*w,T.height=M.height*w,T.style.width=M.width+"px",T.style.height=M.height+"px"},i.setSize=function(y,w,M){y.options.width=w,y.options.height=M,y.bounds.max.x=y.bounds.min.x+w,y.bounds.max.y=y.bounds.min.y+M,y.options.pixelRatio!==1?i.setPixelRatio(y,y.options.pixelRatio):(y.canvas.width=w,y.canvas.height=M)},i.lookAt=function(y,w,M,T){T=typeof T<"u"?T:!0,w=l.isArray(w)?w:[w],M=M||{x:0,y:0};for(var I={min:{x:1/0,y:1/0},max:{x:-1/0,y:-1/0}},A=0;A<w.length;A+=1){var L=w[A],D=L.bounds?L.bounds.min:L.min||L.position||L,K=L.bounds?L.bounds.max:L.max||L.position||L;D&&K&&(D.x<I.min.x&&(I.min.x=D.x),K.x>I.max.x&&(I.max.x=K.x),D.y<I.min.y&&(I.min.y=D.y),K.y>I.max.y&&(I.max.y=K.y))}var X=I.max.x-I.min.x+2*M.x,Z=I.max.y-I.min.y+2*M.y,et=y.canvas.height,Q=y.canvas.width,at=Q/et,vt=X/Z,_t=1,Ct=1;vt>at?Ct=vt/at:_t=at/vt,y.options.hasBounds=!0,y.bounds.min.x=I.min.x,y.bounds.max.x=I.min.x+X*_t,y.bounds.min.y=I.min.y,y.bounds.max.y=I.min.y+Z*Ct,T&&(y.bounds.min.x+=X*.5-X*_t*.5,y.bounds.max.x+=X*.5-X*_t*.5,y.bounds.min.y+=Z*.5-Z*Ct*.5,y.bounds.max.y+=Z*.5-Z*Ct*.5),y.bounds.min.x-=M.x,y.bounds.max.x-=M.x,y.bounds.min.y-=M.y,y.bounds.max.y-=M.y,y.mouse&&(v.setScale(y.mouse,{x:(y.bounds.max.x-y.bounds.min.x)/y.canvas.width,y:(y.bounds.max.y-y.bounds.min.y)/y.canvas.height}),v.setOffset(y.mouse,y.bounds.min))},i.startViewTransform=function(y){var w=y.bounds.max.x-y.bounds.min.x,M=y.bounds.max.y-y.bounds.min.y,T=w/y.options.width,I=M/y.options.height;y.context.setTransform(y.options.pixelRatio/T,0,0,y.options.pixelRatio/I,0,0),y.context.translate(-y.bounds.min.x,-y.bounds.min.y)},i.endViewTransform=function(y){y.context.setTransform(y.options.pixelRatio,0,0,y.options.pixelRatio,0,0)},i.world=function(y,w){var M=l.now(),T=y.engine,I=T.world,A=y.canvas,L=y.context,D=y.options,K=y.timing,X=a.allBodies(I),Z=a.allConstraints(I),et=D.wireframes?D.wireframeBackground:D.background,Q=[],at=[],vt,_t={timestamp:T.timing.timestamp};if(f.trigger(y,"beforeRender",_t),y.currentBackground!==et&&_(y,et),L.globalCompositeOperation="source-in",L.fillStyle="transparent",L.fillRect(0,0,A.width,A.height),L.globalCompositeOperation="source-over",D.hasBounds){for(vt=0;vt<X.length;vt++){var Ct=X[vt];m.overlaps(Ct.bounds,y.bounds)&&Q.push(Ct)}for(vt=0;vt<Z.length;vt++){var kt=Z[vt],ut=kt.bodyA,fe=kt.bodyB,Wt=kt.pointA,ft=kt.pointB;ut&&(Wt=x.add(ut.position,kt.pointA)),fe&&(ft=x.add(fe.position,kt.pointB)),!(!Wt||!ft)&&(m.contains(y.bounds,Wt)||m.contains(y.bounds,ft))&&at.push(kt)}i.startViewTransform(y),y.mouse&&(v.setScale(y.mouse,{x:(y.bounds.max.x-y.bounds.min.x)/y.options.width,y:(y.bounds.max.y-y.bounds.min.y)/y.options.height}),v.setOffset(y.mouse,y.bounds.min))}else at=Z,Q=X,y.options.pixelRatio!==1&&y.context.setTransform(y.options.pixelRatio,0,0,y.options.pixelRatio,0,0);!D.wireframes||T.enableSleeping&&D.showSleeping?i.bodies(y,Q,L):(D.showConvexHulls&&i.bodyConvexHulls(y,Q,L),i.bodyWireframes(y,Q,L)),D.showBounds&&i.bodyBounds(y,Q,L),(D.showAxes||D.showAngleIndicator)&&i.bodyAxes(y,Q,L),D.showPositions&&i.bodyPositions(y,Q,L),D.showVelocity&&i.bodyVelocity(y,Q,L),D.showIds&&i.bodyIds(y,Q,L),D.showSeparations&&i.separations(y,T.pairs.list,L),D.showCollisions&&i.collisions(y,T.pairs.list,L),D.showVertexNumbers&&i.vertexNumbers(y,Q,L),D.showMousePosition&&i.mousePosition(y,y.mouse,L),i.constraints(at,L),D.hasBounds&&i.endViewTransform(y),f.trigger(y,"afterRender",_t),K.lastElapsed=l.now()-M},i.stats=function(y,w,M){for(var T=y.engine,I=T.world,A=a.allBodies(I),L=0,D=55,K=44,X=0,Z=0,et=0;et<A.length;et+=1)L+=A[et].parts.length;var Q={Part:L,Body:A.length,Cons:a.allConstraints(I).length,Comp:a.allComposites(I).length,Pair:T.pairs.list.length};w.fillStyle="#0e0f19",w.fillRect(X,Z,D*5.5,K),w.font="12px Arial",w.textBaseline="top",w.textAlign="right";for(var at in Q){var vt=Q[at];w.fillStyle="#aaa",w.fillText(at,X+D,Z+8),w.fillStyle="#eee",w.fillText(vt,X+D,Z+26),X+=D}},i.performance=function(y,w){var M=y.engine,T=y.timing,I=T.deltaHistory,A=T.elapsedHistory,L=T.timestampElapsedHistory,D=T.engineDeltaHistory,K=T.engineUpdatesHistory,X=T.engineElapsedHistory,Z=M.timing.lastUpdatesPerFrame,et=M.timing.lastDelta,Q=d(I),at=d(A),vt=d(D),_t=d(K),Ct=d(X),kt=d(L),ut=kt/Q||0,fe=Math.round(Q/et),Wt=1e3/Q||0,ft=4,$t=12,Pt=60,re=34,Xt=10,Vt=69;w.fillStyle="#0e0f19",w.fillRect(0,50,$t*5+Pt*6+22,re),i.status(w,Xt,Vt,Pt,ft,I.length,Math.round(Wt)+" fps",Wt/i._goodFps,function(It){return I[It]/Q-1}),i.status(w,Xt+$t+Pt,Vt,Pt,ft,D.length,et.toFixed(2)+" dt",i._goodDelta/et,function(It){return D[It]/vt-1}),i.status(w,Xt+($t+Pt)*2,Vt,Pt,ft,K.length,Z+" upf",Math.pow(l.clamp(_t/fe||1,0,1),4),function(It){return K[It]/_t-1}),i.status(w,Xt+($t+Pt)*3,Vt,Pt,ft,X.length,Ct.toFixed(2)+" ut",1-Z*Ct/i._goodFps,function(It){return X[It]/Ct-1}),i.status(w,Xt+($t+Pt)*4,Vt,Pt,ft,A.length,at.toFixed(2)+" rt",1-at/i._goodFps,function(It){return A[It]/at-1}),i.status(w,Xt+($t+Pt)*5,Vt,Pt,ft,L.length,ut.toFixed(2)+" x",ut*ut*ut,function(It){return(L[It]/I[It]/ut||0)-1})},i.status=function(y,w,M,T,I,A,L,D,K){y.strokeStyle="#888",y.fillStyle="#444",y.lineWidth=1,y.fillRect(w,M+7,T,1),y.beginPath(),y.moveTo(w,M+7-I*l.clamp(.4*K(0),-2,2));for(var X=0;X<T;X+=1)y.lineTo(w+X,M+7-(X<A?I*l.clamp(.4*K(X),-2,2):0));y.stroke(),y.fillStyle="hsl("+l.clamp(25+95*D,0,120)+",100%,60%)",y.fillRect(w,M-7,4,4),y.font="12px Arial",y.textBaseline="middle",y.textAlign="right",y.fillStyle="#eee",y.fillText(L,w+T,M-5)},i.constraints=function(y,w){for(var M=w,T=0;T<y.length;T++){var I=y[T];if(!(!I.render.visible||!I.pointA||!I.pointB)){var A=I.bodyA,L=I.bodyB,D,K;if(A?D=x.add(A.position,I.pointA):D=I.pointA,I.render.type==="pin")M.beginPath(),M.arc(D.x,D.y,3,0,2*Math.PI),M.closePath();else{if(L?K=x.add(L.position,I.pointB):K=I.pointB,M.beginPath(),M.moveTo(D.x,D.y),I.render.type==="spring")for(var X=x.sub(K,D),Z=x.perp(x.normalise(X)),et=Math.ceil(l.clamp(I.length/5,12,20)),Q,at=1;at<et;at+=1)Q=at%2===0?1:-1,M.lineTo(D.x+X.x*(at/et)+Z.x*Q*4,D.y+X.y*(at/et)+Z.y*Q*4);M.lineTo(K.x,K.y)}I.render.lineWidth&&(M.lineWidth=I.render.lineWidth,M.strokeStyle=I.render.strokeStyle,M.stroke()),I.render.anchors&&(M.fillStyle=I.render.strokeStyle,M.beginPath(),M.arc(D.x,D.y,3,0,2*Math.PI),M.arc(K.x,K.y,3,0,2*Math.PI),M.closePath(),M.fill())}}},i.bodies=function(y,w,M){var T=M;y.engine;var I=y.options,A=I.showInternalEdges||!I.wireframes,L,D,K,X;for(K=0;K<w.length;K++)if(L=w[K],!!L.render.visible){for(X=L.parts.length>1?1:0;X<L.parts.length;X++)if(D=L.parts[X],!!D.render.visible){if(I.showSleeping&&L.isSleeping?T.globalAlpha=.5*D.render.opacity:D.render.opacity!==1&&(T.globalAlpha=D.render.opacity),D.render.sprite&&D.render.sprite.texture&&!I.wireframes){var Z=D.render.sprite,et=U(y,Z.texture);T.translate(D.position.x,D.position.y),T.rotate(D.angle),T.drawImage(et,et.width*-Z.xOffset*Z.xScale,et.height*-Z.yOffset*Z.yScale,et.width*Z.xScale,et.height*Z.yScale),T.rotate(-D.angle),T.translate(-D.position.x,-D.position.y)}else{if(D.circleRadius)T.beginPath(),T.arc(D.position.x,D.position.y,D.circleRadius,0,2*Math.PI);else{T.beginPath(),T.moveTo(D.vertices[0].x,D.vertices[0].y);for(var Q=1;Q<D.vertices.length;Q++)!D.vertices[Q-1].isInternal||A?T.lineTo(D.vertices[Q].x,D.vertices[Q].y):T.moveTo(D.vertices[Q].x,D.vertices[Q].y),D.vertices[Q].isInternal&&!A&&T.moveTo(D.vertices[(Q+1)%D.vertices.length].x,D.vertices[(Q+1)%D.vertices.length].y);T.lineTo(D.vertices[0].x,D.vertices[0].y),T.closePath()}I.wireframes?(T.lineWidth=1,T.strokeStyle=y.options.wireframeStrokeStyle,T.stroke()):(T.fillStyle=D.render.fillStyle,D.render.lineWidth&&(T.lineWidth=D.render.lineWidth,T.strokeStyle=D.render.strokeStyle,T.stroke()),T.fill())}T.globalAlpha=1}}},i.bodyWireframes=function(y,w,M){var T=M,I=y.options.showInternalEdges,A,L,D,K,X;for(T.beginPath(),D=0;D<w.length;D++)if(A=w[D],!!A.render.visible)for(X=A.parts.length>1?1:0;X<A.parts.length;X++){for(L=A.parts[X],T.moveTo(L.vertices[0].x,L.vertices[0].y),K=1;K<L.vertices.length;K++)!L.vertices[K-1].isInternal||I?T.lineTo(L.vertices[K].x,L.vertices[K].y):T.moveTo(L.vertices[K].x,L.vertices[K].y),L.vertices[K].isInternal&&!I&&T.moveTo(L.vertices[(K+1)%L.vertices.length].x,L.vertices[(K+1)%L.vertices.length].y);T.lineTo(L.vertices[0].x,L.vertices[0].y)}T.lineWidth=1,T.strokeStyle=y.options.wireframeStrokeStyle,T.stroke()},i.bodyConvexHulls=function(y,w,M){var T=M,I,A,L;for(T.beginPath(),A=0;A<w.length;A++)if(I=w[A],!(!I.render.visible||I.parts.length===1)){for(T.moveTo(I.vertices[0].x,I.vertices[0].y),L=1;L<I.vertices.length;L++)T.lineTo(I.vertices[L].x,I.vertices[L].y);T.lineTo(I.vertices[0].x,I.vertices[0].y)}T.lineWidth=1,T.strokeStyle="rgba(255,255,255,0.2)",T.stroke()},i.vertexNumbers=function(y,w,M){var T=M,I,A,L;for(I=0;I<w.length;I++){var D=w[I].parts;for(L=D.length>1?1:0;L<D.length;L++){var K=D[L];for(A=0;A<K.vertices.length;A++)T.fillStyle="rgba(255,255,255,0.2)",T.fillText(I+"_"+A,K.position.x+(K.vertices[A].x-K.position.x)*.8,K.position.y+(K.vertices[A].y-K.position.y)*.8)}}},i.mousePosition=function(y,w,M){var T=M;T.fillStyle="rgba(255,255,255,0.8)",T.fillText(w.position.x+"  "+w.position.y,w.position.x+5,w.position.y-5)},i.bodyBounds=function(y,w,M){var T=M;y.engine;var I=y.options;T.beginPath();for(var A=0;A<w.length;A++){var L=w[A];if(L.render.visible)for(var D=w[A].parts,K=D.length>1?1:0;K<D.length;K++){var X=D[K];T.rect(X.bounds.min.x,X.bounds.min.y,X.bounds.max.x-X.bounds.min.x,X.bounds.max.y-X.bounds.min.y)}}I.wireframes?T.strokeStyle="rgba(255,255,255,0.08)":T.strokeStyle="rgba(0,0,0,0.1)",T.lineWidth=1,T.stroke()},i.bodyAxes=function(y,w,M){var T=M;y.engine;var I=y.options,A,L,D,K;for(T.beginPath(),L=0;L<w.length;L++){var X=w[L],Z=X.parts;if(X.render.visible)if(I.showAxes)for(D=Z.length>1?1:0;D<Z.length;D++)for(A=Z[D],K=0;K<A.axes.length;K++){var et=A.axes[K];T.moveTo(A.position.x,A.position.y),T.lineTo(A.position.x+et.x*20,A.position.y+et.y*20)}else for(D=Z.length>1?1:0;D<Z.length;D++)for(A=Z[D],K=0;K<A.axes.length;K++)T.moveTo(A.position.x,A.position.y),T.lineTo((A.vertices[0].x+A.vertices[A.vertices.length-1].x)/2,(A.vertices[0].y+A.vertices[A.vertices.length-1].y)/2)}I.wireframes?(T.strokeStyle="indianred",T.lineWidth=1):(T.strokeStyle="rgba(255, 255, 255, 0.4)",T.globalCompositeOperation="overlay",T.lineWidth=2),T.stroke(),T.globalCompositeOperation="source-over"},i.bodyPositions=function(y,w,M){var T=M;y.engine;var I=y.options,A,L,D,K;for(T.beginPath(),D=0;D<w.length;D++)if(A=w[D],!!A.render.visible)for(K=0;K<A.parts.length;K++)L=A.parts[K],T.arc(L.position.x,L.position.y,3,0,2*Math.PI,!1),T.closePath();for(I.wireframes?T.fillStyle="indianred":T.fillStyle="rgba(0,0,0,0.5)",T.fill(),T.beginPath(),D=0;D<w.length;D++)A=w[D],A.render.visible&&(T.arc(A.positionPrev.x,A.positionPrev.y,2,0,2*Math.PI,!1),T.closePath());T.fillStyle="rgba(255,165,0,0.8)",T.fill()},i.bodyVelocity=function(y,w,M){var T=M;T.beginPath();for(var I=0;I<w.length;I++){var A=w[I];if(A.render.visible){var L=u.getVelocity(A);T.moveTo(A.position.x,A.position.y),T.lineTo(A.position.x+L.x,A.position.y+L.y)}}T.lineWidth=3,T.strokeStyle="cornflowerblue",T.stroke()},i.bodyIds=function(y,w,M){var T=M,I,A;for(I=0;I<w.length;I++)if(w[I].render.visible){var L=w[I].parts;for(A=L.length>1?1:0;A<L.length;A++){var D=L[A];T.font="12px Arial",T.fillStyle="rgba(255,255,255,0.5)",T.fillText(D.id,D.position.x+10,D.position.y-10)}}},i.collisions=function(y,w,M){var T=M,I=y.options,A,L,D,K;for(T.beginPath(),D=0;D<w.length;D++)if(A=w[D],!!A.isActive)for(L=A.collision,K=0;K<A.contactCount;K++){var X=A.contacts[K],Z=X.vertex;T.rect(Z.x-1.5,Z.y-1.5,3.5,3.5)}for(I.wireframes?T.fillStyle="rgba(255,255,255,0.7)":T.fillStyle="orange",T.fill(),T.beginPath(),D=0;D<w.length;D++)if(A=w[D],!!A.isActive&&(L=A.collision,A.contactCount>0)){var et=A.contacts[0].vertex.x,Q=A.contacts[0].vertex.y;A.contactCount===2&&(et=(A.contacts[0].vertex.x+A.contacts[1].vertex.x)/2,Q=(A.contacts[0].vertex.y+A.contacts[1].vertex.y)/2),L.bodyB===L.supports[0].body||L.bodyA.isStatic===!0?T.moveTo(et-L.normal.x*8,Q-L.normal.y*8):T.moveTo(et+L.normal.x*8,Q+L.normal.y*8),T.lineTo(et,Q)}I.wireframes?T.strokeStyle="rgba(255,165,0,0.7)":T.strokeStyle="orange",T.lineWidth=1,T.stroke()},i.separations=function(y,w,M){var T=M,I=y.options,A,L,D,K,X;for(T.beginPath(),X=0;X<w.length;X++)if(A=w[X],!!A.isActive){L=A.collision,D=L.bodyA,K=L.bodyB;var Z=1;!K.isStatic&&!D.isStatic&&(Z=.5),K.isStatic&&(Z=0),T.moveTo(K.position.x,K.position.y),T.lineTo(K.position.x-L.penetration.x*Z,K.position.y-L.penetration.y*Z),Z=1,!K.isStatic&&!D.isStatic&&(Z=.5),D.isStatic&&(Z=0),T.moveTo(D.position.x,D.position.y),T.lineTo(D.position.x+L.penetration.x*Z,D.position.y+L.penetration.y*Z)}I.wireframes?T.strokeStyle="rgba(255,165,0,0.5)":T.strokeStyle="orange",T.stroke()},i.inspector=function(y,w){y.engine;var M=y.selected,T=y.render,I=T.options,A;if(I.hasBounds){var L=T.bounds.max.x-T.bounds.min.x,D=T.bounds.max.y-T.bounds.min.y,K=L/T.options.width,X=D/T.options.height;w.scale(1/K,1/X),w.translate(-T.bounds.min.x,-T.bounds.min.y)}for(var Z=0;Z<M.length;Z++){var et=M[Z].data;switch(w.translate(.5,.5),w.lineWidth=1,w.strokeStyle="rgba(255,165,0,0.9)",w.setLineDash([1,2]),et.type){case"body":A=et.bounds,w.beginPath(),w.rect(Math.floor(A.min.x-3),Math.floor(A.min.y-3),Math.floor(A.max.x-A.min.x+6),Math.floor(A.max.y-A.min.y+6)),w.closePath(),w.stroke();break;case"constraint":var Q=et.pointA;et.bodyA&&(Q=et.pointB),w.beginPath(),w.arc(Q.x,Q.y,10,0,2*Math.PI),w.closePath(),w.stroke();break}w.setLineDash([]),w.translate(-.5,-.5)}y.selectStart!==null&&(w.translate(.5,.5),w.lineWidth=1,w.strokeStyle="rgba(255,165,0,0.6)",w.fillStyle="rgba(255,165,0,0.1)",A=y.selectBounds,w.beginPath(),w.rect(Math.floor(A.min.x),Math.floor(A.min.y),Math.floor(A.max.x-A.min.x),Math.floor(A.max.y-A.min.y)),w.closePath(),w.stroke(),w.fill(),w.translate(-.5,-.5)),I.hasBounds&&w.setTransform(1,0,0,1,0,0)};var c=function(y,w){var M=y.engine,T=y.timing,I=T.historySize,A=M.timing.timestamp;T.delta=w-T.lastTime||i._goodDelta,T.lastTime=w,T.timestampElapsed=A-T.lastTimestamp||0,T.lastTimestamp=A,T.deltaHistory.unshift(T.delta),T.deltaHistory.length=Math.min(T.deltaHistory.length,I),T.engineDeltaHistory.unshift(M.timing.lastDelta),T.engineDeltaHistory.length=Math.min(T.engineDeltaHistory.length,I),T.timestampElapsedHistory.unshift(T.timestampElapsed),T.timestampElapsedHistory.length=Math.min(T.timestampElapsedHistory.length,I),T.engineUpdatesHistory.unshift(M.timing.lastUpdatesPerFrame),T.engineUpdatesHistory.length=Math.min(T.engineUpdatesHistory.length,I),T.engineElapsedHistory.unshift(M.timing.lastElapsed),T.engineElapsedHistory.length=Math.min(T.engineElapsedHistory.length,I),T.elapsedHistory.unshift(T.lastElapsed),T.elapsedHistory.length=Math.min(T.elapsedHistory.length,I)},d=function(y){for(var w=0,M=0;M<y.length;M+=1)w+=y[M];return w/y.length||0},S=function(y,w){var M=document.createElement("canvas");return M.width=y,M.height=w,M.oncontextmenu=function(){return!1},M.onselectstart=function(){return!1},M},B=function(y){var w=y.getContext("2d"),M=window.devicePixelRatio||1,T=w.webkitBackingStorePixelRatio||w.mozBackingStorePixelRatio||w.msBackingStorePixelRatio||w.oBackingStorePixelRatio||w.backingStorePixelRatio||1;return M/T},U=function(y,w){var M=y.textures[w];return M||(M=y.textures[w]=new Image,M.src=w,M)},_=function(y,w){var M=w;/(jpg|gif|png)$/.test(w)&&(M="url("+w+")"),y.canvas.style.background=M,y.canvas.style.backgroundSize="contain",y.currentBackground=w}})()},function(s,C,p){var i={};s.exports=i;var u=p(5),l=p(17),a=p(0);(function(){i._maxFrameDelta=1e3/15,i._frameDeltaFallback=1e3/60,i._timeBufferMargin=1.5,i._elapsedNextEstimate=1,i._smoothingLowerBound=.1,i._smoothingUpperBound=.9,i.create=function(f){var x={delta:16.666666666666668,frameDelta:null,frameDeltaSmoothing:!0,frameDeltaSnapping:!0,frameDeltaHistory:[],frameDeltaHistorySize:100,frameRequestId:null,timeBuffer:0,timeLastTick:null,maxUpdates:null,maxFrameTime:33.333333333333336,lastUpdatesDeferred:0,enabled:!0},v=a.extend(x,f);return v.fps=0,v},i.run=function(f,x){return f.timeBuffer=i._frameDeltaFallback,function v(r){f.frameRequestId=i._onNextFrame(f,v),r&&f.enabled&&i.tick(f,x,r)}(),f},i.tick=function(f,x,v){var r=a.now(),h=f.delta,c=0,d=v-f.timeLastTick;if((!d||!f.timeLastTick||d>Math.max(i._maxFrameDelta,f.maxFrameTime))&&(d=f.frameDelta||i._frameDeltaFallback),f.frameDeltaSmoothing){f.frameDeltaHistory.push(d),f.frameDeltaHistory=f.frameDeltaHistory.slice(-f.frameDeltaHistorySize);var S=f.frameDeltaHistory.slice(0).sort(),B=f.frameDeltaHistory.slice(S.length*i._smoothingLowerBound,S.length*i._smoothingUpperBound),U=m(B);d=U||d}f.frameDeltaSnapping&&(d=1e3/Math.round(1e3/d)),f.frameDelta=d,f.timeLastTick=v,f.timeBuffer+=f.frameDelta,f.timeBuffer=a.clamp(f.timeBuffer,0,f.frameDelta+h*i._timeBufferMargin),f.lastUpdatesDeferred=0;var _=f.maxUpdates||Math.ceil(f.maxFrameTime/h),y={timestamp:x.timing.timestamp};u.trigger(f,"beforeTick",y),u.trigger(f,"tick",y);for(var w=a.now();h>0&&f.timeBuffer>=h*i._timeBufferMargin;){u.trigger(f,"beforeUpdate",y),l.update(x,h),u.trigger(f,"afterUpdate",y),f.timeBuffer-=h,c+=1;var M=a.now()-r,T=a.now()-w,I=M+i._elapsedNextEstimate*T/c;if(c>=_||I>f.maxFrameTime){f.lastUpdatesDeferred=Math.round(Math.max(0,f.timeBuffer/h-i._timeBufferMargin));break}}x.timing.lastUpdatesPerFrame=c,u.trigger(f,"afterTick",y),f.frameDeltaHistory.length>=100&&(f.lastUpdatesDeferred&&Math.round(f.frameDelta/h)>_?a.warnOnce("Matter.Runner: runner reached runner.maxUpdates, see docs."):f.lastUpdatesDeferred&&a.warnOnce("Matter.Runner: runner reached runner.maxFrameTime, see docs."),typeof f.isFixed<"u"&&a.warnOnce("Matter.Runner: runner.isFixed is now redundant, see docs."),(f.deltaMin||f.deltaMax)&&a.warnOnce("Matter.Runner: runner.deltaMin and runner.deltaMax were removed, see docs."),f.fps!==0&&a.warnOnce("Matter.Runner: runner.fps was replaced by runner.delta, see docs."))},i.stop=function(f){i._cancelNextFrame(f)},i._onNextFrame=function(f,x){if(typeof window<"u"&&window.requestAnimationFrame)f.frameRequestId=window.requestAnimationFrame(x);else throw new Error("Matter.Runner: missing required global window.requestAnimationFrame.");return f.frameRequestId},i._cancelNextFrame=function(f){if(typeof window<"u"&&window.cancelAnimationFrame)window.cancelAnimationFrame(f.frameRequestId);else throw new Error("Matter.Runner: missing required global window.cancelAnimationFrame.")};var m=function(f){for(var x=0,v=f.length,r=0;r<v;r+=1)x+=f[r];return x/v||0}})()},function(s,C,p){var i={};s.exports=i;var u=p(8),l=p(0),a=l.deprecated;(function(){i.collides=function(m,f){return u.collides(m,f)},a(i,"collides","SAT.collides ➤ replaced by Collision.collides")})()},function(s,C,p){var i={};s.exports=i,p(1);var u=p(0);(function(){i.pathToVertices=function(l,a){typeof window<"u"&&!("SVGPathSeg"in window)&&u.warn("Svg.pathToVertices: SVGPathSeg not defined, a polyfill is required.");var m,f,x,v,r,h,c,d,S,B,U=[],_,y,w=0,M=0,T=0;a=a||15;var I=function(L,D,K){var X=K%2===1&&K>1;if(!S||L!=S.x||D!=S.y){S&&X?(_=S.x,y=S.y):(_=0,y=0);var Z={x:_+L,y:y+D};(X||!S)&&(S=Z),U.push(Z),M=_+L,T=y+D}},A=function(L){var D=L.pathSegTypeAsLetter.toUpperCase();if(D!=="Z"){switch(D){case"M":case"L":case"T":case"C":case"S":case"Q":M=L.x,T=L.y;break;case"H":M=L.x;break;case"V":T=L.y;break}I(M,T,L.pathSegType)}};for(i._svgPathToAbsolute(l),x=l.getTotalLength(),h=[],m=0;m<l.pathSegList.numberOfItems;m+=1)h.push(l.pathSegList.getItem(m));for(c=h.concat();w<x;){if(B=l.getPathSegAtLength(w),r=h[B],r!=d){for(;c.length&&c[0]!=r;)A(c.shift());d=r}switch(r.pathSegTypeAsLetter.toUpperCase()){case"C":case"T":case"S":case"Q":case"A":v=l.getPointAtLength(w),I(v.x,v.y,0);break}w+=a}for(m=0,f=c.length;m<f;++m)A(c[m]);return U},i._svgPathToAbsolute=function(l){for(var a,m,f,x,v,r,h=l.pathSegList,c=0,d=0,S=h.numberOfItems,B=0;B<S;++B){var U=h.getItem(B),_=U.pathSegTypeAsLetter;if(/[MLHVCSQTA]/.test(_))"x"in U&&(c=U.x),"y"in U&&(d=U.y);else switch("x1"in U&&(f=c+U.x1),"x2"in U&&(v=c+U.x2),"y1"in U&&(x=d+U.y1),"y2"in U&&(r=d+U.y2),"x"in U&&(c+=U.x),"y"in U&&(d+=U.y),_){case"m":h.replaceItem(l.createSVGPathSegMovetoAbs(c,d),B);break;case"l":h.replaceItem(l.createSVGPathSegLinetoAbs(c,d),B);break;case"h":h.replaceItem(l.createSVGPathSegLinetoHorizontalAbs(c),B);break;case"v":h.replaceItem(l.createSVGPathSegLinetoVerticalAbs(d),B);break;case"c":h.replaceItem(l.createSVGPathSegCurvetoCubicAbs(c,d,f,x,v,r),B);break;case"s":h.replaceItem(l.createSVGPathSegCurvetoCubicSmoothAbs(c,d,v,r),B);break;case"q":h.replaceItem(l.createSVGPathSegCurvetoQuadraticAbs(c,d,f,x),B);break;case"t":h.replaceItem(l.createSVGPathSegCurvetoQuadraticSmoothAbs(c,d),B);break;case"a":h.replaceItem(l.createSVGPathSegArcAbs(c,d,U.r1,U.r2,U.angle,U.largeArcFlag,U.sweepFlag),B);break;case"z":case"Z":c=a,d=m;break}(_=="M"||_=="m")&&(a=c,m=d)}}})()},function(s,C,p){var i={};s.exports=i;var u=p(6);p(0),function(){i.create=u.create,i.add=u.add,i.remove=u.remove,i.clear=u.clear,i.addComposite=u.addComposite,i.addBody=u.addBody,i.addConstraint=u.addConstraint}()}])})}(Qr)),Qr.exports}var Ce=Wm();class Nm{constructor(g){const{game:s=null}=g;this.game=s,this.customSystems=null,this.ecsSystems=null,this.start()}start(){this.customSystems=new Gm({game:this.game}),this.ecsSystems=new Hm({game:this.game})}}class Gm{constructor(g){const{game:s=null}=g;this.game=s}addSceneRotation(){this.game.gameUtils.filterEntitiesByComponents(["rotation","sceneOrientedRotation","baseRotation"],g=>{if(!this.game.gameUtils.isEntityActive(g))return;let s=g.getComponent("baseRotation"),C=0;C=s+this.game.sceneRotation,g.setComponent("rotation",C)})}setBaseRotation(){this.game.gameUtils.filterEntitiesByComponents(["rotation","sceneOrientedRotation","baseRotation"],g=>{if(!this.game.gameUtils.isEntityActive(g))return;const s=g.getComponent("rotation");let C=0;C=s-this.game.sceneRotation,g.setComponent("baseRotation",C)})}debugMatterBodies(){this.game.debugging.debugMatterBodies&&this.game.gameUtils.filterEntitiesByComponents(["pos","matterBody","matterBodyType","rotation"],g=>{if(!this.game.gameUtils.isEntityActive(g))return;const s=g.getComponent("matterBody"),C=g.getComponent("matterBodyType"),p=g.getComponent("matterBodyOffset")||{x:0,y:0},i=g.getComponent("matterBodyColor")||"white",u=g.getComponent("rotation"),l=this.game.ctx;switch(C){case"rectangle":const a=g.getComponent("matterBodyWidth"),m=g.getComponent("matterBodyHeight");l.save();const f=this.game.gameUtils.rotateOffset(p,u);l.translate(s.position.x+f.x,s.position.y+f.y),l.rotate(s.angle),l.fillStyle=i,l.fillRect(-a/2,-m/2,a,m),l.restore();break;case"circle":const x=g.getComponent("matterBodyRadius");l.save(),l.translate(s.position.x+p.x,s.position.y+p.y),l.beginPath(),l.arc(0,0,x,0,Math.PI*2),l.fillStyle=i,l.fill(),l.restore();break;default:console.error("An unidentified shape type entered debugMatterBodies!");break}})}drawSprite(g){const s=g.getComponent("imgKey"),C=g.getComponent("pos"),p=g.getComponent("width"),i=g.getComponent("height"),u=g.getComponent("rotation"),l=g.getComponent("centerImage"),a=this.game.images[s];if(!a){console.warn(`No image for key "${s}"`);return}const m=this.calculateShouldBlink(g);this.game.gameUtils.drawImage({img:a,pos:C,width:p,height:i,rotation:u,centerImage:l,shouldBlink:m})}traceMatterBodies(){if(!this.game.debugging.debugMatterBodies)return;const g=this.game.ctx,s="red";this.game.gameUtils.filterEntitiesByComponents(["matterBody"],C=>{if(!this.game.gameUtils.isEntityActive(C))return;const p=C.getComponent("matterBody");g.strokeStyle=s,g.beginPath(),g.moveTo(this.game.screenCenterPos.x,this.game.screenCenterPos.y),g.lineTo(p.position.x,p.position.y),g.stroke()})}DebugShootingDirection(){this.game.debugging.debugShootDirection&&this.game.gameUtils.filterEntitiesByComponents(["rotation","pos","spawnPos","shootBullet"],g=>{if(!this.game.gameUtils.isEntityActive(g))return;const s=g.getComponent("rotation"),C=g.getComponent("spawnPos"),p=300,i=this.game.ctx;i.strokeStyle="red",C.forEach(u=>{const l=(s-90)*(Math.PI/180),a=u.pos.x+Math.cos(l)*p,m=u.pos.y+Math.sin(l)*p;i.beginPath(),i.moveTo(u.pos.x,u.pos.y),i.lineTo(a,m),i.stroke()})})}trackPlayerRotation(){this.game.gameUtils.filterEntitiesByComponents(["player","rotation"],g=>{const s=g.getComponent("rotation");console.log("Player Rotation:",s)})}depleteShootEnergy(g){const s=g.getComponent("shootEnergy"),C=g.getComponent("shootBullet"),p=s.current,i=s.depletionPerShot;let u=p-i;u<0&&(u=0,s.isDepleted=!0,C.active=!1,this.game.gameUtils.playSfx("energyFinished")),s.current=u,s.regenCooldown=s.regenDelay,g.setComponent("shootEnergy",s),g.setComponent("shootBullet",C),this.game.ui.playerUi.updateEnergyBar()}drawBarEntity(g){const s=this.game.ctx,C=g.getComponent("pos"),p=g.getComponent("width"),i=g.getComponent("height"),u=g.getComponent("bar"),l=u.background.enabled,a=u.outline.enabled;u.lerping.enabled;const m=u.flashEffect.enabled,f=C.x,x=C.y,v=p,r=i,h=u.value/u.maxValue*v;if(s.save(),l&&(s.fillStyle=u.background.color,s.fillRect(f,x,v,r)),m){s.fillStyle=u.flashEffect.color;const c=u.flashEffect.prevValue,d=u.flashEffect.targetValue,S=u.flashEffect.step,B=this.game.gameUtils.lerp(c,d,S);u.flashEffect.value=B,u.flashEffect.prevValue=B;const U=B/u.maxValue*v;s.fillRect(f,x,U,r)}s.fillStyle=u.fillColor,s.fillRect(f,x,h,r),a&&(s.strokeStyle=u.outline.color,s.lineWidth=u.outline.width,s.strokeRect(f,x,v,r)),s.restore(),g.setComponent("bar",u)}drawRectangle(g){const s=this.game.ctx,C=g.getComponent("pos"),p=g.getComponent("width"),i=g.getComponent("height"),u=g.getComponent("rectangleShape"),l=g.getComponent("shapeColor"),a=C.x,m=C.y,f=p,x=i,v=u.rounded.enabled,r=u.outline.enabled;if(s.save(),s.beginPath(),s.fillStyle=l,v){const h=u.rounded.radius;s.roundRect(a,m,f,x,h)}else s.rect(a,m,f,x);s.fill(),r&&(s.strokeStyle=u.outline.color,s.strokeWidth=u.outline.width,s.strokeRect(a,m,f,x)),s.restore()}drawText(g){const s=this.game.ctx,C=g.getComponent("pos"),p=g.getComponent("color"),i=g.getComponent("fontSize"),u=g.getComponent("style"),l=g.getComponent("fontContent"),a=g.getComponent("anchoring"),m=C.x,f=C.y;s.save(),s.textAlign=a.anchorX,s.textBaseline=a.anchorY,s.fillStyle=p,s.font=`${i}px ${u}`,s.fillText(l,m,f),s.restore()}debugBtnClickArea(){if(!this.game.debugging.debugUiClickBox)return;const g=this.game.ctx;this.game.gameUtils.filterEntitiesByComponents(["pos","button"],s=>{if(!this.game.gameUtils.isEntityActive(s))return;const C=s.getComponent("pos"),p=s.getComponent("button"),i=C.x,u=C.y,l=p.clickBoxWidth,a=p.clickBoxHeight,m="green",f=5;g.save(),g.beginPath(),g.strokeStyle=m,g.lineWidth=f,g.rect(i,u,l,a),g.stroke(),g.restore()})}handleBtnTriggers(){this.game.gameUtils.filterEntitiesByComponents(["pos","button"],g=>{if(!this.game.gameUtils.isEntityActive(g))return;const s=g.getComponent("pos"),C=g.getComponent("button"),p=g.getComponent("orderingLayer")||0;if(this.game.gameUtils.isEntityBlockingMouseInput(s.x,s.y,p))return;const i=s.x,u=s.y,l=C.clickBoxWidth,a=C.clickBoxHeight,m=this.game.mouse,f=this.game.gameUtils.isMouseOver(i,u,l,a);if(f&&C.onHover){C.isHovered=!0,this.game.canvas.style.cursor="pointer",this.game.gameUtils.setMouseHoveredEntity(g);const x=C.onHover;typeof x=="function"&&x()}if(C.isHovered&&!f){C.isHovered=!1,this.game.canvas.style.cursor="default",this.game.gameUtils.resetMouseHoveredEntity();const x=C.onHoverReleased;typeof x=="function"&&x(),console.log("Hover Ended!!")}if(m.isPressed&&!C.isPressed){if(C.isPressed=!0,f&&C.onPress){const x=C.onPress;typeof x=="function"&&x()}console.log("BUTTON PRESSED")}if(!m.isPressed&&C.isPressed&&(C.isPressed=!1,f&&C.onRelease)){const x=C.onRelease;typeof x=="function"&&x(),console.log("BUTTON RELEASED")}m.reset()})}drawAllEntities(){const g=[];this.game.gameUtils.filterEntitiesByComponents(["drawType"],u=>{this.game.gameUtils.isEntityActive(u)&&(u.name==="parallax"&&console.log("PARALLAX ENTITY IN DRAW ALL ENTITIES FILTER"),g.push(u))});const s=new Map,C=[];for(const u of g){const l=u.getComponent("parent");l&&g.includes(l)?(s.has(l)||s.set(l,[]),s.get(l).push(u)):C.push(u)}C.sort((u,l)=>(u.getComponent("orderingLayer")||0)-(l.getComponent("orderingLayer")||0));const p=[],i=u=>{p.push(u);const l=s.get(u);if(l){l.sort((a,m)=>{const f=a.getComponent("orderingLayer")??u.getComponent("orderingLayer")??0,x=m.getComponent("orderingLayer")??u.getComponent("orderingLayer")??0;return f-x});for(const a of l)i(a)}};for(const u of C)i(u);for(const u of p){const l=u.getComponent("drawType");switch(l){case"sprite":this.drawSprite(u);break;case"rectangle":this.drawRectangle(u);break;case"bar":this.drawBarEntity(u);break;case"text":this.drawText(u);break;default:console.warn("Unknown drawType:",l)}}}traceLocalPositions(){if(!this.game.debugging.debugLocalPos)return;const g=this.game.ctx;this.game.gameUtils.filterEntitiesByComponents(["localPos","parent"],s=>{if(!this.game.gameUtils.isEntityActive(s))return;const C=this.game.gameUtils.getGlobalFromLocalPos(s),p=this.game.screenCenterPos;g.save(),g.beginPath(),g.strokeStyle="green",g.moveTo(p.x,p.y),g.lineTo(C.x,C.y),g.stroke(),g.restore()})}calculateShouldBlink(g){const s=g.getComponent("invincibility");if(s&&s.active){const C=s.blinkDelay;let p=s.blinkCounter||0,i=!1;return p>0?p-=this.game.deltaTime:(p=C,i=!0),s.blinkCounter=p,g.setComponent("invincibility",s),i}}}class Hm{constructor(g){const{game:s=null}=g;this.game=s}changeBodyRotationSystem(){this.game.ecs.entityEngine.system("rotationMatterBodies",["rotation","matterBody","matterBodyType"],(s,{rotation:C,matterBody:p,matterBodyType:i})=>{if(!this.game.gameUtils.isEntityActive(s)||!["rectangle"].includes(i))return;const l=C*(Math.PI/180);Ce.Body.setAngle(p,l)})}movePlayerSystem(){this.game.ecs.entityEngine.system("movePlayer",["player","speed","moveVector","pos","matterBody"],(s,{player:C,speed:p,moveVector:i,pos:u,matterBody:l})=>{if(!this.game.gameUtils.isEntityActive(s))return;const a=this.game.mouse.pos.x,m=this.game.mouse.pos.y,f=u.x,x=u.y;let v=a-f,r=m-x;const h=Math.hypot(v,r);if(h>50){const c=p,d=Math.min(h/20,1),S=c*d;v/=h,r/=h,Ce.Body.setVelocity(l,{x:v*S,y:r*S})}else Ce.Body.setVelocity(l,{x:0,y:0});u.x=l.position.x,u.y=l.position.y,s.setComponent("moveVector",{x:v,y:r}),s.setComponent("pos",u)})}moveEntitiesSystem(){this.game.ecs.entityEngine.system("moveObjects",["pos","rotation","matterBody","speed","movementType","notPlayer"],(s,{pos:C,rotation:p,matterBody:i,speed:u,movementType:l})=>{if(!this.game.gameUtils.isEntityActive(s))return;const a=s.getComponent("movementState")||{};let m={x:0,y:0};switch(l){case"straight":{const v=p*(Math.PI/180);m={x:Math.sin(v),y:-Math.cos(v)};break}case"wander":{(!a.target||this.reachedTarget(C,a.target))&&(a.target=this.getRandomScreenPos()),m=this.getDirectionTo(C,a.target);break}case"patrol":{m=this.getPatrolVector(C,a);break}case"diagonalEdge":{m=this.getEdgeDiagonalVector(this.game.totalSceneRotation);break}default:return}const f=Math.hypot(m.x,m.y)||1;m.x/=f,m.y/=f;const x=1e-4;Math.abs(m.x)<x&&(m.x=0),Math.abs(m.y)<x&&(m.y=0),Ce.Body.setVelocity(i,{x:m.x*u,y:m.y*u}),C.x=i.position.x,C.y=i.position.y,s.setComponent("pos",C),s.setComponent("moveVector",m),s.setComponent("movementState",a)})}getDirectionTo(g,s){const C=s.x-g.x,p=s.y-g.y,i=Math.hypot(C,p)||1;return{x:C/i,y:p/i}}reachedTarget(g,s,C=10){return Math.hypot(g.x-s.x,g.y-s.y)<C}getRandomScreenPos(){return{x:Math.random()*this.game.canvasWidth,y:Math.random()*this.game.canvasHeight}}getPatrolVector(g,s){const C={min:100,max:this.game.width-100};return s.direction||(s.direction=1),(g.x<C.min&&s.direction<0||g.x>C.max&&s.direction>0)&&(s.direction*=-1),{x:s.direction,y:0}}getEdgeDiagonalVector(g){switch(g){case 0:return{x:1,y:-1};case 90:return{x:-1,y:-1};case 180:return{x:-1,y:1};case 270:return{x:1,y:1};default:{const s=g*(Math.PI/180);return{x:Math.cos(s),y:Math.sin(s)}}}}shootBulletsSystem(){this.game.ecs.entityEngine.system("shootBullets",["pos","shootBullet","rotation","spawnPos","shootTimes"],(s,{pos:C,shootBullet:p,rotation:i,spawnPos:u,shootTimes:l})=>{if(!this.game.gameUtils.isEntityActive(s)||(u.forEach(v=>{const r=this.game.gameUtils.rotateOffset(v.offset,i);v.pos.x=C.x+r.x,v.pos.y=C.y+r.y}),!p.active))return;if(p.counter>0){p.counter-=this.game.deltaTime,s.setComponent("shootBullet",p);return}const a=s.hasComponent("player");let m=!1,f={};a&&(m=!0),m?(this.game.ecs.customSystems.depleteShootEnergy(s),f={label:"playerBullet",collisionFilter:{category:this.game.collisionCategories.playerBulletCategory,mask:this.game.collisionCategories.enemyCategory}},this.game.gameUtils.playPlayerShootSound()):f={label:"enemyBullet",collisionFilter:{category:this.game.collisionCategories.enemyBulletCategory,mask:this.game.collisionCategories.playerCategory}};let x=l;u.forEach(v=>{x<=0||(this.game.gameUtils.spawnEntity({passedKey:p.spawnKey,componentsToModify:{pos:{x:v.pos.x,y:v.pos.y},rotation:i,baseRotation:i,matterBodyOptions:f}}),x--)}),p.counter=p.delayInSeconds,s.setComponent("shootBullet",p)})}manageShootEnergySystem(){this.game.ecs.entityEngine.system("manageShootEnergySystem",["shootEnergy","shootBullet"],(s,{shootEnergy:C,shootBullet:p})=>{if(!this.game.gameUtils.isEntityActive(s))return;const i=this.game.deltaTime,u=p.active;let l=C.current;const a=C.max,m=C.regenRate,f=s.hasComponent("player");if(C.isDepleted&&C.regenCooldown>0){C.regenCooldown-=i,s.setComponent("shootEnergy",C);return}if(!u&&l<a){if(l+=m*i,l>a&&(l=a),C.current=l,C.isDepleted&&l>=a&&(C.isDepleted=!1,f&&this.game.player.isFireHeld)){const x=s.getComponent("shootBullet");x.active=!0,s.setComponent("shootBullet",x)}s.setComponent("shootEnergy",C)}})}playerEnergyBarColorSystem(){this.game.ecs.entityEngine.system("playerEnergyBarColorSystem",["player","shootEnergy"],(s,{player:C,shootEnergy:p})=>{if(p.isDepleted){const i="rgb(44, 6, 50)",u=this.game.ui.playerUi.energyBarEntity,l=u.getComponent("bar");l.fillColor=i,u.setComponent("bar",l)}else{const i=this.game.ui.playerUi.energyBarEntity,u=i.getComponent("bar");u.fillColor="purple",i.setComponent("bar",u)}})}handleLocalPosSystem(){this.game.ecs.entityEngine.system("handleLocalPosSystem",["pos","localPos","parent"],(s,{pos:C,localPos:p,parent:i})=>{if(!this.game.gameUtils.isEntityActive(s))return;const u=i.getComponent("pos");p={x:C.x-u.x,y:C.y-u.y},s.setComponent("localPos",p)})}handleInvincibilityCounterSystem(){this.game.ecs.entityEngine.system("handleInvincibilityCounterSystem",["invincibility"],(s,{invincibility:C})=>{this.game.gameUtils.isEntityActive(s)&&C.active&&(C.invincibilityCounter>0?C.invincibilityCounter-=this.game.deltaTime:C.active=!1,s.setComponent("invincibility",C))})}destroyOutOfBoundsEntitiesSystem(){this.game.ecs.entityEngine.system("destroyOutOfBoundsEntitiesSystem",["pos","destroyOutOfBounds"],(s,{pos:C,destroyOutOfBounds:p})=>{if(!this.game.gameUtils.isEntityActive(s))return;this.game.gameUtils.isOutOfScreenBounds(s,200)&&this.game.gameUtils.removeEntity(s)})}}class Km{constructor(g){this.game=g,this.initializeMatter()}initializeMatter(){const g=Ce.Engine.create(),s=Ce.Runner.create();g.world.gravity.scale=0,Ce.Runner.run(s,g),this.game.matter.matterEngine=g,this.game.matter.matterRunner=s,this.collisionDetection()}collisionDetection(){Ce.Events.on(this.game.matter.matterEngine,"collisionStart",g=>{for(let s of g.pairs){const{bodyA:C,bodyB:p}=s,i=C.label,u=p.label;if(this.matchCollision(i,u,"playerBullet","enemy")){const l=i==="playerBullet"?C.gameObject:p.gameObject,a=i==="enemy"?C.gameObject:p.gameObject,m=l.getComponent("damage");if(m){const f=a.getComponent("pos");this.game.gameUtils.damageEntity({entity:a,damageComponent:m})&&this.game.gameUtils.dropLoot(f)}this.game.gameUtils.removeEntity(l)}else if(this.matchCollision(i,u,"player","enemy")){const l=i==="player"?C.gameObject:p.gameObject,a=i==="enemy"?C.gameObject:p.gameObject;if(this.game.gameUtils.isInvincibilityActive(l))return;const m=a.getComponent("damage");if(this.game.gameUtils.damageEntity({entity:l,damageComponent:m})){console.log("PLAYER DEAD!"),this.game.gameUtils.gameover();return}this.game.gameUtils.activateInvincibility(l),this.game.ui.playerUi.updateHealthBar();const x=l.getComponent("pos");this.game.gameUtils.spawnParticles({pos:{x:x.x,y:x.y}}),a.hasComponent("boss")||this.game.gameUtils.removeEntity(a),this.game.gameUtils.playSfx("playerShipExplosion")}else if(this.matchCollision(i,u,"player","item")){const l=i==="player"?C.gameObject:p.gameObject,a=i==="item"?C.gameObject:p.gameObject,m=a.getComponent("changeSpawnKey"),f=a.getComponent("changeDelayComponent"),x=a.getComponent("changeShootTimes");m&&this.game.gameUtils.changeShootBullet({entity:l,changeSpawnKeyComponent:m}),f&&this.game.gameUtils.changeShootDelay({entity:l,changeDelayComponent:f}),x&&this.game.gameUtils.changeShootTimes({entity:l,changeShootTimesComponent:x}),this.game.gameUtils.removeEntity(a),this.game.gameUtils.playSfx("powerUpGrab")}else if(this.matchCollision(i,u,"player","enemyBullet")){const l=i==="player"?C.gameObject:p.gameObject,a=i==="item"?C.gameObject:p.gameObject;if(console.log("player collided with enemy bullet!"),this.game.gameUtils.isInvincibilityActive(l))return;const m=a.getComponent("damage");if(this.game.gameUtils.damageEntity({entity:l,damageComponent:m})){console.log("PLAYER DEAD!"),this.game.gameUtils.gameover();return}this.game.gameUtils.activateInvincibility(l),this.game.ui.playerUi.updateHealthBar();const x=l.getComponent("pos");this.game.gameUtils.spawnParticles({pos:{x:x.x,y:x.y}}),this.game.gameUtils.removeEntity(a),this.game.gameUtils.playSfx("playerShipExplosion")}}})}matchCollision(g,s,C,p){return g===C&&s===p||g===p&&s===C}}var Fi={exports:{}};Fi.exports;var Xl;function Vm(){return Xl||(Xl=1,function(J,g){var s=200,C="__lodash_hash_undefined__",p=800,i=16,u=9007199254740991,l="[object Arguments]",a="[object Array]",m="[object AsyncFunction]",f="[object Boolean]",x="[object Date]",v="[object Error]",r="[object Function]",h="[object GeneratorFunction]",c="[object Map]",d="[object Number]",S="[object Null]",B="[object Object]",U="[object Proxy]",_="[object RegExp]",y="[object Set]",w="[object String]",M="[object Undefined]",T="[object WeakMap]",I="[object ArrayBuffer]",A="[object DataView]",L="[object Float32Array]",D="[object Float64Array]",K="[object Int8Array]",X="[object Int16Array]",Z="[object Int32Array]",et="[object Uint8Array]",Q="[object Uint8ClampedArray]",at="[object Uint16Array]",vt="[object Uint32Array]",_t=/[\\^$.*+?()[\]{}|]/g,Ct=/^\[object .+?Constructor\]$/,kt=/^(?:0|[1-9]\d*)$/,ut={};ut[L]=ut[D]=ut[K]=ut[X]=ut[Z]=ut[et]=ut[Q]=ut[at]=ut[vt]=!0,ut[l]=ut[a]=ut[I]=ut[f]=ut[A]=ut[x]=ut[v]=ut[r]=ut[c]=ut[d]=ut[B]=ut[_]=ut[y]=ut[w]=ut[T]=!1;var fe=typeof Ge=="object"&&Ge&&Ge.Object===Object&&Ge,Wt=typeof self=="object"&&self&&self.Object===Object&&self,ft=fe||Wt||Function("return this")(),$t=g&&!g.nodeType&&g,Pt=$t&&!0&&J&&!J.nodeType&&J,re=Pt&&Pt.exports===$t,Xt=re&&fe.process,Vt=function(){try{var R=Pt&&Pt.require&&Pt.require("util").types;return R||Xt&&Xt.binding&&Xt.binding("util")}catch{}}(),It=Vt&&Vt.isTypedArray;function Rn(R,F,H){switch(H.length){case 0:return R.call(F);case 1:return R.call(F,H[0]);case 2:return R.call(F,H[0],H[1]);case 3:return R.call(F,H[0],H[1],H[2])}return R.apply(F,H)}function te(R,F){for(var H=-1,tt=Array(R);++H<R;)tt[H]=F(H);return tt}function He(R){return function(F){return R(F)}}function On(R,F){return R==null?void 0:R[F]}function se(R,F){return function(H){return R(F(H))}}var rn=Array.prototype,ce=Function.prototype,he=Object.prototype,Nt=ft["__core-js_shared__"],ge=ce.toString,Zt=he.hasOwnProperty,Cn=function(){var R=/[^.]+$/.exec(Nt&&Nt.keys&&Nt.keys.IE_PROTO||"");return R?"Symbol(src)_1."+R:""}(),Be=he.toString,sn=ge.call(Object),Ke=RegExp("^"+ge.call(Zt).replace(_t,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),pe=re?ft.Buffer:void 0,Ae=ft.Symbol,Ue=ft.Uint8Array;pe&&pe.allocUnsafe;var In=se(Object.getPrototypeOf,Object),Ln=Object.create,ni=he.propertyIsEnumerable,ii=rn.splice,Re=Ae?Ae.toStringTag:void 0,on=function(){try{var R=ui(Object,"defineProperty");return R({},"",{}),R}catch{}}(),ri=pe?pe.isBuffer:void 0,Wi=Math.max,jr=Date.now,Ni=ui(ft,"Map"),an=ui(Object,"create"),Gi=function(){function R(){}return function(F){if(!ze(F))return{};if(Ln)return Ln(F);R.prototype=F;var H=new R;return R.prototype=void 0,H}}();function Ve(R){var F=-1,H=R==null?0:R.length;for(this.clear();++F<H;){var tt=R[F];this.set(tt[0],tt[1])}}function ts(){this.__data__=an?an(null):{},this.size=0}function es(R){var F=this.has(R)&&delete this.__data__[R];return this.size-=F?1:0,F}function ns(R){var F=this.__data__;if(an){var H=F[R];return H===C?void 0:H}return Zt.call(F,R)?F[R]:void 0}function Hi(R){var F=this.__data__;return an?F[R]!==void 0:Zt.call(F,R)}function is(R,F){var H=this.__data__;return this.size+=this.has(R)?0:1,H[R]=an&&F===void 0?C:F,this}Ve.prototype.clear=ts,Ve.prototype.delete=es,Ve.prototype.get=ns,Ve.prototype.has=Hi,Ve.prototype.set=is;function Oe(R){var F=-1,H=R==null?0:R.length;for(this.clear();++F<H;){var tt=R[F];this.set(tt[0],tt[1])}}function rs(){this.__data__=[],this.size=0}function si(R){var F=this.__data__,H=Dn(F,R);if(H<0)return!1;var tt=F.length-1;return H==tt?F.pop():ii.call(F,H,1),--this.size,!0}function ss(R){var F=this.__data__,H=Dn(F,R);return H<0?void 0:F[H][1]}function oi(R){return Dn(this.__data__,R)>-1}function os(R,F){var H=this.__data__,tt=Dn(H,R);return tt<0?(++this.size,H.push([R,F])):H[tt][1]=F,this}Oe.prototype.clear=rs,Oe.prototype.delete=si,Oe.prototype.get=ss,Oe.prototype.has=oi,Oe.prototype.set=os;function ln(R){var F=-1,H=R==null?0:R.length;for(this.clear();++F<H;){var tt=R[F];this.set(tt[0],tt[1])}}function as(){this.size=0,this.__data__={hash:new Ve,map:new(Ni||Oe),string:new Ve}}function ls(R){var F=Sn(this,R).delete(R);return this.size-=F?1:0,F}function us(R){return Sn(this,R).get(R)}function fs(R){return Sn(this,R).has(R)}function cs(R,F){var H=Sn(this,R),tt=H.size;return H.set(R,F),this.size+=H.size==tt?0:1,this}ln.prototype.clear=as,ln.prototype.delete=ls,ln.prototype.get=us,ln.prototype.has=fs,ln.prototype.set=cs;function un(R){var F=this.__data__=new Oe(R);this.size=F.size}function Ki(){this.__data__=new Oe,this.size=0}function hs(R){var F=this.__data__,H=F.delete(R);return this.size=F.size,H}function gs(R){return this.__data__.get(R)}function ps(R){return this.__data__.has(R)}function ms(R,F){var H=this.__data__;if(H instanceof Oe){var tt=H.__data__;if(!Ni||tt.length<s-1)return tt.push([R,F]),this.size=++H.size,this;H=this.__data__=new ln(tt)}return H.set(R,F),this.size=H.size,this}un.prototype.clear=Ki,un.prototype.delete=hs,un.prototype.get=gs,un.prototype.has=ps,un.prototype.set=ms;function ds(R,F){var H=gi(R),tt=!H&&hi(R),dt=!H&&!tt&&lr(R),St=!H&&!tt&&!dt&&fr(R),Ut=H||tt||dt||St,ot=Ut?te(R.length,String):[],Mt=ot.length;for(var Gt in R)Ut&&(Gt=="length"||dt&&(Gt=="offset"||Gt=="parent")||St&&(Gt=="buffer"||Gt=="byteLength"||Gt=="byteOffset")||Nn(Gt,Mt))||ot.push(Gt);return ot}function ai(R,F,H){(H!==void 0&&!wn(R[F],H)||H===void 0&&!(F in R))&&fn(R,F,H)}function kn(R,F,H){var tt=R[F];(!(Zt.call(R,F)&&wn(tt,H))||H===void 0&&!(F in R))&&fn(R,F,H)}function Dn(R,F){for(var H=R.length;H--;)if(wn(R[H][0],F))return H;return-1}function fn(R,F,H){F=="__proto__"&&on?on(R,F,{configurable:!0,enumerable:!0,value:H,writable:!0}):R[F]=H}var ys=Wn();function Fn(R){return R==null?R===void 0?M:S:Re&&Re in Object(R)?ji(R):nr(R)}function Vi(R){return Ye(R)&&Fn(R)==l}function zi(R){if(!ze(R)||fi(R))return!1;var F=mi(R)?Ke:Ct;return F.test(or(R))}function Yi(R){return Ye(R)&&ur(R.length)&&!!ut[Fn(R)]}function $i(R){if(!ze(R))return cn(R);var F=Gn(R),H=[];for(var tt in R)tt=="constructor"&&(F||!Zt.call(R,tt))||H.push(tt);return H}function Xi(R,F,H,tt,dt){R!==F&&ys(F,function(St,Ut){if(dt||(dt=new un),ze(St))vs(R,F,Ut,H,Xi,tt,dt);else{var ot=tt?tt(ci(R,Ut),St,Ut+"",R,F,dt):void 0;ot===void 0&&(ot=St),ai(R,Ut,ot)}},cr)}function vs(R,F,H,tt,dt,St,Ut){var ot=ci(R,H),Mt=ci(F,H),Gt=Ut.get(Mt);if(Gt){ai(R,H,Gt);return}var Jt=St?St(ot,Mt,H+"",R,F,Ut):void 0,$e=Jt===void 0;if($e){var qt=gi(Mt),Hn=!qt&&lr(Mt),di=!qt&&!Hn&&fr(Mt);Jt=Mt,qt||Hn||di?gi(ot)?Jt=ot:ar(ot)?Jt=li(ot):Hn?($e=!1,Jt=Zi(Mt)):di?($e=!1,Jt=qi(Mt)):Jt=[]:ws(Mt)||hi(Mt)?(Jt=ot,hi(ot)?Jt=bs(ot):(!ze(ot)||mi(ot))&&(Jt=tr(Mt))):$e=!1}$e&&(Ut.set(Mt,Jt),dt(Jt,Mt,tt,St,Ut),Ut.delete(Mt)),ai(R,H,Jt)}function xs(R,F){return rr(ir(R,F,bt),R+"")}var Es=on?function(R,F){return on(R,"toString",{configurable:!0,enumerable:!1,value:Bt(F),writable:!0})}:bt;function Zi(R,F){return R.slice()}function Ji(R){var F=new R.constructor(R.byteLength);return new Ue(F).set(new Ue(R)),F}function qi(R,F){var H=Ji(R.buffer);return new R.constructor(H,R.byteOffset,R.length)}function li(R,F){var H=-1,tt=R.length;for(F||(F=Array(tt));++H<tt;)F[H]=R[H];return F}function Cs(R,F,H,tt){var dt=!H;H||(H={});for(var St=-1,Ut=F.length;++St<Ut;){var ot=F[St],Mt=void 0;Mt===void 0&&(Mt=R[ot]),dt?fn(H,ot,Mt):kn(H,ot,Mt)}return H}function Qi(R){return xs(function(F,H){var tt=-1,dt=H.length,St=dt>1?H[dt-1]:void 0,Ut=dt>2?H[2]:void 0;for(St=R.length>3&&typeof St=="function"?(dt--,St):void 0,Ut&&Ss(H[0],H[1],Ut)&&(St=dt<3?void 0:St,dt=1),F=Object(F);++tt<dt;){var ot=H[tt];ot&&R(F,ot,tt,St)}return F})}function Wn(R){return function(F,H,tt){for(var dt=-1,St=Object(F),Ut=tt(F),ot=Ut.length;ot--;){var Mt=Ut[++dt];if(H(St[Mt],Mt,St)===!1)break}return F}}function Sn(R,F){var H=R.__data__;return er(F)?H[typeof F=="string"?"string":"hash"]:H.map}function ui(R,F){var H=On(R,F);return zi(H)?H:void 0}function ji(R){var F=Zt.call(R,Re),H=R[Re];try{R[Re]=void 0;var tt=!0}catch{}var dt=Be.call(R);return tt&&(F?R[Re]=H:delete R[Re]),dt}function tr(R){return typeof R.constructor=="function"&&!Gn(R)?Gi(In(R)):{}}function Nn(R,F){var H=typeof R;return F=F??u,!!F&&(H=="number"||H!="symbol"&&kt.test(R))&&R>-1&&R%1==0&&R<F}function Ss(R,F,H){if(!ze(H))return!1;var tt=typeof F;return(tt=="number"?pi(H)&&Nn(F,H.length):tt=="string"&&F in H)?wn(H[F],R):!1}function er(R){var F=typeof R;return F=="string"||F=="number"||F=="symbol"||F=="boolean"?R!=="__proto__":R===null}function fi(R){return!!Cn&&Cn in R}function Gn(R){var F=R&&R.constructor,H=typeof F=="function"&&F.prototype||he;return R===H}function cn(R){var F=[];if(R!=null)for(var H in Object(R))F.push(H);return F}function nr(R){return Be.call(R)}function ir(R,F,H){return F=Wi(F===void 0?R.length-1:F,0),function(){for(var tt=arguments,dt=-1,St=Wi(tt.length-F,0),Ut=Array(St);++dt<St;)Ut[dt]=tt[F+dt];dt=-1;for(var ot=Array(F+1);++dt<F;)ot[dt]=tt[dt];return ot[F]=H(Ut),Rn(R,this,ot)}}function ci(R,F){if(!(F==="constructor"&&typeof R[F]=="function")&&F!="__proto__")return R[F]}var rr=sr(Es);function sr(R){var F=0,H=0;return function(){var tt=jr(),dt=i-(tt-H);if(H=tt,dt>0){if(++F>=p)return arguments[0]}else F=0;return R.apply(void 0,arguments)}}function or(R){if(R!=null){try{return ge.call(R)}catch{}try{return R+""}catch{}}return""}function wn(R,F){return R===F||R!==R&&F!==F}var hi=Vi(function(){return arguments}())?Vi:function(R){return Ye(R)&&Zt.call(R,"callee")&&!ni.call(R,"callee")},gi=Array.isArray;function pi(R){return R!=null&&ur(R.length)&&!mi(R)}function ar(R){return Ye(R)&&pi(R)}var lr=ri||Ps;function mi(R){if(!ze(R))return!1;var F=Fn(R);return F==r||F==h||F==m||F==U}function ur(R){return typeof R=="number"&&R>-1&&R%1==0&&R<=u}function ze(R){var F=typeof R;return R!=null&&(F=="object"||F=="function")}function Ye(R){return R!=null&&typeof R=="object"}function ws(R){if(!Ye(R)||Fn(R)!=B)return!1;var F=In(R);if(F===null)return!0;var H=Zt.call(F,"constructor")&&F.constructor;return typeof H=="function"&&H instanceof H&&ge.call(H)==sn}var fr=It?He(It):Yi;function bs(R){return Cs(R,cr(R))}function cr(R){return pi(R)?ds(R):$i(R)}var Ts=Qi(function(R,F,H){Xi(R,F,H)});function Bt(R){return function(){return R}}function bt(R){return R}function Ps(){return!1}J.exports=Ts}(Fi,Fi.exports)),Fi.exports}var zm=Vm();const Ym=Um(zm);class Zl{constructor(g){const{game:s=null,name:C="",components:p={}}=g;this.game=s,this.name=C,this.components=p,this.ecsEngine=this.game.ecs.entityEngine,this.matterEngine=this.game.matter.matterEngine,this.entity=null,this.entity=this.CreateEntity()}CreateEntity(){this.name=this.assignUniqueName();const g=this.ecsEngine.entity(this.name);for(const[s,C]of Object.entries(this.components))g.setComponent(s,C);return this.createMatterBody(g),g}createMatterBody(g){if(!g.hasComponent("matterBody"))return;const s=g.getComponent("matterBodyType"),C=g.getComponent("matterBodyOffset")||{x:0,y:0},p=g.getComponent("pos")||{x:0,y:0},i=g.getComponent("rotation")||0,u=g.getComponent("matterBodyOptions")||{};let l=null;switch(s){case"rectangle":const a=g.getComponent("matterBodyWidth"),m=g.getComponent("matterBodyHeight");l=this.returnRectangleBody({pos:p,offset:C,width:a,height:m,advancedOptions:u,rotation:i*(Math.PI/180)});break;case"circle":const f=g.getComponent("matterBodyRadius");l=this.returnCircleBody({pos:p,offset:C,radius:f,advancedOptions:u})}l&&(l.gameObject=g,g.setComponent("matterBody",l),Ce.World.add(this.matterEngine.world,l))}returnRectangleBody(g){var m,f,x;const{pos:s={x:0,y:0},offset:C={x:0,y:0},width:p=100,height:i=100,advancedOptions:u={},rotation:l=0}=g,a=Ce.Bodies.rectangle(s.x+C.x,s.y+C.y,p,i,{label:u.label||"",frictionAir:u.frictionAir||0,isSensor:u.isSensor??!0,inertia:u.inertia??1/0,collisionFilter:{group:((m=u.collisionFilter)==null?void 0:m.group)??0,category:((f=u.collisionFilter)==null?void 0:f.category)??1,mask:((x=u.collisionFilter)==null?void 0:x.mask)??65535},...u});return Ce.Body.setAngle(a,l),a}returnCircleBody(g){var l,a,m;const{pos:s={x:0,y:0},offset:C={x:0,y:0},radius:p=16,advancedOptions:i={}}=g;return Ce.Bodies.circle(s.x+C.x,s.y+C.y,p,{label:i.label||"",frictionAir:i.frictionAir||0,isSensor:i.isSensor??!0,inertia:i.inertia??1/0,collisionFilter:{group:((l=i.collisionFilter)==null?void 0:l.group)??0,category:((a=i.collisionFilter)==null?void 0:a.category)??1,mask:((m=i.collisionFilter)==null?void 0:m.mask)??65535},...i})}assignUniqueName(){const g=this.name;let s=g,C=1;for(;this.ecsEngine.getEntity(s);)s=`${g}_instance${C}`,C++;return s}}class $m{constructor(g){this.game=g,this.ctx=g.ctx}addObj(g){this.game.registeredObj.push(g)}drawImage({img:g,pos:s={x:0,y:0},width:C,height:p,centerImage:i=!0,rotation:u=0,shouldBlink:l=!1}){const a=this.ctx,m=i?-C/2:0,f=i?-p/2:0;a.save(),a.globalAlpha=l?0:1,a.translate(s.x,s.y),a.rotate(u*Math.PI/180),a.drawImage(g,m,f,C,p),a.restore()}spawnEntity(g){const{passedKey:s="",componentsToModify:C={}}=g;let p=null;const i=Object.keys(this.game.entitiesData);let u=null;if(i.forEach(m=>{m===s&&(u=this.game.entitiesData[m])}),!u)throw new Error(`Requested data not found in entitiesData: ${s}`);const l=u.components,a=Ym({},l,C);if(p=new Zl({game:this.game,name:s,components:a}).entity,p.hasComponent("parent")){const m=this.game.sceneEntity,f=p.getComponent("parent");f?this.assignParent(p,f):this.assignParent(p,m)}if(p.hasComponent("parent")&&!a.orderingLayer){const m=p.getComponent("parent");if(m&&m.getComponent("orderingLayer")!==void 0){const f=m.getComponent("orderingLayer");p.setComponent("orderingLayer",f+1)}}return p}rotateOffset(g,s){const C=s*Math.PI/180;return{x:g.x*Math.cos(C)-g.y*Math.sin(C),y:g.x*Math.sin(C)+g.y*Math.cos(C)}}changeShootBullet(g){const{entity:s=null,changeSpawnKeyComponent:C=null}=g,p=s.getComponent("shootBullet");p.spawnKey=C,s.setComponent("shootBullet",p)}changeShootDelay(g){const{entity:s=null,changeDelayComponent:C=null}=g,p=s.getComponent("shootBullet");p.delayInSeconds=C,s.setComponent("shootBullet",p)}changeShootTimes(g){const{entity:s=null,changeShootTimesComponent:C=null}=g,p=s.getComponent("shootTimes"),i=C.value,u=C.changeEffect;let l=p;u==="increase"?l+=i:u==="decrease"&&(l-=i),s.setComponent("shootTimes",l)}damageEntity(g){const{entity:s=null,damageComponent:C=null}=g,p=s.getComponent("invincibility");if(p&&p.active)return;let u=s.getComponent("health");return u-=C,s.setComponent("health",u),this.onHealthEmpty({entity:s,health:u})}onHealthEmpty(g){const{entity:s=null,health:C=0}=g;return C<=0?(this.removeEntity(s),!0):!1}removeEntity(g){const s=g.getComponent("matterBody");s&&Ce.World.remove(this.game.matter.matterEngine.world,s);const C=g.name;this.game.ecs.entityEngine.removeEntity(C)}lerp(g,s,C){return typeof g!="number"||isNaN(g)||typeof s!="number"||isNaN(s)||typeof C!="number"||isNaN(C)?(console.warn("NaN in lerp input:",{a:g,b:s,t:C}),0):g+(s-g)*C}returnIsPaused(){return this.game.isPaused}pauseGame(){this.game.isPaused=!0,this.game.ecs.entitySim.pause(),this.game.matter.matterRunner.enabled=!1,this.game.parallaxSpeed=0,this.game.backgroundParallax.setScrollSpeed(this.game.parallaxSpeed),console.log("IS SIMULATION PAUSED?",this.game.ecs.entitySim.isPaused())}unPauseGame(){this.game.isPaused=!1,this.game.ecs.entitySim.start(),this.game.matter.matterRunner.enabled=!0,this.game.parallaxSpeed=this.game.defParallaxSpeed,this.game.backgroundParallax.setScrollSpeed(this.game.parallaxSpeed),console.log("IS SIMULATION RUNNING?",this.game.ecs.entitySim.isRunning())}queryAllComponents(g,s,C){s.every(p=>g.hasComponent(p))&&C(g)}filterEntitiesByComponents(g,s){const C=Object.values(this.game.ecs.entityEngine.entities);for(const p of C)this.queryAllComponents(p,g,s)}setBarValue(g){const{max:s=0,current:C=0,barEntity:p=null}=g,i=C/s,u=p.getComponent("bar");u.flashEffect.enabled&&(u.flashEffect.prevValue=u.flashEffect.value,u.flashEffect.targetValue=i),u.value=i,p.setComponent("bar",u)}anchoringHorizontal(g,s,C){let p=null;return C==="left"?p=g:C==="center"?p=g+s/2:C==="right"&&(p=g+s),p}anchoringVertical(g,s,C){let p=null;return C==="top"?p=g:C==="middle"?p=g+s/2:C==="bottom"&&(p=g+s),p}setIsActive(g,s){let C=g.getComponent("isActive");C!==null&&(C=s,g.setComponent("isActive",C))}anchorEntity(g,s){const C=g.getComponent("pos"),p=g.getComponent("anchoring"),i=g.getComponent("width"),u=g.getComponent("height"),l=g.hasComponent("fontContent"),a=p.anchorX,m=p.anchorY,f=p.offsetX,x=p.offsetY,v=s.getComponent("pos"),r=s.getComponent("width"),h=s.getComponent("height"),c=v.x,d=v.y,S=r,B=h,U=this.anchoringHorizontal(c,S,a),_=this.anchoringVertical(d,B,m);let y=0,w=0;l||(y=0,a==="left"?y=0:a==="center"?y=i/2:a==="right"&&(y=i),w=0,m==="top"?w=0:m==="middle"?w=u/2:m==="bottom"&&(w=u));const M={x:U-y+f,y:_-w+x};C&&g.setComponent("pos",M)}calculateTextWidthAndHeight(g){const s=this.ctx,C=g.getComponent("fontSize"),p=g.getComponent("fontStyle"),i=g.getComponent("fontContent");s.font=`${C}px ${p}`;const l=s.measureText(i).width,a=C;g.setComponent("width",l),g.setComponent("height",a)}isMouseOver(g,s,C,p){const i=this.game.mouse,u=i.pos.x,l=i.pos.y;return u>=g&&u<=g+C&&l>=s&&l<=s+p}assignParent(g,s){let C=g.getComponent("parent"),p=s.getComponent("children");p.includes(C)||(C=s,p.push(g),g.setComponent("parent",C),s.setComponent("children",p))}isEntityActive(g){let s=g;for(;s;){if(!s.getComponent("isActive"))return!1;s=s.getComponent("parent")}return!0}getGlobalFromLocalPos(g){let s={x:0,y:0};const C=g.getComponent("localPos"),i=g.getComponent("parent").getComponent("pos");return C&&i&&(s={x:C.x+i.x,y:C.y+i.y}),s}toggleCheckbox(g){const s=g.getComponent("checkbox");if(s)return s.state=!s.state,g.setComponent("checkbox",s),s.state}retrieveSavedCheckboxData(g,s){const C=g.getComponent("checkbox"),p=C.storageKey,i=s.getProperty(p);C.state=i,g.setComponent("checkbox",C)}returnCheckboxStorageKey(g){return g.getComponent("checkbox").storageKey}setFontContent(g,s){g.setComponent("fontContent",s)}toggleFontContentOnCheckbox(g,s,C,p){g.getComponent("checkbox").state?this.setFontContent(s,C):this.setFontContent(s,p)}playPlayerShootSound(){const s=this.game.player.playerEntity.getComponent("shootBullet").spawnKey;let C="";switch(s){case"greenBullet":C="greenBulletShoot";break;case"blueBullet":C="blueBulletShoot";break;case"purpleBullet":C="purpleBulletShoot";break;case"yellowBullet":C="yellowBulletShoot";break;default:C="";break}C!==""&&this.playSfx(C)}playSfx(g){this.game.settingsStorageManager.getProperty("sfx")&&this.game.soundManager.play(g)}playLoopedMusic(g){this.game.settingsStorageManager.getProperty("music")&&this.game.soundManager.loop(g)}playLoopedMusicOnInteraction(g){const s=()=>{this.playLoopedMusic(g),window.removeEventListener("click",s),window.removeEventListener("keydown",s)};window.addEventListener("click",s),window.addEventListener("keydown",s)}activateInvincibility(g){const s=g.getComponent("invincibility");s.active=!0,s.invincibilityCounter=s.invincibilityDuration,g.setComponent("invincibility",s)}isInvincibilityActive(g){return g.getComponent("invincibility").active}spawnSceneEntity(g,s){const C=new Zl({game:this.game,name:g,components:{pos:{x:0,y:0},width:this.game.width,height:this.game.height,isActive:s,children:[]}}).entity;return this.game.scenes.push(C),C}loadScene(g){this.game.scenes.forEach(C=>{C.setComponent("isActive",!1)}),g.setComponent("isActive",!0),this.game.currentSceneEntity=g}reloadScene(){throw new Error("Not Implemented")}setMouseHoveredEntity(g){this.isEntityActive(g)&&g.hasComponent("button")&&(this.game.mouse.hoveredEntity=g)}resetMouseHoveredEntity(){this.game.mouse.hoveredEntity=null}onHoveredEntityUnActive(){const g=this.game.mouse.hoveredEntity;g&&(this.isEntityActive(g)||(this.game.canvas.style.cursor="default"))}isOutOfScreenBounds(g,s=0){const C=g.getComponent("pos");return C.x+s<0||C.x-s>this.game.width||C.y+s<0||C.y-s>this.game.height}spawnParticles(g){const{maxNumber:s=16,pos:C={x:0,y:0},color:p="orange",lifeTime:i=.8,alpha:u=1,widthMinRange:l=20,widthMaxRange:a=30,heightMinRange:m=10,heightMaxRange:f=30,speedMinRange:x=1,speedMaxRange:v=40,alphaReductionRate:r=.4}=g;for(let h=0;h<s;h++){const c=2*this.generateRandomNum(l,a),d=3*this.generateRandomNum(m,f),S=Math.random()*Math.PI*2,B=20*this.generateRandomNum(x,v),U=Math.cos(S)*B,_=Math.sin(S)*B,y={pos:{x:C.x,y:C.y},width:c,height:d,color:p,vx:U,vy:_,lifeTime:i,alpha:u,alphaReductionRate:r};this.game.particleEffects.push(y)}}updateParticles(){const g=this.game.particleEffects,s=this.game.deltaTime;for(let C=0;C<g.length;C++){const p=g[C];if(p.pos.x+=p.vx*s,p.pos.y+=p.vy*s,p.lifeTime-=s,p.alpha=Math.max(p.lifeTime/p.alphaReductionRate,0),p.lifeTime<=0){g.splice(C,1),console.log("Particle Deleted!",p,g),console.log("GAME PARTICLE EFFECTS:",this.game.particleEffects);continue}}}drawParticles(){const g=this.game.particleEffects,s=this.game.ctx;for(let C=0;C<g.length;C++){const p=g[C];s.save(),s.globalAlpha=p.alpha,s.fillStyle=p.color,s.fillRect(p.pos.x,p.pos.y,p.width,p.height),s.restore()}}generateRandomNum(g,s){return Math.floor(Math.random()*(s-g))+g}togglePauseForPc(){window.addEventListener("keydown",g=>{console.log(this.game.currentSceneEntity,this.game.sceneEntity),this.game.currentSceneEntity===this.game.sceneEntity&&g.code==="Space"&&(this.returnIsPaused()?(this.setIsActive(this.game.ui.pauseUi.pausePanelEntity,!1),this.unPauseGame()):(this.setIsActive(this.game.ui.pauseUi.pausePanelEntity,!0),this.pauseGame()),this.playSfx("buttonClick"))})}entityExists(g){return this.game.ecs.entityEngine.entities.hasOwnProperty(g.name)}gameover(){this.setIsActive(this.game.ui.gameoverUi.gameoverPanelEntity,!0),this.game.ui.gameoverUi.setWaveReachedText(),this.game.progressStorageManager.deleteData(),this.pauseGame()}gamewon(){this.setIsActive(this.game.ui.gamewinUi.gamewinPanelEntity,!0),this.game.progressStorageManager.deleteData(),this.pauseGame()}isEntityBlockingMouseInput(g,s,C){const p=[];this.game.gameUtils.filterEntitiesByComponents(["drawType","pos"],i=>{this.game.gameUtils.isEntityActive(i)&&p.push(i)});for(const i of p){if(!i.getComponent("blocksInput"))continue;const u=i.getComponent("pos"),l=i.getComponent("clickBoxWidth")||i.getComponent("width")||0,a=i.getComponent("clickBoxHeight")||i.getComponent("height")||0,m=i.getComponent("orderingLayer")||0;if(this.game.gameUtils.isMouseOver(u.x,u.y,l,a)&&m>C)return!0}return!1}dropLoot(g){if(Math.random()>.05)return null;const C=["yellowBattery","purpleBattery","greenBattery","blueBattery","powerup"],p=C[Math.floor(Math.random()*C.length)];return this.spawnEntity({passedKey:p,componentsToModify:{pos:{x:g.x,y:g.y},rotation:180+this.game.totalSceneRotation,baseRotation:180,matterBodyOptions:{label:"item",collisionFilter:{category:this.game.collisionCategories.itemCategory,mask:this.game.collisionCategories.playerCategory}}}})}}class Jl{constructor(g,s){this.key=g,this.defaultData=s,this.data=this.loadData()}loadData(){return JSON.parse(localStorage.getItem(this.key))||this.defaultData}saveData(){localStorage.setItem(this.key,JSON.stringify(this.data))}deleteData(){localStorage.removeItem(this.key)}getProperty(g){if(!(g in this.data))throw new Error(`REQUESTED PROPERTY NULL FROM STORAGE, ${this.key}, ${g}`);return this.data[g]}setProperty(g,s){if(!g)throw new Error(`THE PROPERTY YOU ARE TRYING TO MODIFY DOESNT EXIST IN STORAGE, ${this.key}, ${g}`);this.data[g]=s,this.saveData()}}class Xm{constructor(g){this.audioData=g,this.currentLoops=new Set}play(g){const s=this.audioData[g];if(s)s.currentTime=0,s.play();else throw new Error(`SOUND FILE NOT IN AUDIO DATA!!, ${g}`)}loop(g){const s=this.audioData[g];s&&(s.loop=!0,s.play()),this.currentLoops.add(g)}stop(g){const s=this.audioData[g];s&&(s.pause(),s.currentTime=0),this.currentLoops.delete(g)}stopAllLoops(){for(const g of this.currentLoops)this.stop(g)}setVolume(g,s){const C=this.audioData[g];C&&(C.volume=s)}}class Zm{constructor(g,s,C="vertical"){this.img=g,this.scrollSpeed=s,this.direction=C,this.width=g.width,this.height=g.height,this.positions=[{x:0,y:0},{x:0,y:C==="vertical"?this.height:this.width}]}run(g){for(const s of this.positions)g.drawImage(this.img,Math.round(s.x),Math.round(s.y));this.direction==="vertical"?(this.positions.forEach(s=>s.y-=this.scrollSpeed),this._resetPosition("y",this.height)):(this.positions.forEach(s=>s.x-=this.scrollSpeed),this._resetPosition("x",this.width))}_resetPosition(g,s){const[C,p]=this.positions;this.scrollSpeed>0?(C[g]<=-s&&(C[g]=p[g]+s),p[g]<=-s&&(p[g]=C[g]+s)):(C[g]>=s&&(C[g]=p[g]-s),p[g]>=s&&(p[g]=C[g]-s))}setScrollSpeed(g){this.scrollSpeed=g}}class Jm{constructor({newRotation:g=0,game:s=null}){this.gameSettings=s,this.startRotation=s.sceneRotation,this.targetRotation=this.startRotation+g,this.rotation=this.startRotation,this.changeRate=50,this.delay=0,this.rotating=!1,this.start()}start(){this.gameSettings.gameUtils.addObj(this),setTimeout(()=>{this.rotating=!0,this.gameSettings.nextSceneRotation=this.targetRotation-this.startRotation,this.gameSettings.totalSceneRotation=this.targetRotation},this.delay)}update(){if(!this.rotating)return;const g=this.targetRotation-this.rotation,s=Math.sign(g),C=this.changeRate*this.gameSettings.deltaTime*s;Math.abs(g)<=Math.abs(C)?(this.rotation=this.targetRotation,this.rotating=!1,this.gameSettings.ecs.customSystems.setBaseRotation()):this.rotation+=C,this.gameSettings.sceneRotation=this.rotation,this.gameSettings.ecs.customSystems.addSceneRotation()}}class qm{constructor(g){this.game=g,this.gameUtils=g.gameUtils,this.data=g.enemyWaveData,console.log("GameUtils:",this.gameUtils),this.isSpawning=!1,this.waveJustBegan=!1,this.currentWaveIndex=g.progressStorageManager.getProperty("waveIndex")||0,this.delayBetweenWaves=2,this.spawnedEnemies=[],this.start()}start(){this.game.gameUtils.addObj(this)}update(){this.waveJustBegan&&this._resetWaveFlagNextFrame()}async startWaves(){if(this.isSpawning=!0,!!this.isSpawning){for(;this.currentWaveIndex<this.data.length;){const g=this.data[this.currentWaveIndex];this.spawnedEnemies=[],this.waveJustBegan=!0,console.log(`Spawning wave ${this.currentWaveIndex}`);for(const C of g){for(;this.game.isPaused;)await this._delay(.2);await this._delay(C.delay||0),C.type==="enemy"&&this.spawnEnemy(C.key,C.pos||null),C.type==="rotation"&&C.newRotation!==void 0&&(new Jm({game:this.game,newRotation:C.newRotation}),console.log("ROTATION CHANGE ENCOUNTERED:",C.newRotation,this.game.sceneRotation,this.game.totalSceneRotation))}for(;this.areWaveEnemiesAlive();)await this._delay(.2);this.currentWaveIndex++,this.game.progressStorageManager.setProperty("waveIndex",this.currentWaveIndex),this.game.progressStorageManager.setProperty("sceneRotation",this.game.sceneRotation),this.game.progressStorageManager.setProperty("totalSceneRotation",this.game.totalSceneRotation);const s=this.game.player.playerEntity;this.game.progressStorageManager.setProperty("playerBulletType",s.getComponent("shootBullet").spawnKey),this.game.progressStorageManager.setProperty("playerBulletPower",s.getComponent("shootTimes")),this.game.progressStorageManager.setProperty("playerHealth",s.getComponent("health"))}this.isSpawning=!1,this.gameUtils.gamewon(),console.log("All waves finished.")}}spawnEnemy(g,s=null){const C=this.game.totalSceneRotation,p=s||this.getSpawnPosition(C),i=this.gameUtils.spawnEntity({passedKey:g,componentsToModify:{pos:p,rotation:180+this.game.totalSceneRotation,baseRotation:180,matterBodyOptions:{label:"enemy",collisionFilter:{category:this.game.collisionCategories.enemyCategory,mask:this.game.collisionCategories.playerCategory|this.game.collisionCategories.playerBulletCategory}}}});this.spawnedEnemies.push(i)}getSpawnPosition(g){const s=(g-90)*(Math.PI/180),C=this.game.width,p=this.game.height,i=100,u=C/2,l=p/2,a=Math.cos(s),m=Math.sin(s);let f=u,x=l;Math.abs(a)>Math.abs(m)?(f+=a>0?C/2+i:-(C/2+i),x+=m/Math.abs(a)*(C/2+i)):(x+=m>0?p/2+i:-(p/2+i),f+=a/Math.abs(m)*(p/2+i));const v=-m,r=a,h=Math.abs(v)*C+Math.abs(r)*p,c=(Math.random()-.5)*h,d=v*c,S=r*c;return{x:f+d,y:x+S}}_delay(g){return new Promise(s=>setTimeout(s,g*1e3))}_resetWaveFlagNextFrame(){setTimeout(()=>{this.waveJustBegan=!1},0)}areWaveEnemiesAlive(){return this.spawnedEnemies.some(g=>this.gameUtils.entityExists(g))}}class Qm{constructor(g){this.game=g,this.canvas=g.canvas,this.playerEntity=null,this.maxHealth=0,this.currentHealth=0,this.isFireHeld=!1,this.init()}init(){this.playerEntity=this.game.gameUtils.spawnEntity({passedKey:"player",componentsToModify:{pos:{x:this.game.screenCenterPos.x,y:this.game.screenCenterPos.y},matterBodyOptions:{label:"player",collisionFilter:{category:this.game.collisionCategories.playerCategory,mask:this.game.collisionCategories.itemCategory|this.game.collisionCategories.enemyCategory}},health:this.game.progressStorageManager.getProperty("playerHealth")||50,shootBullet:{spawnKey:this.game.progressStorageManager.getProperty("playerBulletType")||"greenBullet"},shootTimes:this.game.progressStorageManager.getProperty("playerBulletPower")||1}}),this.maxHealth=50,console.log(this.maxHealth),console.log(this.playerEntity.getComponent("health"));const g=["touchstart","touchmove","mousedown"],s=["touchend","mouseup"];g.forEach(C=>{this.canvas.addEventListener(C,()=>{this.isFireHeld=!0,!this.playerEntity.getComponent("shootEnergy").isDepleted&&(this.playerEntity.getComponent("shootBullet").active=!0)},{passive:!0})}),s.forEach(C=>{this.canvas.addEventListener(C,()=>{this.isFireHeld=!1,this.playerEntity.getComponent("shootBullet").active=!1},{passive:!0})})}}class jm{constructor(g){this.game=g,this.gameUtils=g.gameUtils,this.titleTextEntity=null,this.playBtnEntity=null,this.playBtnTextEntity=null,this.newGameBtnEntity=null,this.newGameBtnTextEntity=null,this.settingsBtnEntity=null,this.settingBtnTextEntity=null,this.confirmNewGamePanelEntity=null,this.confirmNewGamePanelTextEntity=null,this.proceedNewGameBtnEntity=null,this.proceedNewGameBtnTextEntity=null,this.cancelNewGameBtnEntity=null,this.cancelNewGameBtnTextEntity=null,this.start()}start(){this.initTitleTextEntity(),this.initPlayBtnEntity(),this.initPlayBtnTextEntity(),this.initNewGameBtnEntity(),this.initNewGameBtnTextEntity(),this.initSettingsBtnEntity(),this.initSettingsBtnTextEntity(),this.initConfirmNewGamePanelEntity(),this.initConfirmNewGamePanelTextEntity(),this.initProceedNewGameBtnEntity(),this.initProceedNewGameBtnTextEntity(),this.initCancelNewGameBtnEntity(),this.initCancelNewGameBtnTextEntity()}initTitleTextEntity(){this.titleTextEntity=this.gameUtils.spawnEntity({passedKey:"text",componentsToModify:{fontSize:120,fontContent:"NOVA FIRE",parent:this.game.mainMenuSceneEntity,anchoring:{anchorY:"top",offsetY:50}}}),this.gameUtils.anchorEntity(this.titleTextEntity,this.game.mainMenuSceneEntity)}initPlayBtnEntity(){const g="rgb(27, 59, 106)";this.playBtnEntity=this.gameUtils.spawnEntity({passedKey:"button",componentsToModify:{width:200,height:100,rectangleShape:{rounded:{enabled:!0,radius:10}},shapeColor:g,parent:this.game.mainMenuSceneEntity,button:{clickBoxWidth:200,onPress:()=>{this.gameUtils.loadScene(this.game.sceneEntity),this.game.ui.pauseUi.refreshCheckboxStates(),this.gameUtils.setIsActive(this.game.ui.pauseUi.pausePanelEntity,!1),this.gameUtils.unPauseGame(),this.game.ecs.customSystems.addSceneRotation(),this.game.enemyWaveSpawner.startWaves(),this.gameUtils.playSfx("buttonClick")}},anchoring:{offsetY:-200}}}),this.gameUtils.anchorEntity(this.playBtnEntity,this.game.mainMenuSceneEntity)}initPlayBtnTextEntity(){this.playBtnTextEntity=this.gameUtils.spawnEntity({passedKey:"text",componentsToModify:{fontSize:30,fontContent:"Play",parent:this.playBtnEntity}}),this.gameUtils.anchorEntity(this.playBtnTextEntity,this.playBtnEntity)}initNewGameBtnEntity(){const g="rgb(27, 59, 106)";this.newGameBtnEntity=this.gameUtils.spawnEntity({passedKey:"button",componentsToModify:{width:200,height:100,rectangleShape:{rounded:{enabled:!0,radius:10}},shapeColor:g,parent:this.game.mainMenuSceneEntity,button:{clickBoxWidth:200,onPress:()=>{this.gameUtils.setIsActive(this.confirmNewGamePanelEntity,!0),this.gameUtils.playSfx("buttonClick")}},anchoring:{offsetY:0}}}),this.gameUtils.anchorEntity(this.newGameBtnEntity,this.game.mainMenuSceneEntity)}initNewGameBtnTextEntity(){this.newGameBtnTextEntity=this.gameUtils.spawnEntity({passedKey:"text",componentsToModify:{fontSize:30,fontContent:"NEW GAME",parent:this.newGameBtnEntity}}),this.gameUtils.anchorEntity(this.newGameBtnTextEntity,this.newGameBtnEntity)}initSettingsBtnEntity(){const g="rgb(27, 59, 106)";this.settingsBtnEntity=this.gameUtils.spawnEntity({passedKey:"button",componentsToModify:{width:200,height:100,rectangleShape:{rounded:{enabled:!0,radius:10}},shapeColor:g,parent:this.game.mainMenuSceneEntity,button:{clickBoxWidth:200,onPress:()=>{console.log("settingsSceneUi?",this.game.ui.settingsSceneUi),this.gameUtils.loadScene(this.game.settingsSceneEntity),this.game.ui.settingsSceneUi.refreshCheckboxStates(),this.gameUtils.playSfx("buttonClick")}},anchoring:{offsetY:200}}}),this.gameUtils.anchorEntity(this.settingsBtnEntity,this.game.mainMenuSceneEntity)}initSettingsBtnTextEntity(){this.settingBtnTextEntity=this.gameUtils.spawnEntity({passedKey:"text",componentsToModify:{fontSize:30,fontContent:"SETTINGS",parent:this.settingsBtnEntity}}),this.gameUtils.anchorEntity(this.settingBtnTextEntity,this.settingsBtnEntity)}initConfirmNewGamePanelEntity(){const g="rgb(33, 76, 141)";this.confirmNewGamePanelEntity=this.gameUtils.spawnEntity({passedKey:"panel",componentsToModify:{width:900,height:400,shapeColor:g,rectangleShape:{rounded:{enabled:!0}},orderingLayer:11,parent:this.game.mainMenuSceneEntity,isActive:!1}}),this.gameUtils.anchorEntity(this.confirmNewGamePanelEntity,this.game.mainMenuSceneEntity)}initConfirmNewGamePanelTextEntity(){this.confirmNewGamePanelTextEntity=this.gameUtils.spawnEntity({passedKey:"text",componentsToModify:{fontSize:50,fontContent:"DELETE ALL DATA",parent:this.confirmNewGamePanelEntity,anchoring:{anchorY:"top"}}}),this.gameUtils.anchorEntity(this.confirmNewGamePanelTextEntity,this.confirmNewGamePanelEntity)}initProceedNewGameBtnEntity(){const g="rgb(32, 189, 24)";this.proceedNewGameBtnEntity=this.gameUtils.spawnEntity({passedKey:"button",componentsToModify:{width:200,height:100,rectangleShape:{rounded:{enabled:!0,radius:10}},shapeColor:g,parent:this.confirmNewGamePanelEntity,button:{clickBoxWidth:200,onPress:()=>{this.game.progressStorageManager.deleteData(),this.gameUtils.setIsActive(this.confirmNewGamePanelEntity,!1),this.gameUtils.playSfx("buttonClick")}},anchoring:{anchorX:"right",anchorY:"bottom",offsetX:-25,offsetY:-25}}}),this.gameUtils.anchorEntity(this.proceedNewGameBtnEntity,this.confirmNewGamePanelEntity)}initProceedNewGameBtnTextEntity(){this.proceedNewGameBtnTextEntity=this.gameUtils.spawnEntity({passedKey:"text",componentsToModify:{fontSize:30,fontContent:"PROCEED",parent:this.proceedNewGameBtnEntity}}),this.gameUtils.anchorEntity(this.proceedNewGameBtnTextEntity,this.proceedNewGameBtnEntity)}initCancelNewGameBtnEntity(){const g="rgb(106, 27, 27)";this.cancelNewGameBtnEntity=this.gameUtils.spawnEntity({passedKey:"button",componentsToModify:{width:200,height:100,rectangleShape:{rounded:{enabled:!0,radius:10}},shapeColor:g,parent:this.confirmNewGamePanelEntity,button:{clickBoxWidth:200,clickBoxHeight:100,onPress:()=>{this.gameUtils.setIsActive(this.confirmNewGamePanelEntity,!1),this.gameUtils.playSfx("buttonClick")}},anchoring:{anchorX:"left",anchorY:"bottom",offsetX:25,offsetY:-25},orderingLayer:20}}),this.gameUtils.anchorEntity(this.cancelNewGameBtnEntity,this.confirmNewGamePanelEntity)}initCancelNewGameBtnTextEntity(){this.cancelNewGameBtnTextEntity=this.gameUtils.spawnEntity({passedKey:"text",componentsToModify:{fontSize:30,fontContent:"CANCEL",parent:this.cancelNewGameBtnEntity}}),this.gameUtils.anchorEntity(this.cancelNewGameBtnTextEntity,this.cancelNewGameBtnEntity)}}class td{constructor(g){this.game=g,this.gameUtils=g.gameUtils,this.ctx=g.ctx,this.healthBarEntity=null,this.energyBarEntity=null,this.waveCounterTextEntity=null,this.start()}start(){this.gameUtils.addObj(this),this.initHealthBar(),this.initEnergyBar(),this.initWaveCounterTextEntity()}update(){this.game.ui.playerUi.updateEnergyBar(),this.updateWaveCounterText()}updateHealthBar(){const g=this.game.player.maxHealth,s=this.game.player.playerEntity.getComponent("health");this.gameUtils.setBarValue({max:g,current:s,barEntity:this.healthBarEntity})}initHealthBar(){const g="rgb(30, 28, 39)",s="rgb(3, 0, 14)",C="rgb(1, 213, 11)";this.healthBarEntity=this.gameUtils.spawnEntity({passedKey:"bar",componentsToModify:{pos:{x:0,y:0},bar:{fillColor:C,background:{enabled:!0,color:s},outline:{enabled:!0,color:g},flashEffect:{enabled:!0}}}}),this.updateHealthBar()}initEnergyBar(){const g="rgb(32, 30, 39)",s="rgb(3, 0, 14)";this.energyBarEntity=this.gameUtils.spawnEntity({passedKey:"bar",componentsToModify:{pos:{x:0,y:54},width:150,height:30,bar:{fillColor:"purple",background:{enabled:!0,color:s},outline:{enabled:!0,color:g,width:4},flashEffect:{enabled:!0,step:.1}}}}),this.updateEnergyBar()}updateEnergyBar(){const g=this.game.player.playerEntity.getComponent("shootEnergy"),s=g.max,C=g.current;this.gameUtils.setBarValue({max:s,current:C,barEntity:this.energyBarEntity})}initWaveCounterTextEntity(){this.waveCounterTextEntity=this.gameUtils.spawnEntity({passedKey:"text",componentsToModify:{parent:this.game.sceneEntity,fontSize:80,fontContent:`Wave: ${this.game.enemyWaveSpawner.currentWaveIndex}`,isActive:!1}}),this.gameUtils.anchorEntity(this.waveCounterTextEntity,this.game.sceneEntity)}updateWaveCounterText(){this.game.enemyWaveSpawner.waveJustBegan&&(this.waveCounterTextEntity.setComponent("isActive",!0),this.waveCounterTextEntity.setComponent("fontContent",`Wave: ${this.game.enemyWaveSpawner.currentWaveIndex}`),this.disableWaveCounterTextAfterDelay())}disableWaveCounterTextAfterDelay(){setTimeout(()=>{this.waveCounterTextEntity.setComponent("isActive",!1)},2e3)}}class ed{constructor(g){this.game=g,this.gameUtils=g.gameUtils,this.ctx=g.ctx,this.pauseBtnEntity=null,this.pauseBtnTextEntity=null,this.pausePanelEntity=null,this.pausedTextEntity=null,this.mainMenuBtnEntity=null,this.mainMenuTextEntity=null,this.unpauseBtnEntity=null,this.musicCheckboxEntity=null,this.musicCheckboxTextEntity=null,this.sfxCheckboxEntity=null,this.sfxCheckboxTextEntity=null,this.start()}start(){this.gameUtils.addObj(this),this.initPauseBtn(),this.initPausePanel()}update(){}initPauseBtn(){const g="rgb(27, 43, 68)";this.pauseBtnEntity=this.gameUtils.spawnEntity({passedKey:"button",componentsToModify:{width:200,height:100,shapeColor:g,rectangleShape:{rounded:{enabled:!0,radius:8}},anchoring:{anchorX:"right",anchorY:"top"},button:{clickBoxWidth:200,clickBoxHeight:100,onPress:()=>{this.gameUtils.setIsActive(this.pausePanelEntity,!0),this.gameUtils.pauseGame(),this.gameUtils.playSfx("buttonClick")}},orderingLayer:10}}),this.gameUtils.anchorEntity(this.pauseBtnEntity,this.game.sceneEntity),this.initPauseBtnText()}initPauseBtnText(){this.pauseBtnTextEntity=this.gameUtils.spawnEntity({passedKey:"text",componentsToModify:{fontSize:30,fontContent:"PAUSE",parent:this.pauseBtnEntity}}),this.gameUtils.calculateTextWidthAndHeight(this.pauseBtnTextEntity),this.gameUtils.anchorEntity(this.pauseBtnTextEntity,this.pauseBtnEntity)}initPausePanel(){const g="rgb(33, 76, 141)";this.pausePanelEntity=this.gameUtils.spawnEntity({passedKey:"panel",componentsToModify:{pos:this.game.screenCenterPos,width:900,height:700,shapeColor:g,rectangleShape:{rounded:{enabled:!0}},isActive:!1,orderingLayer:10}}),this.gameUtils.anchorEntity(this.pausePanelEntity,this.game.sceneEntity),this.initPausedText(),this.initMainMenuBtn(),this.initMainMenuBtnText(),this.initUnpauseButton(),this.initMusicCheckbox(),this.initMusicCheckboxText(),this.initSfxCheckbox(),this.initSfxCheckboxText()}initPausedText(){this.pausedTextEntity=this.gameUtils.spawnEntity({passedKey:"text",componentsToModify:{fontSize:80,anchoring:{anchorY:"top"},fontContent:"Paused",parent:this.pausePanelEntity}}),this.gameUtils.anchorEntity(this.pausedTextEntity,this.pausePanelEntity)}initMainMenuBtn(){const g="rgb(27, 59, 106)";this.mainMenuBtnEntity=this.gameUtils.spawnEntity({passedKey:"button",componentsToModify:{width:200,height:100,shapeColor:g,rectangleShape:{rounded:{enabled:!0,radius:6}},anchoring:{anchorY:"top",offsetY:150},button:{clickBoxWidth:200,clickBoxHeight:100,onPress:()=>{this.gameUtils.loadScene(this.game.mainMenuSceneEntity),this.gameUtils.playSfx("buttonClick")}},parent:this.pausePanelEntity}}),this.gameUtils.anchorEntity(this.mainMenuBtnEntity,this.pausePanelEntity)}initMainMenuBtnText(){this.mainMenuTextEntity=this.gameUtils.spawnEntity({passedKey:"text",componentsToModify:{fontSize:30,fontContent:"MainMenu",parent:this.mainMenuBtnEntity}}),this.gameUtils.anchorEntity(this.mainMenuTextEntity,this.mainMenuBtnEntity)}initUnpauseButton(){this.unpauseBtnEntity=this.gameUtils.spawnEntity({passedKey:"textureButton",componentsToModify:{anchoring:{anchorX:"right",anchorY:"top",offsetX:25,offsetY:-25},parent:this.pausePanelEntity,button:{onPress:()=>{this.gameUtils.unPauseGame(),this.gameUtils.setIsActive(this.pausePanelEntity,!1),this.gameUtils.playSfx("buttonClick")}}}}),this.gameUtils.anchorEntity(this.unpauseBtnEntity,this.pausePanelEntity)}initMusicCheckbox(){const g="rgb(27, 59, 106)";this.musicCheckboxEntity=this.gameUtils.spawnEntity({passedKey:"checkboxButton",componentsToModify:{parent:this.pausePanelEntity,width:200,height:100,shapeColor:g,checkbox:{storageKey:"music"},button:{clickBoxWidth:200,onPress:()=>{const s=this.gameUtils.toggleCheckbox(this.musicCheckboxEntity),C=this.gameUtils.returnCheckboxStorageKey(this.musicCheckboxEntity);this.game.settingsStorageManager.setProperty(C,s),this.toggleMusicCheckboxText(),this.gameUtils.playSfx("buttonClick"),s===!0?this.gameUtils.playLoopedMusic("backgroundMusic"):this.game.soundManager.stopAllLoops(),console.log("SETTINGS PROPERTY STATE:",this.game.settingsStorageManager.getProperty("music")),console.log("MUSIC CHECKBOX STATE:",this.musicCheckboxEntity.getComponent("checkbox"))}}}}),this.gameUtils.retrieveSavedCheckboxData(this.musicCheckboxEntity,this.game.settingsStorageManager),this.gameUtils.anchorEntity(this.musicCheckboxEntity,this.pausePanelEntity),console.log("MUSIC CHECKBOX STATE:",this.musicCheckboxEntity.getComponent("checkbox"))}initMusicCheckboxText(){this.musicCheckboxTextEntity=this.gameUtils.spawnEntity({passedKey:"text",componentsToModify:{fontContent:"Music:ON",parent:this.musicCheckboxEntity,fontSize:30}}),this.gameUtils.anchorEntity(this.musicCheckboxTextEntity,this.musicCheckboxEntity),this.toggleMusicCheckboxText()}toggleMusicCheckboxText(){this.gameUtils.toggleFontContentOnCheckbox(this.musicCheckboxEntity,this.musicCheckboxTextEntity,"Music: On","Music: Off")}initSfxCheckbox(){const g="rgb(27, 59, 106)";this.sfxCheckboxEntity=this.gameUtils.spawnEntity({passedKey:"checkboxButton",componentsToModify:{parent:this.pausePanelEntity,width:200,height:100,shapeColor:g,checkbox:{storageKey:"sfx"},button:{clickBoxWidth:200,onPress:()=>{const s=this.gameUtils.toggleCheckbox(this.sfxCheckboxEntity),C=this.gameUtils.returnCheckboxStorageKey(this.sfxCheckboxEntity);this.game.settingsStorageManager.setProperty(C,s),this.toggleSfxCheckboxText(),this.gameUtils.playSfx("buttonClick"),console.log("SETTINGS PROPERTY STATE:",this.game.settingsStorageManager.getProperty("sfx")),console.log("SFX CHECKBOX STATE:",this.sfxCheckboxEntity.getComponent("checkbox"))}},anchoring:{offsetY:150}}}),this.gameUtils.retrieveSavedCheckboxData(this.sfxCheckboxEntity,this.game.settingsStorageManager),this.gameUtils.anchorEntity(this.sfxCheckboxEntity,this.pausePanelEntity),console.log("SFX CHECKBOX STATE:",this.sfxCheckboxEntity.getComponent("checkbox"))}initSfxCheckboxText(){this.sfxCheckboxTextEntity=this.gameUtils.spawnEntity({passedKey:"text",componentsToModify:{fontContent:"SFX: ON",parent:this.sfxCheckboxEntity,fontSize:30}}),this.gameUtils.anchorEntity(this.sfxCheckboxTextEntity,this.sfxCheckboxEntity),this.toggleSfxCheckboxText()}toggleSfxCheckboxText(){this.gameUtils.toggleFontContentOnCheckbox(this.sfxCheckboxEntity,this.sfxCheckboxTextEntity,"SFX: On","SFX: Off")}refreshCheckboxStates(){this.gameUtils.retrieveSavedCheckboxData(this.musicCheckboxEntity,this.game.settingsStorageManager),this.toggleMusicCheckboxText(),this.gameUtils.retrieveSavedCheckboxData(this.sfxCheckboxEntity,this.game.settingsStorageManager),this.toggleSfxCheckboxText()}}class nd{constructor(g){this.game=g,this.gameUtils=g.gameUtils,this.musicCheckboxEntity=null,this.musicCheckboxTextEntity=null,this.sfxCheckboxEntity=null,this.sfxCheckboxTextEntity=null,this.backBtnEntity=null,this.backBtnTextEntity=null,this.controlsBtnEntity=null,this.controlsTextEntity=null,this.start()}start(){this.initMusicCheckbox(),this.initMusicCheckboxText(),this.initSfxCheckbox(),this.initSfxCheckboxText(),this.initBackBtnEntity(),this.initBackBtnTextEntity(),this.initControlsBtnEntity(),this.initControlsTextEntity()}initMusicCheckbox(){const g="rgb(27, 59, 106)";this.musicCheckboxEntity=this.gameUtils.spawnEntity({passedKey:"checkboxButton",componentsToModify:{parent:this.game.settingsSceneEntity,width:200,height:100,shapeColor:g,checkbox:{storageKey:"music"},button:{clickBoxWidth:200,onPress:()=>{const s=this.gameUtils.toggleCheckbox(this.musicCheckboxEntity),C=this.gameUtils.returnCheckboxStorageKey(this.musicCheckboxEntity);this.game.settingsStorageManager.setProperty(C,s),this.toggleMusicCheckboxText(),this.gameUtils.playSfx("buttonClick"),s===!0?this.gameUtils.playLoopedMusic("backgroundMusic"):this.game.soundManager.stopAllLoops()}},anchoring:{anchorY:"top",offsetY:50}}}),this.gameUtils.retrieveSavedCheckboxData(this.musicCheckboxEntity,this.game.settingsStorageManager),this.gameUtils.anchorEntity(this.musicCheckboxEntity,this.game.settingsSceneEntity)}initMusicCheckboxText(){this.musicCheckboxTextEntity=this.gameUtils.spawnEntity({passedKey:"text",componentsToModify:{fontContent:"Music:ON",parent:this.musicCheckboxEntity,fontSize:30}}),this.gameUtils.anchorEntity(this.musicCheckboxTextEntity,this.musicCheckboxEntity),this.toggleMusicCheckboxText()}toggleMusicCheckboxText(){this.gameUtils.toggleFontContentOnCheckbox(this.musicCheckboxEntity,this.musicCheckboxTextEntity,"Music: On","Music: Off")}initSfxCheckbox(){const g="rgb(27, 59, 106)";this.sfxCheckboxEntity=this.gameUtils.spawnEntity({passedKey:"checkboxButton",componentsToModify:{parent:this.game.settingsSceneEntity,width:200,height:100,shapeColor:g,checkbox:{storageKey:"sfx"},button:{clickBoxWidth:200,onPress:()=>{const s=this.gameUtils.toggleCheckbox(this.sfxCheckboxEntity),C=this.gameUtils.returnCheckboxStorageKey(this.sfxCheckboxEntity);this.game.settingsStorageManager.setProperty(C,s),this.toggleSfxCheckboxText(),this.gameUtils.playSfx("buttonClick")}},anchoring:{anchorY:top,offsetY:200}}}),this.gameUtils.retrieveSavedCheckboxData(this.sfxCheckboxEntity,this.game.settingsStorageManager),this.gameUtils.anchorEntity(this.sfxCheckboxEntity,this.game.settingsSceneEntity)}initSfxCheckboxText(){this.sfxCheckboxTextEntity=this.gameUtils.spawnEntity({passedKey:"text",componentsToModify:{fontContent:"SFX: ON",parent:this.sfxCheckboxEntity,fontSize:30}}),this.gameUtils.anchorEntity(this.sfxCheckboxTextEntity,this.sfxCheckboxEntity),this.toggleSfxCheckboxText()}toggleSfxCheckboxText(){this.gameUtils.toggleFontContentOnCheckbox(this.sfxCheckboxEntity,this.sfxCheckboxTextEntity,"SFX: On","SFX: Off")}refreshCheckboxStates(){this.gameUtils.retrieveSavedCheckboxData(this.musicCheckboxEntity,this.game.settingsStorageManager),this.toggleMusicCheckboxText(),this.gameUtils.retrieveSavedCheckboxData(this.sfxCheckboxEntity,this.game.settingsStorageManager),this.toggleSfxCheckboxText()}initBackBtnEntity(){const g="rgb(27, 59, 106)";this.backBtnEntity=this.gameUtils.spawnEntity({passedKey:"button",componentsToModify:{anchoring:{anchorX:"right",anchorY:"top"},parent:this.game.settingsSceneEntity,shapeColor:g,width:200,height:100,button:{clickBoxWidth:200,onPress:()=>{this.gameUtils.loadScene(this.game.mainMenuSceneEntity),this.gameUtils.playSfx("buttonClick")}}}}),this.gameUtils.anchorEntity(this.backBtnEntity,this.game.settingsSceneEntity)}initBackBtnTextEntity(){this.backBtnTextEntity=this.gameUtils.spawnEntity({passedKey:"text",componentsToModify:{fontSize:30,fontContent:"BACK",parent:this.backBtnEntity}}),this.gameUtils.anchorEntity(this.backBtnTextEntity,this.backBtnEntity)}initControlsBtnEntity(){const g="rgb(27, 59, 106)";this.controlsBtnEntity=this.gameUtils.spawnEntity({passedKey:"button",componentsToModify:{anchoring:{offsetY:-150},parent:this.game.settingsSceneEntity,shapeColor:g,width:200,height:100,button:{clickBoxWidth:200,onPress:()=>{this.gameUtils.loadScene(this.game.controlsSceneEntity),this.gameUtils.playSfx("buttonClick")}}}}),this.gameUtils.anchorEntity(this.controlsBtnEntity,this.game.settingsSceneEntity)}initControlsTextEntity(){this.controlsTextEntity=this.gameUtils.spawnEntity({passedKey:"text",componentsToModify:{fontSize:30,fontContent:"CONTROLS",parent:this.controlsBtnEntity}}),this.gameUtils.anchorEntity(this.controlsTextEntity,this.controlsBtnEntity)}}class id{constructor(g){this.game=g,this.gameUtils=g.gameUtils,this.movementTextPanelEntity=null,this.movementTextEntity=null,this.shootTextPanelEntity=null,this.shootTextEntity=null,this.pauseTextPanelEntity=null,this.pauseTextEntity=null,this.backBtnEntity=null,this.backBtnTextEntity=null,this.start()}start(){this.initMovementTextPanelEntity(),this.initMovementTextEntity(),this.initShootTextPanelEntity(),this.initShootTextEntity(),this.initPauseTextPanelEntity(),this.initPauseTextEntity(),this.initBackBtnEntity(),this.initBackBtnTextEntity()}initMovementTextPanelEntity(){const g="rgb(27, 59, 106)";this.movementTextPanelEntity=this.gameUtils.spawnEntity({passedKey:"panel",componentsToModify:{width:800,height:100,parent:this.game.controlsSceneEntity,shapeColor:g,rectangleShape:{rounded:{enabled:!0}},anchoring:{anchorY:"top",offsetY:50}}}),this.gameUtils.anchorEntity(this.movementTextPanelEntity,this.game.controlsSceneEntity)}initMovementTextEntity(){this.movementTextEntity=this.gameUtils.spawnEntity({passedKey:"text",componentsToModify:{fontSize:30,fontContent:"MOVE: MOUSE",parent:this.movementTextPanelEntity}}),this.gameUtils.anchorEntity(this.movementTextEntity,this.movementTextPanelEntity)}initShootTextPanelEntity(){const g="rgb(27, 59, 106)";this.shootTextPanelEntity=this.gameUtils.spawnEntity({passedKey:"panel",componentsToModify:{width:800,height:100,parent:this.game.controlsSceneEntity,shapeColor:g,rectangleShape:{rounded:{enabled:!0}},anchoring:{anchorY:"top",offsetY:170}}}),this.gameUtils.anchorEntity(this.shootTextPanelEntity,this.game.controlsSceneEntity)}initShootTextEntity(){this.shootTextEntity=this.gameUtils.spawnEntity({passedKey:"text",componentsToModify:{fontSize:30,fontContent:"SHOOT: RIGHT MOUSE BUTTON",parent:this.shootTextPanelEntity}}),this.gameUtils.anchorEntity(this.shootTextEntity,this.shootTextPanelEntity)}initPauseTextPanelEntity(){const g="rgb(27, 59, 106)";this.pauseTextPanelEntity=this.gameUtils.spawnEntity({passedKey:"panel",componentsToModify:{width:800,height:100,parent:this.game.controlsSceneEntity,shapeColor:g,rectangleShape:{rounded:{enabled:!0}},anchoring:{anchorY:"top",offsetY:290}}}),this.gameUtils.anchorEntity(this.pauseTextPanelEntity,this.game.controlsSceneEntity)}initPauseTextEntity(){this.pauseTextEntity=this.gameUtils.spawnEntity({passedKey:"text",componentsToModify:{fontSize:30,fontContent:"PAUSE: SPACEBAR (PC ONLY)",fontStyle:"",parent:this.pauseTextPanelEntity}}),this.gameUtils.anchorEntity(this.pauseTextEntity,this.pauseTextPanelEntity)}initBackBtnEntity(){const g="rgb(27, 59, 106)";this.backBtnEntity=this.gameUtils.spawnEntity({passedKey:"button",componentsToModify:{anchoring:{anchorX:"right",anchorY:"top"},parent:this.game.controlsSceneEntity,shapeColor:g,width:200,height:100,button:{clickBoxWidth:200,onPress:()=>{this.gameUtils.loadScene(this.game.settingsSceneEntity),this.gameUtils.playSfx("buttonClick")}}}}),this.gameUtils.anchorEntity(this.backBtnEntity,this.game.controlsSceneEntity)}initBackBtnTextEntity(){this.backBtnTextEntity=this.gameUtils.spawnEntity({passedKey:"text",componentsToModify:{fontSize:30,fontContent:"BACK",parent:this.backBtnEntity}}),this.gameUtils.anchorEntity(this.backBtnTextEntity,this.backBtnEntity)}}class rd{constructor(g){this.game=g,this.gameUtils=g.gameUtils,this.gameoverPanelEntity=null,this.gameoverTextEntity=null,this.waveReachedTextEntity=null,this.mainMenuBtnEntity=null,this.mainMenuBtnTextEntity=null,this.start()}start(){this.initGameoverPanelEntity()}initGameoverPanelEntity(){const g="rgb(33, 76, 141)";this.gameoverPanelEntity=this.gameUtils.spawnEntity({passedKey:"panel",componentsToModify:{pos:this.game.screenCenterPos,width:900,height:700,shapeColor:g,rectangleShape:{rounded:{enabled:!0}},isActive:!1,orderingLayer:10}}),this.gameUtils.anchorEntity(this.gameoverPanelEntity,this.game.sceneEntity),this.initGameoverTextEntity(),this.initWaveReachedTextEntity(),this.initMainMenuBtnEntity(),this.initMainMenuBtnTextEntity()}initGameoverTextEntity(){this.gameoverTextEntity=this.gameUtils.spawnEntity({passedKey:"text",componentsToModify:{fontSize:80,fontContent:"Game Over !",anchoring:{anchorY:"top"},parent:this.gameoverPanelEntity}}),this.gameUtils.anchorEntity(this.gameoverTextEntity,this.gameoverPanelEntity)}initWaveReachedTextEntity(){this.waveReachedTextEntity=this.gameUtils.spawnEntity({passedKey:"text",componentsToModify:{fontSize:50,fontContent:`Wave Reached: ${this.game.enemyWaveSpawner.currentWaveIndex}`,anchoring:{anchorY:"top",offsetY:150},parent:this.gameoverPanelEntity}}),this.gameUtils.anchorEntity(this.waveReachedTextEntity,this.gameoverPanelEntity)}setWaveReachedText(){this.gameUtils.setFontContent(this.waveReachedTextEntity,`Wave Reached: ${this.game.enemyWaveSpawner.currentWaveIndex}`)}initMainMenuBtnEntity(){const g="rgb(27, 59, 106)";this.mainMenuBtnEntity=this.gameUtils.spawnEntity({passedKey:"button",componentsToModify:{width:200,height:100,shapeColor:g,rectangleShape:{rounded:{enabled:!0,radius:6}},button:{clickBoxWidth:200,clickBoxHeight:100,onPress:()=>{this.gameUtils.loadScene(this.game.mainMenuSceneEntity),this.gameUtils.playSfx("buttonClick")}},parent:this.gameoverPanelEntity}}),this.gameUtils.anchorEntity(this.mainMenuBtnEntity,this.gameoverPanelEntity)}initMainMenuBtnTextEntity(){this.mainMenuTextEntity=this.gameUtils.spawnEntity({passedKey:"text",componentsToModify:{fontSize:30,fontContent:"MainMenu",parent:this.mainMenuBtnEntity}}),this.gameUtils.anchorEntity(this.mainMenuTextEntity,this.mainMenuBtnEntity)}}class sd{constructor(g){this.game=g,this.gameUtils=g.gameUtils,this.gamewinPanelEntity=null,this.gamewinTextEntity=null,this.mainMenuBtnEntity=null,this.mainMenuTextEntity=null,this.start()}start(){this.initGamewinPanelEntity()}initGamewinPanelEntity(){const g="rgb(33, 76, 141)";this.gamewinPanelEntity=this.gameUtils.spawnEntity({passedKey:"panel",componentsToModify:{pos:this.game.screenCenterPos,width:900,height:700,shapeColor:g,rectangleShape:{rounded:{enabled:!0}},isActive:!1,orderingLayer:10}}),this.gameUtils.anchorEntity(this.gamewinPanelEntity,this.game.sceneEntity),this.initGamewinTextEntity(),this.initMainMenuBtnEntity(),this.initMainMenuTextEntity()}initGamewinTextEntity(){this.gamewinTextEntity=this.gameUtils.spawnEntity({passedKey:"text",componentsToModify:{fontSize:80,fontContent:"You Win!",anchoring:{anchorY:"top"},parent:this.gamewinPanelEntity}}),this.gameUtils.anchorEntity(this.gamewinTextEntity,this.gamewinPanelEntity)}initMainMenuBtnEntity(){const g="rgb(27, 59, 106)";this.mainMenuBtnEntity=this.gameUtils.spawnEntity({passedKey:"button",componentsToModify:{width:200,height:100,shapeColor:g,rectangleShape:{rounded:{enabled:!0,radius:6}},button:{clickBoxWidth:200,clickBoxHeight:100,onPress:()=>{this.gameUtils.loadScene(this.game.mainMenuSceneEntity),this.gameUtils.playSfx("buttonClick")}},parent:this.gamewinPanelEntity}}),this.gameUtils.anchorEntity(this.mainMenuBtnEntity,this.gamewinPanelEntity)}initMainMenuTextEntity(){this.mainMenuTextEntity=this.gameUtils.spawnEntity({passedKey:"text",componentsToModify:{fontSize:30,fontContent:"MainMenu",parent:this.mainMenuBtnEntity}}),this.gameUtils.anchorEntity(this.mainMenuTextEntity,this.mainMenuBtnEntity)}}class od{constructor(g){this.game=g,this.mainMenuUi=new jm(g),this.settingsSceneUi=new nd(g),this.controlsSceneUi=new id(g),this.playerUi=new td(g),this.pauseUi=new ed(g),this.gameoverUi=new rd(g),this.gamewinUi=new sd(g)}}class ad{constructor(g){this.resources=g,this.images=g.imagesData,this.entitiesData=g.entitiesData,this.settingsData=g.settingsData,this.audioData=g.audioData,this.enemyWaveData=g.enemyWaveData,this.progressData=g.progressData,this.canvas=document.querySelector(".game-container"),this.ctx=this.canvas.getContext("2d"),this.ctx.imageSmoothingEnabled=!1,this.bgCanvas=document.querySelector(".background-container"),this.bgCtx=this.bgCanvas.getContext("2d"),this.bgCtx.imageSmoothingEnabled=!1,this.settingsStorageManager=new Jl("settingsStorageManager",this.settingsData),this.progressStorageManager=new Jl("progressStorageManager",this.progressData),this.soundManager=new Xm(this.audioData),this.defParallaxSpeed=-.75,this.parallaxSpeed=this.defParallaxSpeed,this.backgroundParallax=new Zm(this.images.background,this.parallaxSpeed,"vertical"),this.lastTime=0,this.deltaTime=null,this.registeredObj=[],this.ecs={entityEngine:null,entitySim:null,systems:new Nm({game:this}),customSystems:null,ecsSystems:null},this.ecs.customSystems=this.ecs.systems.customSystems,this.ecs.ecsSystems=this.ecs.systems.ecsSystems,this.matter={matterEngine:null,matterRunner:null},this.collisionCategories={playerCategory:1,itemCategory:2,playerBulletCategory:4,enemyCategory:8,enemyBulletCategory:22},this.width=this.canvas.width,this.height=this.canvas.height,this.screenCenterPos={x:this.width/2,y:this.height/2},this.sceneRotation=this.progressStorageManager.getProperty("sceneRotation")||0,this.nextSceneRotation=0,this.totalSceneRotation=this.progressStorageManager.getProperty("totalSceneRotation")||0,this.isPaused=!1,this.scenes=[],this.currentSceneEntity=null,this.sceneEntity=null,this.mainMenuSceneEntity=null,this.settingsSceneEntity=null,this.controlsSceneEntity=null,this.debugging={debugMatterBodies:!1,debugShootDirection:!1,debugUiClickBox:!1,debugLocalPos:!1},this.particleEffects=[],this.mouse=null,this.physics=null,this.player=null,this.ui=null,this.gameUtils=null,this.enemyWaveSpawner=null,this.start(),this.update()}start(){this.initializeJECS(),this.gameUtils=new $m(this),this.mouse=new Am(this),this.physics=new Km(this),this.enemyWaveSpawner=new qm(this),this.initMainMenuSceneEntity(),this.initSettingsSceneEntity(),this.initSceneEntity(),this.initControlsSceneEntity(),this.initCurrentSceneEntity(),this.player=new Qm(this),this.ui=new od(this),console.log("UI:",this.ui),this.onBackgroundCanvasResize(),this.systemsJECS(),this.gameUtils.playLoopedMusicOnInteraction("backgroundMusic"),this.gameUtils.togglePauseForPc(),this.gameUtils.pauseGame()}update(g){const s=(g-this.lastTime)/1e3;this.lastTime=g,this.deltaTime=s,this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.bgCtx.clearRect(0,0,this.bgCanvas.width,this.bgCanvas.height),this.backgroundParallax.run(this.bgCtx),this.ecs.customSystems.drawAllEntities(),this.ecs.customSystems.debugMatterBodies(),this.ecs.customSystems.traceMatterBodies(),this.ecs.customSystems.DebugShootingDirection(),this.ecs.customSystems.debugBtnClickArea(),this.ecs.customSystems.handleBtnTriggers(),this.ecs.customSystems.traceLocalPositions(),this.gameUtils.onHoveredEntityUnActive(),this.gameUtils.updateParticles(),this.gameUtils.drawParticles(),this.registeredObj.forEach(C=>{C.update()}),requestAnimationFrame(this.update.bind(this))}initializeJECS(){this.ecs.entityEngine=new Yl.Engine,this.ecs.entitySim=new Yl.Simulator(this.ecs.entityEngine),this.ecs.entitySim.setFps(60),this.ecs.entitySim.start()}onBackgroundCanvasResize(){window.addEventListener("resize",()=>{this.resizeBackgroundCanvas()}),this.resizeBackgroundCanvas()}resizeBackgroundCanvas(){const g=window.devicePixelRatio||1,s=this.bgCanvas.getBoundingClientRect();this.bgCanvas.width=s.width*g,this.bgCanvas.height=s.height*g,this.bgCtx.scale(g,g)}systemsJECS(){const g=this.ecs.ecsSystems;g.changeBodyRotationSystem(),g.movePlayerSystem(),g.moveEntitiesSystem(),g.shootBulletsSystem(),g.manageShootEnergySystem(),g.playerEnergyBarColorSystem(),g.handleLocalPosSystem(),g.handleInvincibilityCounterSystem(),g.destroyOutOfBoundsEntitiesSystem()}initSceneEntity(){this.sceneEntity=this.gameUtils.spawnSceneEntity("sceneEntity",!1)}initMainMenuSceneEntity(){this.mainMenuSceneEntity=this.gameUtils.spawnSceneEntity("mainMenuSceneEntity",!0)}initSettingsSceneEntity(){this.settingsSceneEntity=this.gameUtils.spawnSceneEntity("settingsSceneEntity",!1)}initControlsSceneEntity(){this.controlsSceneEntity=this.gameUtils.spawnSceneEntity("controlsSceneEntity",!1)}initCurrentSceneEntity(){for(const g of this.scenes)if(g.getComponent("isActive")){this.currentSceneEntity=g;break}}}new Bm(ld);function ld(J){console.log(J);const g=new ad(J);console.log("start called"),console.log("PLAYER EXISTS?",g.gameUtils.entityExists(g.player.playerEntity))}
